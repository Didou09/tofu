\documentclass[10pt,a4paper]{article}
\usepackage[margin=0.5in]{geometry}
\usepackage[utf8]{inputenc}
\usepackage[english]{babel}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
 \usepackage{cancel}
\usepackage{graphicx}

\newcommand{\ud}[1]{\underline{#1}}
\DeclareMathOperator{\tm}{\times}
\DeclareMathOperator{\A}{\ud{A}}
\DeclareMathOperator{\B}{\ud{B}}
\DeclareMathOperator{\C}{\ud{C}}
\DeclareMathOperator{\G}{\ud{G}}
\DeclareMathOperator{\av}{\ud{a}}
\DeclareMathOperator{\bv}{\ud{b}}
\DeclareMathOperator{\cv}{\ud{c}}


\title{Solid angle subtended by a tetrahedron computation}
\begin{document}

\maketitle


\includegraphics[scale=0.4]{tetra.png} 


\section{Notations}

\subsection{vectors}

\begin{itemize}
	\item $\A=\vec{OA}$
	\item $\B=\vec{OB}$
	\item $\C=\vec{OC}$
	\item $\G=\vec{OG}$
	\item $\av=\vec{GA}$
	\item $\bv=\vec{GB}$
    \item $\cv=\vec{GC}$
\end{itemize}

\subsection{scalars}

\begin{itemize}
	\item $A = \|\A\|$
	\item $B = \|\B\|$
	\item $C = \|\C\|$
	\item $a = \|\av\|$
	\item $b = \|\bv\|$
	\item $c = \|\cv\|$
\end{itemize}

\section{Computation}

The solid angle $\Omega$ subtended by the triangular surface $ABC$ is:

$$
{\displaystyle \tan \left({\frac {1}{2}}\Omega \right)
  = {\frac {\left|{\A}\ {\B}\ {\C}\right|}
    {ABC + \left({\A}\cdot {\B}\right)C
      + \left({\A}\cdot {\C}\right)B
      + \left({\B}\cdot {\C}\right)A}}}
$$

where $ \left|{\A}\ {\B}\ {\C}\right| = {\A}\cdot ({\B}\tm {\C}) $


\subsection{Numerator}


Given that $\A = \G + \av$ (and resp.
with $\B$ and $\C$), we get


\begin{align*}
\left|{\A}\ {\B}\ {\C}\right|
    & =& {\A} \cdot ({\B}\tm {\C}) \\
    & =&  {(\G + \av)} \cdot ({(\G + \bv)} \tm {(\G + \cv)}) \\
    & =&  {(\G + \av)} \cdot (\cancel{\G \tm \G}
	                      + \G \tm \cv
	                      + \bv \tm \G
	                      + \bv \tm \cv) \\
    & =& \cancel{\G \cdot (\G \tm \cv)}
	                      + \cancel{\G \cdot (\bv \tm \G)}
                          + \G \cdot (\bv \tm \cv)
      + \av \cdot (\G \tm \cv)
	  + \av \cdot (\bv \tm \G)
	  + \cancel{\av \cdot (\bv \tm \cv)} \\
    & =& \G \cdot (\bv \tm \cv)
	+ \G \cdot (\cv \tm \av)
	+ \G \cdot (\av \tm \bv) \\
    & = &\G \cdot \left(\bv \tm \cv
	+ \cv \tm \av
	+ \av \tm \bv \right)
\end{align*}

since $G$ is the centroid of $ABC$, 

\begin{equation}
\av + \bv + \cv= 0
\label{eq1}
\end{equation}. We obtain

\begin{align}
\left|{\A}\ {\B}\ {\C}\right|
& = \G \cdot \left(\bv \tm \cv + \cv \tm \av + \av \tm \bv \right) \nonumber \\
& = \G \cdot \left(\bv \tm \cv + \cv \tm (-\bv-\cv)	+ (-\bv-\cv) \tm \bv \right) \nonumber \\
& = G \cdot \left(\bv \times \cv + \cv \times (-\bv) + \cancel{\cv \times (-\cv)}
	+ \cancel{(-b) \times b} + (- c) \times b \right) \nonumber \\
& = G \cdot \left(3 b \times c \right) \nonumber \\
& = 3 G \cdot \left( b \times c \right)
\end{align}

\subsection{Denominator}


First let's see the term in $\mathbf{C}$
\begin{align*}
 \left({\A}\cdot {\B}\right)C
	=& \left( G + a \right) \cdot \left( G + b \right) \mathbf{C} \\
	 =& (\mathbf{G}^2 +  G \cdot b	+ a \cdot G + a \cdot b    ) \mathbf{C}
\end{align*}

Using \eqref{eq1}

\begin{align}
 \left({A}\cdot {B}\right)\mathbf{C}
	 =& (\mathbf{G}^2 +  G \cdot b	+ (-b - c) \cdot G + (-b - c) \cdot b    ) c \nonumber \\
	 =& (\mathbf{G}^2 - G \cdot c - c \cdot b)\mathbf{C}
\end{align}



Now, the term in $\mathbf{B}$


\begin{align*}
 \left({A}\cdot {C}\right)\mathbf{B} 
	=& \left( G + a \right) \cdot \left( G + c \right) \mathbf{B} \\
	 =& (\mathbf{G}^2 +  G \cdot c	+ a \cdot G + a \cdot c    ) \mathbf{B}
\end{align*}

Using \eqref{eq1}

\begin{align}
 \left({A}\cdot {C}\right)\mathbf{B}
	 =& (\mathbf{G}^2 +  G \cdot c	+ (-b - c) \cdot G + (-b - c) \cdot c    ) b \nonumber \\
	 =& (\mathbf{G}^2 - G \cdot c - c \cdot b)\mathbf{B}
\end{align}


For the third term there is no simplification

\begin{align}
 \left({B}\cdot {C}\right)\mathbf{A}
	=& \left( G + b \right) \cdot \left( G + c \right) \mathbf{A}
\end{align}


For the computation of the norms, we can use:

\begin{align*}
\mathbf{A}^2 &= ||OG||^2 + \mathbf{a}^2 + 2 G \cdot a \\
        &=  \mathbf{G}^2 + \mathbf{a}^2 + 2 G \cdot a 
\end{align*}

and respectively with B and C, we obtain


\begin{align}
(\mathbf{A}\mathbf{B}\mathbf{C})^2 &= (\mathbf{G}^2 + \mathbf{a} + 2 G \cdot a )^2(\mathbf{G}^2 + \mathbf{b} + 2 G \cdot b)^2(\mathbf{G}^2 + \mathbf{c} + 2 G \cdot c)^2 
\end{align}


\section{Final formula}


$$
{\displaystyle \tan \left({\frac {1}{2}}\Omega \right)
  = {\frac {3 G \cdot \left( b \times c \right)}
    {\mathbf{A}\mathbf{B}\mathbf{C} + \left({A}\cdot {B}\right)\mathbf{C}
      + \left({A}\cdot {C}\right)\mathbf{B}
      + \left({B}\cdot {C}\right)\mathbf{A}}}}
$$


$$
{\displaystyle \tan \left({\frac {1}{2}}\Omega \right)
  = {\frac {3 G \cdot \left( b \times c \right)}
    {\mathbf{A}\mathbf{B}\mathbf{C} +
    (\mathbf{G}^2 - G \cdot c - c \cdot b)\mathbf{C}
      + (\mathbf{G}^2 - G \cdot c - c \cdot b)\mathbf{B}
      + \left( G + b \right) \cdot \left( G + c \right) \mathbf{A}
      }}}
$$

\end{document}
