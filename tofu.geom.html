<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>tofu.geom package &#8212; tofu v1.4</title>
    <link rel="stylesheet" href="_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/gallery.css" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="tofu.scripts package" href="tofu.scripts.html" />
    <link rel="prev" title="tofu.dust package" href="tofu.dust.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="_static/js/jquery-1.11.0.min.js "></script>
<script type="text/javascript" src="_static/js/jquery-fix.js "></script>
<script type="text/javascript" src="_static/bootstrap-3.3.7/js/bootstrap.min.js "></script>
<script type="text/javascript" src="_static/bootstrap-sphinx.js "></script>

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="index.html">
          tofu</a>
        <span class="navbar-text navbar-version pull-left"><b>1.4</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="installation.html">Installation</a></li>
                <li><a href="contributing.html">Contributing</a></li>
                <li><a href="auto_examples/index.html">Gallery</a></li>
                <li><a href="aboutus.html">About</a></li>
                <li><a href="releases.html">Releases</a></li>
                <li><a href="tofu.html">API</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul>
<li class="toctree-l1"><a class="reference internal" href="installation.html">How to install tofu</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">A guide to contributing to tofu</a></li>
<li class="toctree-l1"><a class="reference internal" href="auto_examples/tutorials/tuto_plot_gallery_fusion_machines.html">A list of all different device configurations available (ITER, WEST, JET, ...)</a></li>
<li class="toctree-l1"><a class="reference internal" href="auto_examples/index.html">Tutorials and examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="tofu_from_bash.html">Using tofu from a bash terminal</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="tofu.html">tofu package</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">tofu.geom package</a></li>
<li class="toctree-l1"><a class="reference internal" href="tofu.dumpro.html">tofu.dumpro package</a></li>
<li class="toctree-l1"><a class="reference internal" href="tofu.data.html">tofu.data package</a></li>
<li class="toctree-l1"><a class="reference internal" href="tofu.dust.html">tofu.dust package</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">tofu.geom package</a><ul>
<li><a class="reference internal" href="#submodules">Submodules</a></li>
<li><a class="reference internal" href="#tofu-geom-gg-cpython-36m-darwin-module">tofu.geom._GG.cpython-36m-darwin module</a></li>
<li><a class="reference internal" href="#module-tofu.geom._GG">tofu.geom._GG module</a></li>
<li><a class="reference internal" href="#tofu-geom-basic-geom-tools-cpython-36m-darwin-module">tofu.geom._basic_geom_tools.cpython-36m-darwin module</a></li>
<li><a class="reference internal" href="#module-tofu.geom._basic_geom_tools">tofu.geom._basic_geom_tools module</a></li>
<li><a class="reference internal" href="#module-tofu.geom._comp">tofu.geom._comp module</a></li>
<li><a class="reference internal" href="#module-tofu.geom._comp_optics">tofu.geom._comp_optics module</a></li>
<li><a class="reference internal" href="#module-tofu.geom._core">tofu.geom._core module</a></li>
<li><a class="reference internal" href="#module-tofu.geom._core_optics">tofu.geom._core_optics module</a></li>
<li><a class="reference internal" href="#module-tofu.geom._def">tofu.geom._def module</a></li>
<li><a class="reference internal" href="#tofu-geom-distance-tools-cpython-36m-darwin-module">tofu.geom._distance_tools.cpython-36m-darwin module</a></li>
<li><a class="reference internal" href="#module-tofu.geom._distance_tools">tofu.geom._distance_tools module</a></li>
<li><a class="reference internal" href="#module-tofu.geom._plot">tofu.geom._plot module</a></li>
<li><a class="reference internal" href="#module-tofu.geom._plot_optics">tofu.geom._plot_optics module</a></li>
<li><a class="reference internal" href="#tofu-geom-raytracing-tools-cpython-36m-darwin-module">tofu.geom._raytracing_tools.cpython-36m-darwin module</a></li>
<li><a class="reference internal" href="#module-tofu.geom._raytracing_tools">tofu.geom._raytracing_tools module</a></li>
<li><a class="reference internal" href="#tofu-geom-sampling-tools-cpython-36m-darwin-module">tofu.geom._sampling_tools.cpython-36m-darwin module</a></li>
<li><a class="reference internal" href="#module-tofu.geom._sampling_tools">tofu.geom._sampling_tools module</a></li>
<li><a class="reference internal" href="#tofu-geom-vignetting-tools-cpython-36m-darwin-module">tofu.geom._vignetting_tools.cpython-36m-darwin module</a></li>
<li><a class="reference internal" href="#module-tofu.geom._vignetting_tools">tofu.geom._vignetting_tools module</a></li>
<li><a class="reference internal" href="#module-tofu.geom.utils">tofu.geom.utils module</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <div class="section" id="module-tofu.geom">
<span id="tofu-geom-package"></span><h1>tofu.geom package<a class="headerlink" href="#module-tofu.geom" title="Permalink to this headline">¶</a></h1>
<p>The geometry module of tofu</p>
<p>Provides classes to model the 3D geometry of:
* the vacuum vessel and structural elements
* LOS
* apertures and detectors</p>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="tofu-geom-gg-cpython-36m-darwin-module">
<h2>tofu.geom._GG.cpython-36m-darwin module<a class="headerlink" href="#tofu-geom-gg-cpython-36m-darwin-module" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-tofu.geom._GG">
<span id="tofu-geom-gg-module"></span><h2>tofu.geom._GG module<a class="headerlink" href="#module-tofu.geom._GG" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="tofu.geom._GG.CoordShift">
<code class="sig-prename descclassname">tofu.geom._GG.</code><code class="sig-name descname">CoordShift</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tofu.geom._GG.CoordShift" title="Permalink to this definition">¶</a></dt>
<dd><p>Check the shape of an array of points coordinates and/or converts from
2D to 3D, 3D to 2D, cylindrical to cartesian…
(CrossRef is an angle (Tor) or a distance (X for Lin))</p>
</dd></dl>

<dl class="function">
<dt id="tofu.geom._GG.comp_dist_los_circle">
<code class="sig-prename descclassname">tofu.geom._GG.</code><code class="sig-name descname">comp_dist_los_circle</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tofu.geom._GG.comp_dist_los_circle" title="Permalink to this definition">¶</a></dt>
<dd><p>This function computes the intersection of a Ray (or Line Of Sight)
and a circle in 3D. It returns <cite>kmin</cite> and <cite>dist</cite>. Where <cite>kmin</cite> is the
coefficient such that the ray of origin O = [ori1, ori2, ori3]
and of directional vector D = [dir1, dir2, dir3] is closest to the circle</p>
<blockquote>
<div><p>of radius <cite>radius</cite> and centered <cite>(0, 0, circ_z)</cite> at the point</p>
</div></blockquote>
<p>P = O + kmin * D.
And <cite>distance</cite> the distance between the two closest points (line closest
and circle closest)
The variable <cite>norm_dir</cite> is the squared norm of the direction of the ray.
Params
=====
ray_vdir: (3) double array</p>
<blockquote>
<div><p>ray’s director vector V such that P in Ray iff P(t) = O + t*V</p>
</div></blockquote>
<dl class="simple">
<dt>ray_orig<span class="classifier">(3) double array</span></dt><dd><p>ray’s origin coordinates O such that P in Ray iff P(t) = O + t*V</p>
</dd>
<dt>radius<span class="classifier">double</span></dt><dd><p>radius r of horizontal circle centered in (0,0,circ_z)</p>
</dd>
<dt>circ_z<span class="classifier">double</span></dt><dd><p>3rd coordinate of horizontal circle centered in (0,0,circ_z) of radius r</p>
</dd>
<dt>norm_dir<span class="classifier">double (optional)</span></dt><dd><p>If for computation reasons it makes sense, you can pass the norm of the
director vector</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul>
<li><p><strong>result</strong> (<em>double (2) array</em>) –</p>
<ul class="simple">
<li><p>result[0] will contain the k coefficient to find the line point closest</p></li>
</ul>
<p>closest point
- result[1] will contain the DISTANCE from line closest point to circle
to the circle</p>
</li>
<li><p><em>—</em></p></li>
<li><p><em>This is the PYTHON function, use only if you need this computation from</em></p></li>
<li><p>Python, if you need it from cython, use <cite>dist_los_circle_core</cite></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="tofu.geom._GG.comp_dist_los_circle_vec">
<code class="sig-prename descclassname">tofu.geom._GG.</code><code class="sig-name descname">comp_dist_los_circle_vec</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tofu.geom._GG.comp_dist_los_circle_vec" title="Permalink to this definition">¶</a></dt>
<dd><p>This function computes the intersection of a Ray (or Line Of Sight)
and a circle in 3D. It returns <cite>kmin</cite>, the coefficient such that the
ray of origin O = [ori1, ori2, ori3] and of directional vector
D = [dir1, dir2, dir3] is closest to the circle of radius <cite>radius</cite>
and centered <cite>(0, 0, circ_z)</cite> at the point P = O + kmin * D.
The variable <cite>norm_dir</cite> is the squared norm of the direction of the ray.
This is the vectorial version, we expect the directions and origins to be:
dirs = [[dir1_los1, dir2_los1, dir3_los1], [dir1_los2,…]
oris = [[ori1_los1, ori2_los1, ori3_los1], [ori1_los2,…]
:returns: * <strong>res</strong> (<em>(2, nlos, ncircles)</em>) – res = [res_k, res_d] where res_k is a (nlos, ncircles) numpy array</p>
<blockquote>
<div><blockquote>
<div><p>with the k coefficients for each LOS where the minimum distance
to each circle is reached
is met for each circle, and res_d is a (nlos, ncircles) numpy array
with the distance between each LOS to each circle</p>
</div></blockquote>
<ul class="simple">
<li><p><em>—</em></p></li>
<li><p><em>This is the PYTHON function, use only if you need this computation from</em></p></li>
<li><p>Python, if you need it from cython, use <cite>dist_los_circle_core</cite></p></li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="tofu.geom._GG.comp_dist_los_vpoly">
<code class="sig-prename descclassname">tofu.geom._GG.</code><code class="sig-name descname">comp_dist_los_vpoly</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tofu.geom._GG.comp_dist_los_vpoly" title="Permalink to this definition">¶</a></dt>
<dd><p>This function computes the distance (and the associated k) between nlos
Rays (or LOS) and an <cite>IN</cite> structure (a polygon extruded around the axis
(0,0,1), eg. a flux surface).
For more details on the algorithm please see PDF: &lt;name_of_pdf&gt;.pdf #TODO</p>
<blockquote>
<div><dl class="simple">
<dt>ray_orig<span class="classifier">(3, nlos) double array</span></dt><dd><p>LOS origin points coordinates</p>
</dd>
<dt>ray_vdir<span class="classifier">(3, nlos) double array</span></dt><dd><p>LOS normalized direction vector</p>
</dd>
<dt>ves_poly<span class="classifier">(2, num_vertex) double array</span></dt><dd><p>Coordinates of the vertices of the Polygon defining the 2D poloidal
cut of the Vessel</p>
</dd>
<dt>eps_&lt;val&gt;<span class="classifier">double</span></dt><dd><p>Small value, acceptance of error</p>
</dd>
</dl>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>kmin_vpoly</strong> (<em>(nlos) double array</em>) – Of the form [k_0, k_1, …, k_n], where k_i is the coefficient
such that the i-th ray (LOS) is closest to the extruded polygon
at the point P_i = orig[i] + kmin[i] * vdir[i]</p></li>
<li><p><strong>dist_vpoly</strong> (<em>(nlos) double array</em>) – <cite>distance[i]</cite> is the distance from P_i to the extruded polygon.</p></li>
</ul>
</p>
</dd>
</dl>
<p>—
This is the PYTHON function, use only if you need this computation from
Python, if you need it from cython, use <cite>simple_dist_los_vpoly_core</cite></p>
</dd></dl>

<dl class="function">
<dt id="tofu.geom._GG.comp_dist_los_vpoly_vec">
<code class="sig-prename descclassname">tofu.geom._GG.</code><code class="sig-name descname">comp_dist_los_vpoly_vec</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tofu.geom._GG.comp_dist_los_vpoly_vec" title="Permalink to this definition">¶</a></dt>
<dd><p>This function computes the distance (and the associated k) between nlos
Rays (or LOS) and several <cite>IN</cite> structures (polygons extruded around the axis
(0,0,1), eg. flux surfaces).
For more details on the algorithm please see PDF: &lt;name_of_pdf&gt;.pdf #TODO</p>
<blockquote>
<div><dl>
<dt>nvpoly<span class="classifier">int</span></dt><dd><p>Number of flux surfaces</p>
</dd>
<dt>nlos<span class="classifier">int</span></dt><dd><p>Number of LOS</p>
</dd>
<dt>ray_orig<span class="classifier">(3, nlos) double array</span></dt><dd><p>LOS origin points coordinates</p>
</dd>
<dt>ray_vdir<span class="classifier">(3, nlos) double array</span></dt><dd><p>LOS normalized direction vector</p>
</dd>
<dt>ves_poly<span class="classifier">(num_pol, 2, num_vertex) double array</span></dt><dd><p>Coordinates of the vertices of the Polygon defining the 2D poloidal
cut of the different IN surfaces
WARNING : we suppose all poly are nested in each other,</p>
<blockquote>
<div><p>from inner to outer</p>
</div></blockquote>
</dd>
<dt>eps_&lt;val&gt;<span class="classifier">double</span></dt><dd><p>Small value, acceptance of error</p>
</dd>
</dl>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>kmin_vpoly</strong> (<em>(npoly, nlos) double array</em>) – Of the form [k_00, k_01, …, k_0n, k_10, k_11, …, k_1n, …]
where k_ij is the coefficient for the j-th flux surface
such that the i-th ray (LOS) is closest to the extruded polygon
at the point P_i = orig[i] + kmin[i] * vdir[i]</p></li>
<li><p><strong>dist_vpoly</strong> (<em>(npoly, nlos) double array</em>) – <cite>distance[i * num_poly + j]</cite> is the distance from P_i to the i-th
extruded poly.</p></li>
</ul>
</p>
</dd>
</dl>
<p>—
This is the PYTHON function, use only if you need this computation from
Python, if you need it from cython, use <cite>comp_dist_los_vpoly_vec_core</cite></p>
</dd></dl>

<dl class="function">
<dt id="tofu.geom._GG.is_close_los_vpoly_vec">
<code class="sig-prename descclassname">tofu.geom._GG.</code><code class="sig-name descname">is_close_los_vpoly_vec</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tofu.geom._GG.is_close_los_vpoly_vec" title="Permalink to this definition">¶</a></dt>
<dd><p>This function tests if the distance between nlos Rays (or LOS) and
several <cite>IN</cite> structures (polygons extruded around the axis (0,0,1),
eg. flux surfaces) is smaller than <cite>epsilon</cite>.
For more details on the algorithm please see PDF: &lt;name_of_pdf&gt;.pdf #TODO</p>
<blockquote>
<div><dl>
<dt>nvpoly<span class="classifier">int</span></dt><dd><p>Number of flux surfaces</p>
</dd>
<dt>nlos<span class="classifier">int</span></dt><dd><p>Number of LOS</p>
</dd>
<dt>ray_orig<span class="classifier">(3, nlos) double array</span></dt><dd><p>LOS origin points coordinates</p>
</dd>
<dt>ray_vdir<span class="classifier">(3, nlos) double array</span></dt><dd><p>LOS normalized direction vector</p>
</dd>
<dt>ves_poly<span class="classifier">(num_pol, 2, num_vertex) double array</span></dt><dd><p>Coordinates of the vertices of the Polygon defining the 2D poloidal
cut of the different IN surfaces
WARNING : we suppose all poly are nested in each other,</p>
<blockquote>
<div><p>and the first one is the smallest one</p>
</div></blockquote>
</dd>
<dt>epsilon<span class="classifier">double</span></dt><dd><p>Value for testing if distance &lt; epsilon</p>
</dd>
<dt>eps_&lt;val&gt;<span class="classifier">double</span></dt><dd><p>Small value, acceptance of error</p>
</dd>
</dl>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>are_close</strong> (<em>(npoly * nlos) bool array</em>) – <cite>are_close[i * num_poly + j]</cite> indicates if distance between i-th LOS
and j-th poly are closer than epsilon. (True if distance&lt;epsilon)</p>
</dd>
</dl>
<p>—
This is the PYTHON function, use only if you need this computation from
Python, if you need it from cython, use <cite>is_close_los_vpoly_vec_core</cite></p>
</dd></dl>

<dl class="function">
<dt id="tofu.geom._GG.is_close_los_circle">
<code class="sig-prename descclassname">tofu.geom._GG.</code><code class="sig-name descname">is_close_los_circle</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tofu.geom._GG.is_close_los_circle" title="Permalink to this definition">¶</a></dt>
<dd><p>This function checks if at maximum a LOS is at a distance epsilon
form a cirlce
The result is True when distance &lt; epsilon
—
This is the PYTHON function, use only if you need this computation from
Python, if you need it from cython, use <cite>is_los_close_circle_core</cite></p>
</dd></dl>

<dl class="function">
<dt id="tofu.geom._GG.is_close_los_circle_vec">
<code class="sig-prename descclassname">tofu.geom._GG.</code><code class="sig-name descname">is_close_los_circle_vec</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tofu.geom._GG.is_close_los_circle_vec" title="Permalink to this definition">¶</a></dt>
<dd><p>This function checks if at maximum a LOS is at a distance epsilon
form a cirlce. Vectorial version
The result is True when distance &lt; epsilon
—
This is the PYTHON function, use only if you need this computation from
Python, if you need it from cython, use <cite>is_los_close_circle_core</cite></p>
</dd></dl>

<dl class="function">
<dt id="tofu.geom._GG.which_los_closer_vpoly_vec">
<code class="sig-prename descclassname">tofu.geom._GG.</code><code class="sig-name descname">which_los_closer_vpoly_vec</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tofu.geom._GG.which_los_closer_vpoly_vec" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><dl>
<dt>nvpoly<span class="classifier">int</span></dt><dd><p>Number of flux surfaces</p>
</dd>
<dt>nlos<span class="classifier">int</span></dt><dd><p>Number of LOS</p>
</dd>
<dt>ray_orig<span class="classifier">(3, nlos) double array</span></dt><dd><p>LOS origin points coordinates</p>
</dd>
<dt>ray_vdir<span class="classifier">(3, nlos) double array</span></dt><dd><p>LOS direction vector</p>
</dd>
<dt>ves_poly<span class="classifier">(num_pol, 2, num_vertex) double array</span></dt><dd><p>Coordinates of the vertices of the Polygon defining the 2D poloidal
cut of the different IN surfaces
WARNING : we suppose all poly are nested in each other,</p>
<blockquote>
<div><p>and the first one is the smallest one</p>
</div></blockquote>
</dd>
<dt>eps_&lt;val&gt;<span class="classifier">double</span></dt><dd><p>Small value, acceptance of error</p>
</dd>
</dl>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>ind_close_los</strong> (<em>(npoly) int array</em>) – Of the form [ind_0, ind_1, …, ind_(npoly-1)]
where ind_i is the coefficient for the i-th flux surface
such that the ind_i-th ray (LOS) is closest to the extruded polygon
among all other LOS without going over it.</p>
</dd>
</dl>
<p>—
This is the PYTHON function, use only if you need this computation from
Python, if you need it from cython, use <cite>which_los_closer_vpoly_vec_core</cite></p>
</dd></dl>

<dl class="function">
<dt id="tofu.geom._GG.which_vpoly_closer_los_vec">
<code class="sig-prename descclassname">tofu.geom._GG.</code><code class="sig-name descname">which_vpoly_closer_los_vec</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tofu.geom._GG.which_vpoly_closer_los_vec" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><dl>
<dt>nvpoly<span class="classifier">int</span></dt><dd><p>Number of flux surfaces</p>
</dd>
<dt>nlos<span class="classifier">int</span></dt><dd><p>Number of LOS</p>
</dd>
<dt>ray_orig<span class="classifier">(3, nlos) double array</span></dt><dd><p>LOS origin points coordinates</p>
</dd>
<dt>ray_vdir<span class="classifier">(3, nlos) double array</span></dt><dd><p>LOS direction vector</p>
</dd>
<dt>ves_poly<span class="classifier">(num_pol, 2, num_vertex) double array</span></dt><dd><p>Coordinates of the vertices of the Polygon defining the 2D poloidal
cut of the different IN surfaces
WARNING : we suppose all poly are nested in each other,</p>
<blockquote>
<div><p>and the first one is the smallest one</p>
</div></blockquote>
</dd>
<dt>eps_&lt;val&gt;<span class="classifier">double</span></dt><dd><p>Small value, acceptance of error</p>
</dd>
</dl>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>ind_close_los</strong> (<em>(nlos) int array</em>) – Of the form [ind_0, ind_1, …, ind_(nlos-1)]
where ind_i is the coefficient for the i-th LOS (ray)
such that the ind_i-th poly (flux surface) is closest to the LOS
among all other poly without going over it.</p>
</dd>
</dl>
<p>—
This is the PYTHON function, use only if you need this computation from
Python, if you need it from cython, use <cite>which_vpoly_closer_los_vec_core</cite></p>
</dd></dl>

<dl class="function">
<dt id="tofu.geom._GG.LOS_sino_findRootkPMin_Tor">
<code class="sig-prename descclassname">tofu.geom._GG.</code><code class="sig-name descname">LOS_sino_findRootkPMin_Tor</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tofu.geom._GG.LOS_sino_findRootkPMin_Tor" title="Permalink to this definition">¶</a></dt>
<dd><p>Rendre “vectoriel” sur LOS et sur les cercles (deux boucles “for”)
intersection ligne et cercle
double uParN : composante de u parallel au plan (x,y)</p>
<blockquote>
<div><p>double uN : uz
double Sca : ??? produit scalaire … ?
double RZ0 : Grand rayon du cercle
double RZ1 : Z
=&gt; cercle est centré au point (0, 0, RZ1) et rayon RZ0
double ScaP : …. ?
double DParN : D origine de LOS…. ? N =&gt; norme de la composante du vecteur OD
double kOut : kmax où on peut trouver un résultat
double D0, double D1, double D2 : composantes de D (origine LOS)
double u0, double u1, double u2 : composantes de U (direction LOS)
str Mode=’LOS’ : si LOS pas de sol après kmax)</p>
</div></blockquote>
<p>::: Faire une fonction double mais qui renvoit QUE un tableau de bool avec true si
la distance est plus petite qu’un certain eps, false sinon.
TODO: ……….. &#64;LM</p>
</dd></dl>

<dl class="function">
<dt id="tofu.geom._GG.Poly_isClockwise">
<code class="sig-prename descclassname">tofu.geom._GG.</code><code class="sig-name descname">Poly_isClockwise</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tofu.geom._GG.Poly_isClockwise" title="Permalink to this definition">¶</a></dt>
<dd><p>Assuming 2D closed Poly !
<a class="reference external" href="http://www.faqs.org/faqs/graphics/algorithms-faq/">http://www.faqs.org/faqs/graphics/algorithms-faq/</a>
Find the lowest vertex (or, if there is more than one vertex with
the same lowest coordinate, the rightmost of those vertices) and then
take the cross product of the edges before and after it.
Both methods are O(n) for n vertices, but it does seem a waste to add up
the total area when a single cross product (of just the right edges)
suffices.  Code for this is available at
<a class="reference external" href="ftp://cs.smith.edu/pub/code/polyorient.C">ftp://cs.smith.edu/pub/code/polyorient.C</a> (2K).</p>
</dd></dl>

<dl class="function">
<dt id="tofu.geom._GG.Poly_VolAngTor">
<code class="sig-prename descclassname">tofu.geom._GG.</code><code class="sig-name descname">Poly_VolAngTor</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tofu.geom._GG.Poly_VolAngTor" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="tofu.geom._GG.poly_area">
<code class="sig-prename descclassname">tofu.geom._GG.</code><code class="sig-name descname">poly_area</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tofu.geom._GG.poly_area" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="tofu.geom._GG.poly_area_and_barycenter">
<code class="sig-prename descclassname">tofu.geom._GG.</code><code class="sig-name descname">poly_area_and_barycenter</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tofu.geom._GG.poly_area_and_barycenter" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="tofu.geom._GG.Sino_ImpactEnv">
<code class="sig-prename descclassname">tofu.geom._GG.</code><code class="sig-name descname">Sino_ImpactEnv</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tofu.geom._GG.Sino_ImpactEnv" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes impact parameters of a Tor enveloppe
(a <cite>Tor</cite> is a closed 2D polygon)</p>
<p>D. VEZINET, Aug. 2014
:param RZ: (2,) array indicating the reference impact point
:type RZ: np.ndarray
:param Poly: (2,N) array containing the coordinatesof a closed polygon
:type Poly: np.ndarray
:param NP: Number of indicating the number of points used for discretising theta between 0 and pi
:type NP: int</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><em>theta</em></p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="tofu.geom._GG.ConvertImpact_Theta2Xi">
<code class="sig-prename descclassname">tofu.geom._GG.</code><code class="sig-name descname">ConvertImpact_Theta2Xi</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tofu.geom._GG.ConvertImpact_Theta2Xi" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="tofu.geom._GG.discretize_line1d">
<code class="sig-prename descclassname">tofu.geom._GG.</code><code class="sig-name descname">discretize_line1d</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tofu.geom._GG.discretize_line1d" title="Permalink to this definition">¶</a></dt>
<dd><p>Discretize a 1D segment LMin-LMax. If <cite>mode</cite> is “abs” (absolute), then the
segment will be discretized in cells each of size <cite>dstep</cite>. Else, if <cite>mode</cite>
is “rel” (relative), the meshing step is relative to the segments norm (ie.
the actual discretization step will be (LMax - LMin)/dstep).
It is possible to only one to discretize the segment on a sub-domain. If so,
the sub-domain limits are given in DL.
:param LMinMax: Gives the limits LMin and LMax of the segment. LMinMax = [LMin, LMax]
:type LMinMax: (2)-double array
:param dstep: Step of discretization, can be absolute (default) or relative
:type dstep: double
:param DL: Sub domain of discretization. If not None and if Lim, LMinMax = DL</p>
<blockquote>
<div><p>(can be only on one limit and can be bigger or smaller than original).
Actual desired limits</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Lim</strong> (<em>(</em><em>optional</em><em>) </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – Indicated if the subdomain should be taken into account</p></li>
<li><p><strong>mode</strong> (<em>(</em><em>optional</em><em>) </em><em>string</em>) – If <cite>mode</cite> is “abs” (absolute), then the
segment will be discretized in cells each of size <cite>dstep</cite>. Else,
if “rel” (relative), the meshing step is relative to the segments norm
(the actual discretization step will be (LMax - LMin)/dstep).</p></li>
<li><p><strong>margin</strong> (<em>(</em><em>optional</em><em>) </em><em>double</em>) – Margin value for cell length</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>ldiscret</strong> (<em>double array</em>) – array of the discretized coordinates on the segment of desired limits</p></li>
<li><p><strong>resolution</strong> (<em>double</em>) – step of discretization</p></li>
<li><p><strong>lindex</strong> (<em>int array</em>) – array of the indices corresponding to ldiscret with respects to the
original segment LMinMax (if no DL, from 0 to N-1)</p></li>
<li><p><strong>N</strong> (<em>int64</em>) – Number of points on LMinMax segment</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="tofu.geom._GG.discretize_segment2d">
<code class="sig-prename descclassname">tofu.geom._GG.</code><code class="sig-name descname">discretize_segment2d</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tofu.geom._GG.discretize_segment2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Discretizes a 2D segment where the 1st coordinates are defined in LMinMax1
and the second ones in LMinMax2. The refinement in x is defined by dstep1,
and dstep2 defines the resolution on y.
Optionnally you can give a VPoly to which the discretized in which the
segment has to be included.
This function is basically a generalization of discretize_line1d.
:param LMinMax1: Gives the limits LMin and LMax of the x coordinates of the segment.</p>
<blockquote>
<div><p>LMinMax1 = [xmin, xmax]</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>LMinMax2</strong> (<em>(</em><em>2</em><em>)</em><em>-double array</em>) – Gives the limits LMin and LMax of the y coordinates of the segment.
LMinMax2 = [ymin, ymax]</p></li>
<li><p><strong>or dstep2</strong> (<em>dstep1</em>) – Step of discretization, can be absolute (default) or relative</p></li>
<li><p><strong>or D2</strong> (<em>D1</em>) – Sub domain of discretization. If not None and if Lim, LMinMax = DL
(can be only on one limit and can be bigger or smaller than original).
Actual desired limits</p></li>
<li><p><strong>mode</strong> (<em>(</em><em>optional</em><em>) </em><em>string</em>) – If <cite>mode</cite> is “abs” (absolute), then the
segment will be discretized in cells each of size <cite>dstep</cite>. Else,
if “rel” (relative), the meshing step is relative to the segments norm
(the actual discretization step will be (LMax - LMin)/dstep).</p></li>
<li><p><strong>margin</strong> (<em>(</em><em>optional</em><em>) </em><em>double</em>) – Margin value for cell length</p></li>
<li><p><strong>VPoly</strong> (<em>(</em><em>optional</em><em>) </em><em>2d double array</em>) – If present, we check that the discretized segment is included in the
path defined by VPoly.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>ldiscret</strong> (<em>double 2d array</em>) – array of the discretized coordinates on the segment of desired limits</p></li>
<li><p><strong>resolution</strong> (<em>double array</em>) – step of discretization on 2d (typically resolution-on-x*resolution-on-y)</p></li>
<li><p><strong>lindex</strong> (<em>int array</em>) – array of the indices corresponding to ldiscret with respects to the
original segment LMinMax (if no DL, from 0 to N-1)</p></li>
<li><p><strong>resol1</strong> (<em>double</em>) – Smallest resolution on x</p></li>
<li><p><strong>resol2</strong> (<em>double</em>) – Smallest resolution on y</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="tofu.geom._GG.discretize_vpoly">
<code class="sig-prename descclassname">tofu.geom._GG.</code><code class="sig-name descname">discretize_vpoly</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tofu.geom._GG.discretize_vpoly" title="Permalink to this definition">¶</a></dt>
<dd><p>Discretizes a VPoly (2D polygon of a cross section in (R,Z) coordinates).
The refinement on R and Z is defined dL.
Optionnally you can give a coefficient (DIn) and the normal vectors going
inwards the VPoly (VIn), and the result will be slightly shifted inwards
(or outwards if DIn&lt;0) of DIn*VIn.
:param VPoly: Coordinates of the vertices of the Polygon defining the 2D poloidal</p>
<blockquote>
<div><p>cut of the Vessel</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dL</strong> (<em>double</em>) – Step of discretization, can be absolute (default) or relative</p></li>
<li><p><strong>or D2</strong> (<em>D1</em>) – Sub domain of discretization.
(can be only on one limit and can be bigger or smaller than original).
Actual desired limits</p></li>
<li><p><strong>mode</strong> (<em>(</em><em>optional</em><em>) </em><em>string</em>) – If <cite>mode</cite> is “abs” (absolute), then the
segment will be discretized in cells each of size <cite>dstep</cite>. Else,
if “rel” (relative), the meshing step is relative to the segments norm</p></li>
<li><p><strong>margin</strong> (<em>(</em><em>optional</em><em>) </em><em>double</em>) – Margin value for cell length</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>return PtsCross, resol, ind_arr, N_arr, Rref_arr, VPolybis</em></p></li>
<li><p><strong>PtsCross</strong> (<em>double 2d array</em>) – array of the discretized coordinates of the VPoly</p></li>
<li><p><strong>resol</strong> (<em>double 1d array</em>) – step of discretization on 2d</p></li>
<li><p><strong>ind_arr</strong> (<em>int  1d array</em>) – array of the indices corresponding to ldiscret with respects to the
original VPoly</p></li>
<li><p><strong>N_arr</strong> (<em>int 1d array</em>) – number of cells on each segment of the VPoly</p></li>
<li><p><strong>Rref_arr</strong> (<em>double 1d array</em>) – reference Radius coordinates, not shifted even if DIn &lt;&gt; 0.
If DIn == 0, then Rref_arr = PtsCross[0, …]</p></li>
<li><p><em>VPolybis</em></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="tofu.geom._GG.LOS_Calc_PInOut_VesStruct">
<code class="sig-prename descclassname">tofu.geom._GG.</code><code class="sig-name descname">LOS_Calc_PInOut_VesStruct</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tofu.geom._GG.LOS_Calc_PInOut_VesStruct" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the entry and exit point of all provided LOS for the provided
vessel polygon (toroidal or linear) with its associated structures.
Return the normal vector at impact and the index of the impact segment</p>
<dl class="simple">
<dt>ray_orig<span class="classifier">(3, nlos) double array</span></dt><dd><p>LOS origin points coordinates</p>
</dd>
<dt>ray_vdir<span class="classifier">(3, nlos) double array</span></dt><dd><p>LOS normalized direction vector</p>
</dd>
<dt>ves_poly<span class="classifier">(2, num_vertex) double array</span></dt><dd><p>Coordinates of the vertices of the Polygon defining the 2D poloidal
cut of the Vessel</p>
</dd>
<dt>ves_norm<span class="classifier">(2, num_vertex-1) double array</span></dt><dd><p>Normal vectors going “inwards” of the edges of the Polygon defined
by ves_poly</p>
</dd>
<dt>nstruct<span class="classifier">int</span></dt><dd><p>Total number of structures (counting each limited structure as one)</p>
</dd>
<dt>ves_lims<span class="classifier">array</span></dt><dd><p>Contains the limits min and max of vessel</p>
</dd>
<dt>lstruct_poly<span class="classifier">list</span></dt><dd><p>List of coordinates of the vertices of all structures on poloidal plane</p>
</dd>
<dt>lstruct_lims<span class="classifier">list</span></dt><dd><p>List of limits of all structures</p>
</dd>
<dt>lstruct_nlim<span class="classifier">array of ints</span></dt><dd><p>List of number of limits for all structures</p>
</dd>
<dt>lstruct_norm<span class="classifier">list</span></dt><dd><p>List of coordinates of “inwards” normal vectors of the polygon of all
the structures</p>
</dd>
<dt>rmin<span class="classifier">double</span></dt><dd><p>Minimal radius of vessel to take into consideration</p>
</dd>
<dt>eps_&lt;val&gt;<span class="classifier">double</span></dt><dd><p>Small value, acceptance of error</p>
</dd>
<dt>vtype<span class="classifier">string</span></dt><dd><p>Type of vessel (“Tor” or “Lin”)</p>
</dd>
<dt>forbid<span class="classifier">bool</span></dt><dd><p>Should we forbid values behind visible radius ? (see rmin)</p>
</dd>
<dt>test<span class="classifier">bool</span></dt><dd><p>Should we run tests ?</p>
</dd>
<dt>num_threads<span class="classifier">int</span></dt><dd><p>The num_threads argument indicates how many threads the team should
consist of. If not given, OpenMP will decide how many threads to use.
Typically this is the number of cores available on the machine.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>coeff_inter_in</strong> (<em>(nlos) array</em>) – scalars level of “in” intersection of the LOS (if k=0 at origin)</p></li>
<li><p><strong>coeff_inter_out</strong> (<em>(nlos) array</em>) – scalars level of “out” intersection of the LOS (if k=0 at origin)</p></li>
<li><p><strong>vperp_out</strong> (<em>(3, nlos) array</em>) – Coordinates of the normal vector of impact of the LOS (NaN if none)</p></li>
<li><p><strong>ind_inter_out</strong> (<em>(3, nlos)</em>) – Index of structure impacted by LOS: ind_inter_out[:,ind_los]=(i,j,k)
where k is the index of edge impacted on the j-th sub structure of the
structure number i. If the LOS impacted the vessel i=j=0</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="tofu.geom._GG.LOS_Calc_kMinkMax_VesStruct">
<code class="sig-prename descclassname">tofu.geom._GG.</code><code class="sig-name descname">LOS_Calc_kMinkMax_VesStruct</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tofu.geom._GG.LOS_Calc_kMinkMax_VesStruct" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the entry and exit point of all provided LOS for the provided
polygons (toroidal or linear)  of IN structures (non-solid, or <cite>empty</cite>
inside for the LOS).
Attention: the surfaces can be limited, but they all have to have the
same limits defined by (ves_lims)
Return the set of kmin / kmax for each In struct and for each LOS</p>
<dl class="simple">
<dt>ray_orig<span class="classifier">(3, nlos) double array</span></dt><dd><p>LOS origin points coordinates</p>
</dd>
<dt>ray_vdir<span class="classifier">(3, nlos) double array</span></dt><dd><p>LOS normalized direction vector</p>
</dd>
<dt>num_surf<span class="classifier">int</span></dt><dd><p>number of surfaxes, aka ‘in’ structures or ‘vessels’</p>
</dd>
<dt>ves_poly<span class="classifier">(num_surf, 2, num_vertex) double array</span></dt><dd><p>Coordinates of the vertices of the Polygon defining the 2D poloidal
cut of the <cite>in</cite> structures</p>
</dd>
<dt>ves_norm<span class="classifier">(num_surf, 2, num_vertex-1) double array</span></dt><dd><p>Normal vectors going “inwards” of the edges of the Polygon defined
by ves_poly</p>
</dd>
<dt>ves_lims<span class="classifier">array</span></dt><dd><p>Contains the limits min and max of vessel</p>
</dd>
<dt>rmin<span class="classifier">double</span></dt><dd><p>Minimal radius of vessel to take into consideration</p>
</dd>
<dt>eps&lt;val&gt;<span class="classifier">double</span></dt><dd><p>Small value, acceptance of error</p>
</dd>
<dt>vtype<span class="classifier">string</span></dt><dd><p>Type of vessel (“Tor” or “Lin”)</p>
</dd>
<dt>forbid<span class="classifier">bool</span></dt><dd><p>Should we forbid values behind visible radius ? (see rmin)</p>
</dd>
<dt>test<span class="classifier">bool</span></dt><dd><p>Should we run tests ?</p>
</dd>
<dt>num_threads<span class="classifier">int</span></dt><dd><p>The num_threads argument indicates how many threads the team should
consist of. If not given, OpenMP will decide how many threads to use.
Typically this is the number of cores available on the machine.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>coeff_inter_in</strong> (<em>(num_surf, nlos) array</em>) – scalars level of “in” intersection of the LOS (if k=0 at origin) for
each surface
[kmin(surf0, los0), kmin(surf0, los1), …, kmin(surf1, los0),….]</p></li>
<li><p><strong>coeff_inter_out</strong> (<em>(num_surf, nlos) array</em>) – scalars level of “out” intersection of the LOS (if k=0 at origin) for
each surface
[kmax(surf0, los0), kmax(surf0, los1), …, kmax(surf1, los0),….]</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="tofu.geom._GG.LOS_isVis_PtFromPts_VesStruct">
<code class="sig-prename descclassname">tofu.geom._GG.</code><code class="sig-name descname">LOS_isVis_PtFromPts_VesStruct</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tofu.geom._GG.LOS_isVis_PtFromPts_VesStruct" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an array of booleans indicating whether each point in pts is
visible from the point P = [pt0, pt1, pt2] considering vignetting a given
configuration.</p>
<blockquote>
<div><p><cite>k</cite> optional argument : distance between points and P
ray_orig = np.tile(np.r_[pt0,pt1,pt2], (npts,1)).T
ray_vdir = (pts-ray_orig)/k</p>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="tofu.geom._GG.LOS_areVis_PtsFromPts_VesStruct">
<code class="sig-prename descclassname">tofu.geom._GG.</code><code class="sig-name descname">LOS_areVis_PtsFromPts_VesStruct</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tofu.geom._GG.LOS_areVis_PtsFromPts_VesStruct" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an array of booleans indicating whether each point in pts is
visible from the point P = [pt0, pt1, pt2] considering vignetting a given
configuration.</p>
<blockquote>
<div><p><cite>k</cite> optional argument : distance between points and P
ray_orig = np.tile(np.r_[pt0,pt1,pt2], (npts,1)).T
ray_vdir = (pts-ray_orig)/k</p>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="tofu.geom._GG.LOS_get_sample">
<code class="sig-prename descclassname">tofu.geom._GG.</code><code class="sig-name descname">LOS_get_sample</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tofu.geom._GG.LOS_get_sample" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the sampled line, with the specified method
-   ‘sum’ :     return N segments centers
-   ‘simps’:    return N+1 egdes, N even (for scipy.integrate.simps)
-   ‘romb’ :    return N+1 edges, N+1 = 2**k+1 (for scipy.integrate.romb)</p>
<blockquote>
<div><p>The dmethod defines if the discretization step given is absolute (‘abs’)
or relative (‘rel’)</p>
</div></blockquote>
<dl class="simple">
<dt>dL: double or list of doubles</dt><dd><p>If dL is a single double: discretization step for all LOS.
Else dL should be a list of size nlos with the discretization
step for each nlos.</p>
</dd>
<dt>los_lims: (2, nlos) double array</dt><dd><p>For each nlos, it given the maximum and minimum limits of the ray</p>
</dd>
<dt>dmethod: string</dt><dd><p>type of discretization step: ‘abs’ for absolute or ‘rel’ for relative</p>
</dd>
<dt>method: string</dt><dd><p>method of quadrature on the LOS</p>
</dd>
<dt>Test: bool</dt><dd><p>to indicate if tests should be done or not</p>
</dd>
</dl>
<p>k, res, lind = Los_get_sample(…)
nbrepet = np.r_[lind[0], np.diff(lind), k.size - lind[-1]]
kus = k * np.repeat(ray_vdir, nbrepet, axis=1)
Pts = np.repeat(ray_orig, nbrepet, axis=1) + kus</p>
</dd></dl>

<dl class="function">
<dt id="tofu.geom._GG.LOS_calc_signal">
<code class="sig-prename descclassname">tofu.geom._GG.</code><code class="sig-name descname">LOS_calc_signal</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tofu.geom._GG.LOS_calc_signal" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the synthetic signal, minimizing either function calls or memory
Params
=====
func : python function st. func(pts, t=None, vect=None) =&gt; data</p>
<blockquote>
<div><dl class="simple">
<dt>with pts<span class="classifier">ndarray (3, npts) - points where function is evaluated</span></dt><dd><p>vect : ndarray(3, npts) - if anisotropic signal vector of emiss.
t: ndarray(m) - times where to compute the function</p>
</dd>
<dt>returns: data<span class="classifier">ndarray(nt,nraf) if nt = 1, the array must be 2D</span></dt><dd><p>values of func at pts, at given time</p>
</dd>
</dl>
<p>func is the function to be integrated along the LOS</p>
</div></blockquote>
<p>ray_orig: ndarray (3, nlos) LOS origins
ray_vdir: ndarray (3, nlos) LOS directional vector
res: double or list of doubles</p>
<blockquote>
<div><p>If res is a single double: discretization step for all LOS.
Else res should be a list of size nlos with the discretization
step for each nlos.</p>
</div></blockquote>
<dl class="simple">
<dt>lims: (2, nlos) double array</dt><dd><p>For each nlos, it given the maximum and minimum limits of the ray</p>
</dd>
<dt>dmethod: string</dt><dd><p>type of discretization step: ‘abs’ for absolute or ‘rel’ for relative</p>
</dd>
<dt>method: string</dt><dd><p>method of quadrature on the LOS</p>
</dd>
<dt>ani<span class="classifier">bool</span></dt><dd><p>to indicate if emission is anisotropic or not</p>
</dd>
<dt>t<span class="classifier">None or array-like</span></dt><dd><p>times where to integrate</p>
</dd>
<dt>minimize: string</dt><dd><p>“calls” : we use algorithm to minimize the calls to ‘func’ (default)
“memory”: we use algorithm to minimize memory used
“hybrid”: a mix of both methods</p>
</dd>
<dt>Test<span class="classifier">bool</span></dt><dd><p>we test if the inputs are giving in a proper way.</p>
</dd>
<dt>num_threads: int</dt><dd><p>number of threads if we want to parallelize the code.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="tofu.geom._GG.LOS_sino">
<code class="sig-prename descclassname">tofu.geom._GG.</code><code class="sig-name descname">LOS_sino</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tofu.geom._GG.LOS_sino" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="tofu.geom._GG.integrate1d">
<code class="sig-prename descclassname">tofu.geom._GG.</code><code class="sig-name descname">integrate1d</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tofu.geom._GG.integrate1d" title="Permalink to this definition">¶</a></dt>
<dd><p>Generic integration method [‘sum’,’simps’,’romb’]</p>
<p>Not used internally
Useful when the sampling points need to be interpolated via equilibrium</p>
</dd></dl>

<dl class="function">
<dt id="tofu.geom._GG.triangulate_by_earclipping">
<code class="sig-prename descclassname">tofu.geom._GG.</code><code class="sig-name descname">triangulate_by_earclipping</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tofu.geom._GG.triangulate_by_earclipping" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="tofu.geom._GG.vignetting">
<code class="sig-prename descclassname">tofu.geom._GG.</code><code class="sig-name descname">vignetting</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tofu.geom._GG.vignetting" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>ray_orig<span class="classifier">(3, nlos) double array</span></dt><dd><p>LOS origin points coordinates</p>
</dd>
<dt>ray_vdir<span class="classifier">(3, nlos) double array</span></dt><dd><p>LOS normalized direction vector</p>
</dd>
<dt>vignett_poly<span class="classifier">(num_vign, 3, num_vertex) double list of arrays</span></dt><dd><p>Coordinates of the vertices of the Polygon defining the 3D vignett.
POLY CLOSED</p>
</dd>
<dt>lnvert<span class="classifier">(num_vign) long array</span></dt><dd><p>Number of vertices for each vignett (without counting the rebound)</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>goes_through</strong> (<em>(num_vign, nlos) bool array</em>) – Indicates for each vignett if each LOS wents through or not</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="tofu.geom._GG.Dust_calc_SolidAngle">
<code class="sig-prename descclassname">tofu.geom._GG.</code><code class="sig-name descname">Dust_calc_SolidAngle</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tofu.geom._GG.Dust_calc_SolidAngle" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the solid angle of a moving particle of varying radius as seen
from any number of pixed points</p>
<p>Can be done w/o the approximation that r&lt;&lt;d
If Ves (and optionally LSPoly) are provided, takes into account vignetting</p>
</dd></dl>

</div>
<div class="section" id="tofu-geom-basic-geom-tools-cpython-36m-darwin-module">
<h2>tofu.geom._basic_geom_tools.cpython-36m-darwin module<a class="headerlink" href="#tofu-geom-basic-geom-tools-cpython-36m-darwin-module" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-tofu.geom._basic_geom_tools">
<span id="tofu-geom-basic-geom-tools-module"></span><h2>tofu.geom._basic_geom_tools module<a class="headerlink" href="#module-tofu.geom._basic_geom_tools" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-tofu.geom._comp">
<span id="tofu-geom-comp-module"></span><h2>tofu.geom._comp module<a class="headerlink" href="#module-tofu.geom._comp" title="Permalink to this headline">¶</a></h2>
<p>This module is the computational part of the geometrical module of ToFu</p>
<dl class="function">
<dt id="tofu.geom._comp.LOS_CrossProj">
<code class="sig-prename descclassname">tofu.geom._comp.</code><code class="sig-name descname">LOS_CrossProj</code><span class="sig-paren">(</span><em class="sig-param">VType</em>, <em class="sig-param">Ds</em>, <em class="sig-param">us</em>, <em class="sig-param">kOuts</em>, <em class="sig-param">proj='All'</em>, <em class="sig-param">multi=False</em>, <em class="sig-param">num_threads=16</em>, <em class="sig-param">return_pts=False</em>, <em class="sig-param">Test=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_comp.html#LOS_CrossProj"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._comp.LOS_CrossProj" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the parameters to plot the poloidal projection of the LOS</p>
</dd></dl>

<dl class="function">
<dt id="tofu.geom._comp.LOS_PRMin">
<code class="sig-prename descclassname">tofu.geom._comp.</code><code class="sig-name descname">LOS_PRMin</code><span class="sig-paren">(</span><em class="sig-param">Ds</em>, <em class="sig-param">us</em>, <em class="sig-param">kOut=None</em>, <em class="sig-param">Eps=1e-12</em>, <em class="sig-param">squeeze=True</em>, <em class="sig-param">Test=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_comp.html#LOS_PRMin"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._comp.LOS_PRMin" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the point on the LOS where the major radius is minimum</p>
</dd></dl>

<dl class="function">
<dt id="tofu.geom._comp.LOS_calc_signal">
<code class="sig-prename descclassname">tofu.geom._comp.</code><code class="sig-name descname">LOS_calc_signal</code><span class="sig-paren">(</span><em class="sig-param">ff</em>, <em class="sig-param">D</em>, <em class="sig-param">u</em>, <em class="sig-param">dL</em>, <em class="sig-param">DL=None</em>, <em class="sig-param">dLMode='abs'</em>, <em class="sig-param">method='romb'</em>, <em class="sig-param">Test=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_comp.html#LOS_calc_signal"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._comp.LOS_calc_signal" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="tofu.geom._comp.LOS_get_sample">
<code class="sig-prename descclassname">tofu.geom._comp.</code><code class="sig-name descname">LOS_get_sample</code><span class="sig-paren">(</span><em class="sig-param">D</em>, <em class="sig-param">u</em>, <em class="sig-param">dL</em>, <em class="sig-param">DL=None</em>, <em class="sig-param">dLMode='abs'</em>, <em class="sig-param">method='sum'</em>, <em class="sig-param">Test=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_comp.html#LOS_get_sample"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._comp.LOS_get_sample" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the sampled line, with the specified method</p>
<p>‘linspace’: return the N+1 edges, including the first and last point
‘sum’ : return the N middle of the segments
‘simps’: return the N+1 egdes, where N has to be even</p>
<blockquote>
<div><p>(scipy.simpson requires an even number of intervals)</p>
</div></blockquote>
<dl class="simple">
<dt>‘romb’<span class="classifier">return the N+1 edges, where N+1 = 2**k+1</span></dt><dd><p>(fed to scipy.romb for integration)</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="tofu.geom._comp.calc_solidangle_particle">
<code class="sig-prename descclassname">tofu.geom._comp.</code><code class="sig-name descname">calc_solidangle_particle</code><span class="sig-paren">(</span><em class="sig-param">traj</em>, <em class="sig-param">pts</em>, <em class="sig-param">r=1.0</em>, <em class="sig-param">config=None</em>, <em class="sig-param">approx=True</em>, <em class="sig-param">aniso=False</em>, <em class="sig-param">block=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_comp.html#calc_solidangle_particle"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._comp.calc_solidangle_particle" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the solid angle subtended by a particle along a trajectory</p>
<p>The particle has radius r, and trajectory (array of points) traj
It is observed from pts (array of points)</p>
<p>traj and pts are (3,N) and (3,M) arrays of cartesian coordinates</p>
<p>approx = True =&gt; use approximation
aniso = True =&gt; return also unit vector of emission
block = True consider LOS collisions (with Ves, Struct…)</p>
<dl class="simple">
<dt>if block:</dt><dd><p>config = config used for LOS collisions</p>
</dd>
</dl>
<dl class="simple">
<dt>sang: np.ndarray</dt><dd><p>(N,M) Array of floats, solid angles</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="tofu.geom._comp.calc_solidangle_particle_integ">
<code class="sig-prename descclassname">tofu.geom._comp.</code><code class="sig-name descname">calc_solidangle_particle_integ</code><span class="sig-paren">(</span><em class="sig-param">traj</em>, <em class="sig-param">r=1.0</em>, <em class="sig-param">config=None</em>, <em class="sig-param">approx=True</em>, <em class="sig-param">block=True</em>, <em class="sig-param">res=0.01</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_comp.html#calc_solidangle_particle_integ"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._comp.calc_solidangle_particle_integ" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-tofu.geom._comp_optics">
<span id="tofu-geom-comp-optics-module"></span><h2>tofu.geom._comp_optics module<a class="headerlink" href="#module-tofu.geom._comp_optics" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="tofu.geom._comp_optics.CrystBragg_get_noute1e2_from_psitheta">
<code class="sig-prename descclassname">tofu.geom._comp_optics.</code><code class="sig-name descname">CrystBragg_get_noute1e2_from_psitheta</code><span class="sig-paren">(</span><em class="sig-param">nout</em>, <em class="sig-param">e1</em>, <em class="sig-param">e2</em>, <em class="sig-param">psi</em>, <em class="sig-param">theta</em>, <em class="sig-param">e1e2=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_comp_optics.html#CrystBragg_get_noute1e2_from_psitheta"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._comp_optics.CrystBragg_get_noute1e2_from_psitheta" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="tofu.geom._comp_optics.CrystBragg_sample_outline_Rays">
<code class="sig-prename descclassname">tofu.geom._comp_optics.</code><code class="sig-name descname">CrystBragg_sample_outline_Rays</code><span class="sig-paren">(</span><em class="sig-param">center</em>, <em class="sig-param">nout</em>, <em class="sig-param">e1</em>, <em class="sig-param">e2</em>, <em class="sig-param">rcurve</em>, <em class="sig-param">extenthalf</em>, <em class="sig-param">bragg</em>, <em class="sig-param">phi</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_comp_optics.html#CrystBragg_sample_outline_Rays"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._comp_optics.CrystBragg_sample_outline_Rays" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="tofu.geom._comp_optics.CrystBragg_sample_outline_plot_sphrect">
<code class="sig-prename descclassname">tofu.geom._comp_optics.</code><code class="sig-name descname">CrystBragg_sample_outline_plot_sphrect</code><span class="sig-paren">(</span><em class="sig-param">center</em>, <em class="sig-param">nout</em>, <em class="sig-param">e1</em>, <em class="sig-param">e2</em>, <em class="sig-param">rcurve</em>, <em class="sig-param">extenthalf</em>, <em class="sig-param">res=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_comp_optics.html#CrystBragg_sample_outline_plot_sphrect"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._comp_optics.CrystBragg_sample_outline_plot_sphrect" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="tofu.geom._comp_optics.CrystBragg_sample_outline_sphrect">
<code class="sig-prename descclassname">tofu.geom._comp_optics.</code><code class="sig-name descname">CrystBragg_sample_outline_sphrect</code><span class="sig-paren">(</span><em class="sig-param">dpsi</em>, <em class="sig-param">dtheta</em>, <em class="sig-param">npsi=None</em>, <em class="sig-param">ntheta=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_comp_optics.html#CrystBragg_sample_outline_sphrect"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._comp_optics.CrystBragg_sample_outline_sphrect" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="tofu.geom._comp_optics.calc_braggphi_from_xixjpts">
<code class="sig-prename descclassname">tofu.geom._comp_optics.</code><code class="sig-name descname">calc_braggphi_from_xixjpts</code><span class="sig-paren">(</span><em class="sig-param">det_cent</em>, <em class="sig-param">det_ei</em>, <em class="sig-param">det_ej</em>, <em class="sig-param">summit</em>, <em class="sig-param">nin</em>, <em class="sig-param">e1</em>, <em class="sig-param">e2</em>, <em class="sig-param">xi=None</em>, <em class="sig-param">xj=None</em>, <em class="sig-param">pts=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_comp_optics.html#calc_braggphi_from_xixjpts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._comp_optics.calc_braggphi_from_xixjpts" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="tofu.geom._comp_optics.calc_psidthetaphi_from_pts_lamb">
<code class="sig-prename descclassname">tofu.geom._comp_optics.</code><code class="sig-name descname">calc_psidthetaphi_from_pts_lamb</code><span class="sig-paren">(</span><em class="sig-param">pts</em>, <em class="sig-param">center</em>, <em class="sig-param">rcurve</em>, <em class="sig-param">bragg</em>, <em class="sig-param">nlamb</em>, <em class="sig-param">npts</em>, <em class="sig-param">nout</em>, <em class="sig-param">e1</em>, <em class="sig-param">e2</em>, <em class="sig-param">extenthalf</em>, <em class="sig-param">ntheta=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_comp_optics.html#calc_psidthetaphi_from_pts_lamb"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._comp_optics.calc_psidthetaphi_from_pts_lamb" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="tofu.geom._comp_optics.calc_xixj_from_braggphi">
<code class="sig-prename descclassname">tofu.geom._comp_optics.</code><code class="sig-name descname">calc_xixj_from_braggphi</code><span class="sig-paren">(</span><em class="sig-param">summit</em>, <em class="sig-param">det_cent</em>, <em class="sig-param">det_nout</em>, <em class="sig-param">det_ei</em>, <em class="sig-param">det_ej</em>, <em class="sig-param">nout</em>, <em class="sig-param">e1</em>, <em class="sig-param">e2</em>, <em class="sig-param">bragg</em>, <em class="sig-param">phi</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_comp_optics.html#calc_xixj_from_braggphi"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._comp_optics.calc_xixj_from_braggphi" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="tofu.geom._comp_optics.checkformat_vectang">
<code class="sig-prename descclassname">tofu.geom._comp_optics.</code><code class="sig-name descname">checkformat_vectang</code><span class="sig-paren">(</span><em class="sig-param">Z</em>, <em class="sig-param">nn</em>, <em class="sig-param">frame_cent</em>, <em class="sig-param">frame_ang</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_comp_optics.html#checkformat_vectang"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._comp_optics.checkformat_vectang" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="tofu.geom._comp_optics.get_approx_detector_rel">
<code class="sig-prename descclassname">tofu.geom._comp_optics.</code><code class="sig-name descname">get_approx_detector_rel</code><span class="sig-paren">(</span><em class="sig-param">rcurve</em>, <em class="sig-param">bragg</em>, <em class="sig-param">tangent_to_rowland=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_comp_optics.html#get_approx_detector_rel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._comp_optics.get_approx_detector_rel" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="tofu.geom._comp_optics.get_bragg_from_lamb">
<code class="sig-prename descclassname">tofu.geom._comp_optics.</code><code class="sig-name descname">get_bragg_from_lamb</code><span class="sig-paren">(</span><em class="sig-param">lamb</em>, <em class="sig-param">d</em>, <em class="sig-param">n=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_comp_optics.html#get_bragg_from_lamb"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._comp_optics.get_bragg_from_lamb" title="Permalink to this definition">¶</a></dt>
<dd><p>n*lamb = 2d*sin(bragg)</p>
</dd></dl>

<dl class="function">
<dt id="tofu.geom._comp_optics.get_det_abs_from_rel">
<code class="sig-prename descclassname">tofu.geom._comp_optics.</code><code class="sig-name descname">get_det_abs_from_rel</code><span class="sig-paren">(</span><em class="sig-param">det_dist</em>, <em class="sig-param">n_crystdet_rel</em>, <em class="sig-param">det_nout_rel</em>, <em class="sig-param">det_ei_rel</em>, <em class="sig-param">summit</em>, <em class="sig-param">nout</em>, <em class="sig-param">e1</em>, <em class="sig-param">e2</em>, <em class="sig-param">ddist=None</em>, <em class="sig-param">di=None</em>, <em class="sig-param">dj=None</em>, <em class="sig-param">dtheta=None</em>, <em class="sig-param">dpsi=None</em>, <em class="sig-param">tilt=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_comp_optics.html#get_det_abs_from_rel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._comp_optics.get_det_abs_from_rel" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="tofu.geom._comp_optics.get_e1e2_detectorplane">
<code class="sig-prename descclassname">tofu.geom._comp_optics.</code><code class="sig-name descname">get_e1e2_detectorplane</code><span class="sig-paren">(</span><em class="sig-param">nn</em>, <em class="sig-param">nIn</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_comp_optics.html#get_e1e2_detectorplane"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._comp_optics.get_e1e2_detectorplane" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="tofu.geom._comp_optics.get_lamb_from_bragg">
<code class="sig-prename descclassname">tofu.geom._comp_optics.</code><code class="sig-name descname">get_lamb_from_bragg</code><span class="sig-paren">(</span><em class="sig-param">bragg</em>, <em class="sig-param">d</em>, <em class="sig-param">n=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_comp_optics.html#get_lamb_from_bragg"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._comp_optics.get_lamb_from_bragg" title="Permalink to this definition">¶</a></dt>
<dd><p>n*lamb = 2d*sin(bragg)</p>
</dd></dl>

<dl class="function">
<dt id="tofu.geom._comp_optics.get_lambphifit">
<code class="sig-prename descclassname">tofu.geom._comp_optics.</code><code class="sig-name descname">get_lambphifit</code><span class="sig-paren">(</span><em class="sig-param">lamb</em>, <em class="sig-param">phi</em>, <em class="sig-param">nxi</em>, <em class="sig-param">nxj</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_comp_optics.html#get_lambphifit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._comp_optics.get_lambphifit" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-tofu.geom._core">
<span id="tofu-geom-core-module"></span><h2>tofu.geom._core module<a class="headerlink" href="#module-tofu.geom._core" title="Permalink to this headline">¶</a></h2>
<p>This module is the geometrical part of the ToFu general package
It includes all functions and object classes necessary for tomography
on Tokamaks</p>
<dl class="class">
<dt id="tofu.geom._core.PlasmaDomain">
<em class="property">class </em><code class="sig-prename descclassname">tofu.geom._core.</code><code class="sig-name descname">PlasmaDomain</code><span class="sig-paren">(</span><em class="sig-param">Poly=None, Type=None, Lim=None, pos=None, extent=None, mobile=False, Id=None, Name=None, Exp=None, shot=None, sino_RefPt=None, sino_nP=50, Clock=False, arrayorder='C', fromdict=None, sep=None, SavePath='/Users/mendoza/tofu/doc/source', SavePath_Include=['Mod', 'Cls', 'Type', 'Exp', 'Deg', 'Diag', 'Name', 'shot'], color=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_core.html#PlasmaDomain"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._core.PlasmaDomain" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tofu.geom._core.StructIn</span></code></p>
</dd></dl>

<dl class="class">
<dt id="tofu.geom._core.Ves">
<em class="property">class </em><code class="sig-prename descclassname">tofu.geom._core.</code><code class="sig-name descname">Ves</code><span class="sig-paren">(</span><em class="sig-param">Poly=None, Type=None, Lim=None, pos=None, extent=None, mobile=False, Id=None, Name=None, Exp=None, shot=None, sino_RefPt=None, sino_nP=50, Clock=False, arrayorder='C', fromdict=None, sep=None, SavePath='/Users/mendoza/tofu/doc/source', SavePath_Include=['Mod', 'Cls', 'Type', 'Exp', 'Deg', 'Diag', 'Name', 'shot'], color=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_core.html#Ves"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._core.Ves" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tofu.geom._core.StructIn</span></code></p>
</dd></dl>

<dl class="class">
<dt id="tofu.geom._core.PFC">
<em class="property">class </em><code class="sig-prename descclassname">tofu.geom._core.</code><code class="sig-name descname">PFC</code><span class="sig-paren">(</span><em class="sig-param">Poly=None, Type=None, Lim=None, pos=None, extent=None, mobile=False, Id=None, Name=None, Exp=None, shot=None, sino_RefPt=None, sino_nP=50, Clock=False, arrayorder='C', fromdict=None, sep=None, SavePath='/Users/mendoza/tofu/doc/source', SavePath_Include=['Mod', 'Cls', 'Type', 'Exp', 'Deg', 'Diag', 'Name', 'shot'], color=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_core.html#PFC"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._core.PFC" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tofu.geom._core.StructOut</span></code></p>
</dd></dl>

<dl class="class">
<dt id="tofu.geom._core.CoilPF">
<em class="property">class </em><code class="sig-prename descclassname">tofu.geom._core.</code><code class="sig-name descname">CoilPF</code><span class="sig-paren">(</span><em class="sig-param">nturns=None</em>, <em class="sig-param">superconducting=None</em>, <em class="sig-param">active=None</em>, <em class="sig-param">**kwdargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_core.html#CoilPF"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._core.CoilPF" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tofu.geom._core.StructOut</span></code></p>
<dl class="method">
<dt id="tofu.geom._core.CoilPF.current">
<em class="property">property </em><code class="sig-name descname">current</code><a class="headerlink" href="#tofu.geom._core.CoilPF.current" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tofu.geom._core.CoilPF.dmag">
<em class="property">property </em><code class="sig-name descname">dmag</code><a class="headerlink" href="#tofu.geom._core.CoilPF.dmag" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tofu.geom._core.CoilPF.nturns">
<em class="property">property </em><code class="sig-name descname">nturns</code><a class="headerlink" href="#tofu.geom._core.CoilPF.nturns" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tofu.geom._core.CoilPF.set_current">
<code class="sig-name descname">set_current</code><span class="sig-paren">(</span><em class="sig-param">current=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_core.html#CoilPF.set_current"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._core.CoilPF.set_current" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the current circulating on the coil (A)</p>
</dd></dl>

<dl class="method">
<dt id="tofu.geom._core.CoilPF.set_dmag">
<code class="sig-name descname">set_dmag</code><span class="sig-paren">(</span><em class="sig-param">superconducting=None</em>, <em class="sig-param">nturns=None</em>, <em class="sig-param">active=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_core.html#CoilPF.set_dmag"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._core.CoilPF.set_dmag" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tofu.geom._core.CoilPF.strip">
<code class="sig-name descname">strip</code><span class="sig-paren">(</span><em class="sig-param">strip=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_core.html#CoilPF.strip"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._core.CoilPF.strip" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove non-essential attributes to save memory / disk usage</p>
<p>Useful to save a very compressed version of the object
The higher strip =&gt; the more stripped the object
Use strip=0 to recover all atributes</p>
<dl class="simple">
<dt>See the difference by doing:</dt><dd><p>&gt; self.get_nbytes()
&gt; self.strip(-1)
&gt; self.get_nbytes()</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>strip</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – <dl>
<dt>Flag indicating how much to strip from the object</dt><dd><blockquote>
<div><p>0: Make complete (retrieve all attributes)
1: Remove dsino and dmag expendables
2: Remove also dgeom, dphys and dmisc expendables</p>
</div></blockquote>
<p>-1: Equivalent to strip=2</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="tofu.geom._core.CoilCS">
<em class="property">class </em><code class="sig-prename descclassname">tofu.geom._core.</code><code class="sig-name descname">CoilCS</code><span class="sig-paren">(</span><em class="sig-param">nturns=None</em>, <em class="sig-param">superconducting=None</em>, <em class="sig-param">active=None</em>, <em class="sig-param">**kwdargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_core.html#CoilCS"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._core.CoilCS" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#tofu.geom._core.CoilPF" title="tofu.geom._core.CoilPF"><code class="xref py py-class docutils literal notranslate"><span class="pre">tofu.geom._core.CoilPF</span></code></a></p>
</dd></dl>

<dl class="class">
<dt id="tofu.geom._core.Config">
<em class="property">class </em><code class="sig-prename descclassname">tofu.geom._core.</code><code class="sig-name descname">Config</code><span class="sig-paren">(</span><em class="sig-param">lStruct=None, Lim=None, dextraprop=None, Id=None, Name=None, Exp=None, shot=None, Type=None, SavePath='/Users/mendoza/tofu/doc/source', SavePath_Include=['Mod', 'Cls', 'Type', 'Exp', 'Deg', 'Diag', 'Name', 'shot'], fromdict=None, sep=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_core.html#Config"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._core.Config" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="tofu.html#tofu.utils.ToFuObject" title="tofu.utils.ToFuObject"><code class="xref py py-class docutils literal notranslate"><span class="pre">tofu.utils.ToFuObject</span></code></a></p>
<dl class="method">
<dt id="tofu.geom._core.Config.Lim">
<em class="property">property </em><code class="sig-name descname">Lim</code><a class="headerlink" href="#tofu.geom._core.Config.Lim" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tofu.geom._core.Config.add_Struct">
<code class="sig-name descname">add_Struct</code><span class="sig-paren">(</span><em class="sig-param">struct=None</em>, <em class="sig-param">Cls=None</em>, <em class="sig-param">Name=None</em>, <em class="sig-param">Poly=None</em>, <em class="sig-param">mobile=False</em>, <em class="sig-param">shot=None</em>, <em class="sig-param">Lim=None</em>, <em class="sig-param">Type=None</em>, <em class="sig-param">dextraprop=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_core.html#Config.add_Struct"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._core.Config.add_Struct" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a Struct instance to the config</p>
<p>An already existing Struct subclass instance can be added
Or it will be created from the (Cls,Name,Poly,Lim) keyword args</p>
</dd></dl>

<dl class="method">
<dt id="tofu.geom._core.Config.add_extraprop">
<code class="sig-name descname">add_extraprop</code><span class="sig-paren">(</span><em class="sig-param">key</em>, <em class="sig-param">val</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_core.html#Config.add_extraprop"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._core.Config.add_extraprop" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tofu.geom._core.Config.dStruct">
<em class="property">property </em><code class="sig-name descname">dStruct</code><a class="headerlink" href="#tofu.geom._core.Config.dStruct" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tofu.geom._core.Config.dextraprop">
<em class="property">property </em><code class="sig-name descname">dextraprop</code><a class="headerlink" href="#tofu.geom._core.Config.dextraprop" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tofu.geom._core.Config.dsino">
<em class="property">property </em><code class="sig-name descname">dsino</code><a class="headerlink" href="#tofu.geom._core.Config.dsino" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tofu.geom._core.Config.fdistfromwall">
<code class="sig-name descname">fdistfromwall</code><span class="sig-paren">(</span><em class="sig-param">r</em>, <em class="sig-param">z</em>, <em class="sig-param">phi</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_core.html#Config.fdistfromwall"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._core.Config.fdistfromwall" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a callable (function) for detecting trajectory collisions
with wall</p>
<p>The function is continuous wrt time and space
It takes into account all Struct in Config, including non-axisymmetric
ones</p>
<p>It is desined for iterative root-finding algorithms and is thus called
for a unique position</p>
</dd></dl>

<dl class="method">
<dt id="tofu.geom._core.Config.get_color">
<code class="sig-name descname">get_color</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_core.html#Config.get_color"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._core.Config.get_color" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the array of rgba colors (same order as lStruct)</p>
</dd></dl>

<dl class="method">
<dt id="tofu.geom._core.Config.get_kwdargs_LOS_isVis">
<code class="sig-name descname">get_kwdargs_LOS_isVis</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_core.html#Config.get_kwdargs_LOS_isVis"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._core.Config.get_kwdargs_LOS_isVis" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tofu.geom._core.Config.get_reflections">
<code class="sig-name descname">get_reflections</code><span class="sig-paren">(</span><em class="sig-param">indout</em>, <em class="sig-param">u=None</em>, <em class="sig-param">vperp=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_core.html#Config.get_reflections"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._core.Config.get_reflections" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tofu.geom._core.Config.get_summary">
<code class="sig-name descname">get_summary</code><span class="sig-paren">(</span><em class="sig-param">sep='  '</em>, <em class="sig-param">line='-'</em>, <em class="sig-param">just='l'</em>, <em class="sig-param">table_sep=None</em>, <em class="sig-param">verb=True</em>, <em class="sig-param">return_=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_core.html#Config.get_summary"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._core.Config.get_summary" title="Permalink to this definition">¶</a></dt>
<dd><p>Summary description of the object content</p>
</dd></dl>

<dl class="method">
<dt id="tofu.geom._core.Config.isInside">
<code class="sig-name descname">isInside</code><span class="sig-paren">(</span><em class="sig-param">pts</em>, <em class="sig-param">In='(X</em>, <em class="sig-param">Y</em>, <em class="sig-param">Z)'</em>, <em class="sig-param">log='any'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_core.html#Config.isInside"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._core.Config.isInside" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a 2D array of bool</p>
<p>Equivalent to applying isInside to each Struct
Check self.lStruct[0].isInside? for details</p>
<dl class="simple">
<dt>Arg log determines how Struct with multiple Limits are treated</dt><dd><ul class="simple">
<li><p>‘all’ : True only if pts belong to all elements</p></li>
<li><p>‘any’ : True if pts belong to any element</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="tofu.geom._core.Config.lStruct">
<em class="property">property </em><code class="sig-name descname">lStruct</code><a class="headerlink" href="#tofu.geom._core.Config.lStruct" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the list of Struct that was used for creation</p>
<p>As tofu objects or SavePath+SaveNames (according to strip status)</p>
</dd></dl>

<dl class="method">
<dt id="tofu.geom._core.Config.lStructIn">
<em class="property">property </em><code class="sig-name descname">lStructIn</code><a class="headerlink" href="#tofu.geom._core.Config.lStructIn" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the list of StructIn contained in self.lStruct</p>
<p>As tofu objects or SavePath+SaveNames (according to strip status)</p>
</dd></dl>

<dl class="method">
<dt id="tofu.geom._core.Config.nLim">
<em class="property">property </em><code class="sig-name descname">nLim</code><a class="headerlink" href="#tofu.geom._core.Config.nLim" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tofu.geom._core.Config.nStruct">
<em class="property">property </em><code class="sig-name descname">nStruct</code><a class="headerlink" href="#tofu.geom._core.Config.nStruct" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tofu.geom._core.Config.plot">
<code class="sig-name descname">plot</code><span class="sig-paren">(</span><em class="sig-param">lax=None</em>, <em class="sig-param">proj='all'</em>, <em class="sig-param">element='P'</em>, <em class="sig-param">dLeg={'bbox_to_anchor': (1.01</em>, <em class="sig-param">1)</em>, <em class="sig-param">'borderaxespad': 0.0</em>, <em class="sig-param">'frameon': False</em>, <em class="sig-param">'loc': 2</em>, <em class="sig-param">'ncol': 1</em>, <em class="sig-param">'prop': {'size': 10}}</em>, <em class="sig-param">indices=False</em>, <em class="sig-param">Lim=None</em>, <em class="sig-param">Nstep=None</em>, <em class="sig-param">draw=True</em>, <em class="sig-param">fs=None</em>, <em class="sig-param">wintit=None</em>, <em class="sig-param">tit=None</em>, <em class="sig-param">Test=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_core.html#Config.plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._core.Config.plot" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tofu.geom._core.Config.plot_phithetaproj_dist">
<code class="sig-name descname">plot_phithetaproj_dist</code><span class="sig-paren">(</span><em class="sig-param">refpt=None</em>, <em class="sig-param">ntheta=None</em>, <em class="sig-param">nphi=None</em>, <em class="sig-param">theta=None</em>, <em class="sig-param">phi=None</em>, <em class="sig-param">cmap=None</em>, <em class="sig-param">invertx=None</em>, <em class="sig-param">ax=None</em>, <em class="sig-param">fs=None</em>, <em class="sig-param">tit=None</em>, <em class="sig-param">wintit=None</em>, <em class="sig-param">draw=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_core.html#Config.plot_phithetaproj_dist"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._core.Config.plot_phithetaproj_dist" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tofu.geom._core.Config.plot_sino">
<code class="sig-name descname">plot_sino</code><span class="sig-paren">(</span><em class="sig-param">ax=None</em>, <em class="sig-param">dP=None</em>, <em class="sig-param">Ang='theta'</em>, <em class="sig-param">AngUnit='rad'</em>, <em class="sig-param">Sketch=True</em>, <em class="sig-param">dLeg={'bbox_to_anchor': (1.01</em>, <em class="sig-param">1)</em>, <em class="sig-param">'borderaxespad': 0.0</em>, <em class="sig-param">'frameon': False</em>, <em class="sig-param">'loc': 2</em>, <em class="sig-param">'ncol': 1</em>, <em class="sig-param">'prop': {'size': 10}}</em>, <em class="sig-param">draw=True</em>, <em class="sig-param">fs=None</em>, <em class="sig-param">wintit=None</em>, <em class="sig-param">tit=None</em>, <em class="sig-param">Test=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_core.html#Config.plot_sino"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._core.Config.plot_sino" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tofu.geom._core.Config.remove_Struct">
<code class="sig-name descname">remove_Struct</code><span class="sig-paren">(</span><em class="sig-param">Cls=None</em>, <em class="sig-param">Name=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_core.html#Config.remove_Struct"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._core.Config.remove_Struct" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tofu.geom._core.Config.save_to_imas">
<code class="sig-name descname">save_to_imas</code><span class="sig-paren">(</span><em class="sig-param">shot=None</em>, <em class="sig-param">run=None</em>, <em class="sig-param">refshot=None</em>, <em class="sig-param">refrun=None</em>, <em class="sig-param">user=None</em>, <em class="sig-param">tokamak=None</em>, <em class="sig-param">version=None</em>, <em class="sig-param">occ=None</em>, <em class="sig-param">dryrun=False</em>, <em class="sig-param">verb=True</em>, <em class="sig-param">description_2d=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_core.html#Config.save_to_imas"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._core.Config.save_to_imas" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tofu.geom._core.Config.set_colors_random">
<code class="sig-name descname">set_colors_random</code><span class="sig-paren">(</span><em class="sig-param">cmap=&lt;matplotlib.colors.ListedColormap object&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_core.html#Config.set_colors_random"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._core.Config.set_colors_random" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tofu.geom._core.Config.set_dsino">
<code class="sig-name descname">set_dsino</code><span class="sig-paren">(</span><em class="sig-param">RefPt</em>, <em class="sig-param">nP=50</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_core.html#Config.set_dsino"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._core.Config.set_dsino" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tofu.geom._core.Config.strip">
<code class="sig-name descname">strip</code><span class="sig-paren">(</span><em class="sig-param">strip=0</em>, <em class="sig-param">force=False</em>, <em class="sig-param">verb=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_core.html#Config.strip"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._core.Config.strip" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove non-essential attributes to save memory / disk usage</p>
<p>Useful to save a very compressed version of the object
The higher strip =&gt; the more stripped the object
Use strip=0 to recover all atributes</p>
<dl class="simple">
<dt>See the difference by doing:</dt><dd><p>&gt; self.get_nbytes()
&gt; self.strip(-1)
&gt; self.get_nbytes()</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>strip</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – <dl>
<dt>Flag indicating how much to strip from the object</dt><dd><blockquote>
<div><p>0: Make complete (retrieve all attributes)
1: apply strip(1) to objects in self.lStruct
2: apply strip(2) to objects in self.lStruct
3: replace objects in self.lStruct by SavePath + SaveName</p>
</div></blockquote>
<p>-1: Equivalent to strip=3</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="tofu.geom._core.Rays">
<em class="property">class </em><code class="sig-prename descclassname">tofu.geom._core.</code><code class="sig-name descname">Rays</code><span class="sig-paren">(</span><em class="sig-param">dgeom=None</em>, <em class="sig-param">lOptics=None</em>, <em class="sig-param">Etendues=None</em>, <em class="sig-param">Surfaces=None</em>, <em class="sig-param">config=None</em>, <em class="sig-param">dchans=None</em>, <em class="sig-param">dX12='geom'</em>, <em class="sig-param">Id=None</em>, <em class="sig-param">Name=None</em>, <em class="sig-param">Exp=None</em>, <em class="sig-param">shot=None</em>, <em class="sig-param">Diag=None</em>, <em class="sig-param">sino_RefPt=None</em>, <em class="sig-param">fromdict=None</em>, <em class="sig-param">sep=None</em>, <em class="sig-param">method='optimized'</em>, <em class="sig-param">SavePath='/Users/mendoza/tofu/doc/source'</em>, <em class="sig-param">color=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_core.html#Rays"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._core.Rays" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="tofu.html#tofu.utils.ToFuObject" title="tofu.utils.ToFuObject"><code class="xref py py-class docutils literal notranslate"><span class="pre">tofu.utils.ToFuObject</span></code></a></p>
<p>Parent class of rays (ray-tracing), LOS, CamLOS1D and CamLOS2D</p>
<p>Focused on optimizing the computation time for many rays.</p>
<p>Each ray is defined by a starting point (D) and a unit vector(u).
If a vessel (Ves) and structural elements (LStruct) are provided,
the intersection points are automatically computed.</p>
<p>Methods for plootting, computing synthetic signal are provided.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Id</strong> (str  / <a class="reference internal" href="tofu.html#tofu.pathfile.ID" title="tofu.pathfile.ID"><code class="xref py py-class docutils literal notranslate"><span class="pre">ID</span></code></a>) – A name string or a <a class="reference internal" href="tofu.html#tofu.pathfile.ID" title="tofu.pathfile.ID"><code class="xref py py-class docutils literal notranslate"><span class="pre">ID</span></code></a> to identify this
instance,
if a string is provided, it is fed to <a class="reference internal" href="tofu.html#tofu.pathfile.ID" title="tofu.pathfile.ID"><code class="xref py py-class docutils literal notranslate"><span class="pre">ID</span></code></a></p></li>
<li><p><strong>Du</strong> (<em>iterable</em>) – <dl class="simple">
<dt>Iterable of len=2, containing 2 np.ndarrays represnting, for N rays:</dt><dd><ul>
<li><p>Ds: a (3,N) array of the (X,Y,Z) coordinates of starting points</p></li>
<li><p>us: a (3,N) array of the (X,Y,Z) coordinates of the unit vectors</p></li>
</ul>
</dd>
</dl>
</p></li>
<li><p><strong>Ves</strong> (None / <code class="xref py py-class docutils literal notranslate"><span class="pre">Ves</span></code>) – A <code class="xref py py-class docutils literal notranslate"><span class="pre">Ves</span></code> instance to be associated to the rays</p></li>
<li><p><strong>LStruct</strong> (None / <code class="xref py py-class docutils literal notranslate"><span class="pre">Struct</span></code> / list) – A <code class="xref py py-class docutils literal notranslate"><span class="pre">Struct</span></code> instance or list of such, for obstructions</p></li>
<li><p><strong>Sino_RefPt</strong> (<em>None / np.ndarray</em>) – <dl class="simple">
<dt>Iterable of len=2 with the coordinates of the sinogram reference point</dt><dd><ul>
<li><p>(R,Z) coordinates if the vessel is of Type ‘Tor’</p></li>
<li><p>(Y,Z) coordinates if the vessel is of Type ‘Lin’</p></li>
</ul>
</dd>
</dl>
</p></li>
<li><p><strong>Exp</strong> (<em>None / str</em>) – <dl class="simple">
<dt>Experiment to which the LOS belongs:</dt><dd><ul>
<li><p>if both Exp and Ves are provided: Exp==Ves.Id.Exp</p></li>
<li><p>if Ves is provided but not Exp: Ves.Id.Exp is used</p></li>
</ul>
</dd>
</dl>
</p></li>
<li><p><strong>Diag</strong> (<em>None / str</em>) – Diagnostic to which the LOS belongs</p></li>
<li><p><strong>shot</strong> (<em>None / int</em>) – Shot number from which this LOS is valid</p></li>
<li><p><strong>SavePath</strong> (<em>None / str</em>) – If provided, default saving path of the object</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="tofu.geom._core.Rays.D">
<em class="property">property </em><code class="sig-name descname">D</code><a class="headerlink" href="#tofu.geom._core.Rays.D" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tofu.geom._core.Rays.Etendues">
<em class="property">property </em><code class="sig-name descname">Etendues</code><a class="headerlink" href="#tofu.geom._core.Rays.Etendues" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tofu.geom._core.Rays.Surfaces">
<em class="property">property </em><code class="sig-name descname">Surfaces</code><a class="headerlink" href="#tofu.geom._core.Rays.Surfaces" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tofu.geom._core.Rays.add_reflections">
<code class="sig-name descname">add_reflections</code><span class="sig-paren">(</span><em class="sig-param">Type=None</em>, <em class="sig-param">nb=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_core.html#Rays.add_reflections"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._core.Rays.add_reflections" title="Permalink to this definition">¶</a></dt>
<dd><p>Add relfected LOS to the camera</p>
<dl class="simple">
<dt>Reflected LOS can be of 3 types:</dt><dd><ul class="simple">
<li><p>‘speculiar’:  standard mirror-like reflection</p></li>
<li><p>‘diffusive’:  random reflection</p></li>
<li><p>‘ccube’:      corner-cube reflection (ray goes back its way)</p></li>
</ul>
</dd>
</dl>
<p>As opposed to self.get_reflections_as_cam(), the reflected rays are
stored in the camera object</p>
</dd></dl>

<dl class="method">
<dt id="tofu.geom._core.Rays.calc_kInkOut_Isoflux">
<code class="sig-name descname">calc_kInkOut_Isoflux</code><span class="sig-paren">(</span><em class="sig-param">lPoly</em>, <em class="sig-param">lVIn=None</em>, <em class="sig-param">Lim=None</em>, <em class="sig-param">kInOut=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_core.html#Rays.calc_kInkOut_Isoflux"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._core.Rays.calc_kInkOut_Isoflux" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the intersection points of each ray with each isoflux</p>
<p>The isofluxes are provided as a list of 2D closed polygons</p>
<p>The intersections are the inward and outward intersections
They are retruned as two np.ndarrays: kIn and kOut
Each array contains the length parameter along the ray for each isoflux</p>
</dd></dl>

<dl class="method">
<dt id="tofu.geom._core.Rays.calc_length_in_isoflux">
<code class="sig-name descname">calc_length_in_isoflux</code><span class="sig-paren">(</span><em class="sig-param">lPoly</em>, <em class="sig-param">lVIn=None</em>, <em class="sig-param">Lim=None</em>, <em class="sig-param">kInOut=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_core.html#Rays.calc_length_in_isoflux"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._core.Rays.calc_length_in_isoflux" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the length of each LOS inside each isoflux</p>
<p>Uses self.calc_kInkOut_Isoflux() to compute the linear abscissa (k) of
the entry points (kIn) and exit points (kOut) for each LOS</p>
<p>The isofluxes must be provided as a list of polygons</p>
<p>The length is returned as a (nPoly, nLOS) 2d array</p>
</dd></dl>

<dl class="method">
<dt id="tofu.geom._core.Rays.calc_min_geom_radius">
<code class="sig-name descname">calc_min_geom_radius</code><span class="sig-paren">(</span><em class="sig-param">axis</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_core.html#Rays.calc_min_geom_radius"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._core.Rays.calc_min_geom_radius" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the minimum geom. radius of each LOS, from an arbitrary axis</p>
<p>The axis mut be provided as a (R,Z) iterable
Uses self.set_dsino()</p>
<dl class="simple">
<dt>p:      np.ndarray</dt><dd><p>(nLOS,) array of minimal radius (or impact parameter)</p>
</dd>
<dt>theta:  np.ndarray</dt><dd><p>(nLOS,) array of associated theta with respect to axis</p>
</dd>
<dt>pts:    np.ndarray</dt><dd><p>(3,nLOS) array of (X,Y,Z) coordinates of associated points on LOS</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="tofu.geom._core.Rays.calc_min_rho_from_Plasma2D">
<code class="sig-name descname">calc_min_rho_from_Plasma2D</code><span class="sig-paren">(</span><em class="sig-param">plasma</em>, <em class="sig-param">t=None</em>, <em class="sig-param">log='min'</em>, <em class="sig-param">res=None</em>, <em class="sig-param">resMode='abs'</em>, <em class="sig-param">method='sum'</em>, <em class="sig-param">quant=None</em>, <em class="sig-param">ref1d=None</em>, <em class="sig-param">ref2d=None</em>, <em class="sig-param">interp_t=None</em>, <em class="sig-param">interp_space=None</em>, <em class="sig-param">fill_value=nan</em>, <em class="sig-param">pts=False</em>, <em class="sig-param">Test=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_core.html#Rays.calc_min_rho_from_Plasma2D"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._core.Rays.calc_min_rho_from_Plasma2D" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the min/max value of scalar field quant for each LOS</p>
<p>Typically used to get the minimal normalized minor radius
But can be used for any quantity available in plasma if:</p>
<blockquote>
<div><ul class="simple">
<li><p>it is a 2d profile</p></li>
<li><p>it is a 1d profile that can be interpolated on a 2d mesh</p></li>
</ul>
</div></blockquote>
<p>Currently sample each LOS with desired resolution and returns the
absolute min/max interpolated value (and associated point)</p>
<dl class="simple">
<dt>See self.get_sample() for details on sampling arguments:</dt><dd><ul class="simple">
<li><p>res, resMode, method</p></li>
</ul>
</dd>
<dt>See Plasma2D.interp_pts2profile() for details on interpolation args:</dt><dd><ul class="simple">
<li><p>t, quant, q2dref, q1dref, interp_t, interp_space, fill_value</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>val:        np.ndarray</dt><dd><p>(nt, nLOS) array of min/max values</p>
</dd>
<dt>pts:        np.ndarray</dt><dd><p>(nt, nLOS, 3) array of (X,Y,Z) coordinates of associated points
Only returned if pts = True</p>
</dd>
<dt>t:          np.ndarray</dt><dd><p>(nt,) array of time steps at which the interpolations were made</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="tofu.geom._core.Rays.calc_signal">
<code class="sig-name descname">calc_signal</code><span class="sig-paren">(</span><em class="sig-param">func</em>, <em class="sig-param">t=None</em>, <em class="sig-param">ani=None</em>, <em class="sig-param">fkwdargs={}</em>, <em class="sig-param">Brightness=True</em>, <em class="sig-param">res=None</em>, <em class="sig-param">DL=None</em>, <em class="sig-param">resMode='abs'</em>, <em class="sig-param">method='sum'</em>, <em class="sig-param">minimize='calls'</em>, <em class="sig-param">num_threads=16</em>, <em class="sig-param">reflections=True</em>, <em class="sig-param">coefs=None</em>, <em class="sig-param">ind=None</em>, <em class="sig-param">returnas=&lt;class 'object'&gt;</em>, <em class="sig-param">plot=True</em>, <em class="sig-param">dataname=None</em>, <em class="sig-param">fs=None</em>, <em class="sig-param">dmargin=None</em>, <em class="sig-param">wintit=None</em>, <em class="sig-param">invert=True</em>, <em class="sig-param">units=None</em>, <em class="sig-param">draw=True</em>, <em class="sig-param">connect=True</em>, <em class="sig-param">newcalc=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_core.html#Rays.calc_signal"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._core.Rays.calc_signal" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the line-integrated emissivity</p>
<p>Beware, by default, Brightness=True and it is only a line-integral !</p>
<p>Indeed, to get the received power, you need an estimate of the Etendue
(previously set using self.set_Etendues()) and use Brightness=False.</p>
<p>Hence, if Brightness=True and if
the emissivity is provided in W/m3 (resp. W/m3/sr),
=&gt; the method returns W/m2 (resp. W/m2/sr)
The line is sampled using <code class="xref py py-meth docutils literal notranslate"><span class="pre">get_sample()</span></code>,</p>
<p>Except func, arguments common to <code class="xref py py-meth docutils literal notranslate"><span class="pre">get_sample()</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>func</strong> (<em>callable</em>) – <p>The user-provided emissivity function
Shall take at least:</p>
<blockquote>
<div><p>func(pts, t=None, vect=None)</p>
</div></blockquote>
<dl class="simple">
<dt>where:</dt><dd><ul>
<li><p>pts : (3,N) np.ndarray, (X,Y,Z) coordinates of points</p></li>
<li><p>t   : None / (nt,) np.ndarray, time vector</p></li>
<li><p>vect: None / (3,N) np.ndarray, unit direction vectors (X,Y,Z)</p></li>
</ul>
</dd>
<dt>Should return at least:</dt><dd><ul>
<li><p>val : (N,) np.ndarray, local emissivity values</p></li>
</ul>
</dd>
</dl>
</p></li>
<li><p><strong>method</strong> (<em>string</em><em>, </em><em>the integral can be computed using 3 different methods</em>) – <ul>
<li><p>‘sum’:    A numpy.sum() on the local values (x segments) DEFAULT</p></li>
<li><p>’simps’:  using <code class="xref py py-meth docutils literal notranslate"><span class="pre">scipy.integrate.simps()</span></code></p></li>
<li><p>’romb’:   using <code class="xref py py-meth docutils literal notranslate"><span class="pre">scipy.integrate.romb()</span></code></p></li>
</ul>
</p></li>
<li><p><strong>minimize</strong> (<em>string</em><em>, </em><em>method to minimize for computation optimization</em>) – <ul>
<li><p>“calls”: minimal number of calls to <cite>func</cite> (default)</p></li>
<li><p>”memory”: slowest method, to use only if “out of memory” error</p></li>
<li><p>”hybrid”: mix of before-mentioned methods.</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>sig</strong> (<em>np.ndarray</em>) – The computed signal, a 1d or 2d array depending on whether a time
vector was provided.</p></li>
<li><p><strong>units</strong> (<em>str</em>) – Units of the result</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="tofu.geom._core.Rays.calc_signal_from_Plasma2D">
<code class="sig-name descname">calc_signal_from_Plasma2D</code><span class="sig-paren">(</span><em class="sig-param">plasma2d</em>, <em class="sig-param">t=None</em>, <em class="sig-param">newcalc=True</em>, <em class="sig-param">quant=None</em>, <em class="sig-param">ref1d=None</em>, <em class="sig-param">ref2d=None</em>, <em class="sig-param">q2dR=None</em>, <em class="sig-param">q2dPhi=None</em>, <em class="sig-param">q2dZ=None</em>, <em class="sig-param">Type=None</em>, <em class="sig-param">Brightness=True</em>, <em class="sig-param">interp_t='nearest'</em>, <em class="sig-param">interp_space=None</em>, <em class="sig-param">fill_value=None</em>, <em class="sig-param">res=None</em>, <em class="sig-param">DL=None</em>, <em class="sig-param">resMode='abs'</em>, <em class="sig-param">method='sum'</em>, <em class="sig-param">minimize='calls'</em>, <em class="sig-param">num_threads=16</em>, <em class="sig-param">reflections=True</em>, <em class="sig-param">coefs=None</em>, <em class="sig-param">ind=None</em>, <em class="sig-param">returnas=&lt;class 'object'&gt;</em>, <em class="sig-param">plot=True</em>, <em class="sig-param">dataname=None</em>, <em class="sig-param">fs=None</em>, <em class="sig-param">dmargin=None</em>, <em class="sig-param">wintit=None</em>, <em class="sig-param">invert=True</em>, <em class="sig-param">units=None</em>, <em class="sig-param">draw=True</em>, <em class="sig-param">connect=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_core.html#Rays.calc_signal_from_Plasma2D"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._core.Rays.calc_signal_from_Plasma2D" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tofu.geom._core.Rays.check_ff">
<code class="sig-name descname">check_ff</code><span class="sig-paren">(</span><em class="sig-param">ff</em>, <em class="sig-param">t=None</em>, <em class="sig-param">ani=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_core.html#Rays.check_ff"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._core.Rays.check_ff" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tofu.geom._core.Rays.compute_dgeom">
<code class="sig-name descname">compute_dgeom</code><span class="sig-paren">(</span><em class="sig-param">extra=True</em>, <em class="sig-param">show_debug_plot=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_core.html#Rays.compute_dgeom"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._core.Rays.compute_dgeom" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute dictionnary of geometrical attributes (dgeom)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>show_debug_plot</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – In case some lines of sight have no visibility inside the tokamak,
they will be considered invalid. tofu will issue a warning with
their indices and if show_debug_plot is True, try to plot a 3d
figure to help understand why these los have no visibility</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="tofu.geom._core.Rays.config">
<em class="property">property </em><code class="sig-name descname">config</code><a class="headerlink" href="#tofu.geom._core.Rays.config" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tofu.geom._core.Rays.dchans">
<em class="property">property </em><code class="sig-name descname">dchans</code><a class="headerlink" href="#tofu.geom._core.Rays.dchans" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tofu.geom._core.Rays.dgeom">
<em class="property">property </em><code class="sig-name descname">dgeom</code><a class="headerlink" href="#tofu.geom._core.Rays.dgeom" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tofu.geom._core.Rays.dsino">
<em class="property">property </em><code class="sig-name descname">dsino</code><a class="headerlink" href="#tofu.geom._core.Rays.dsino" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tofu.geom._core.Rays.get_inspector">
<code class="sig-name descname">get_inspector</code><span class="sig-paren">(</span><em class="sig-param">ff</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_core.html#Rays.get_inspector"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._core.Rays.get_inspector" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tofu.geom._core.Rays.get_reflections_as_cam">
<code class="sig-name descname">get_reflections_as_cam</code><span class="sig-paren">(</span><em class="sig-param">Type=None</em>, <em class="sig-param">Name=None</em>, <em class="sig-param">nb=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_core.html#Rays.get_reflections_as_cam"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._core.Rays.get_reflections_as_cam" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a camera made of reflected LOS</p>
<dl class="simple">
<dt>Reflected LOS can be of 3 types:</dt><dd><ul class="simple">
<li><p>‘speculiar’:  standard mirror-like reflection</p></li>
<li><p>‘diffusive’:  random reflection</p></li>
<li><p>‘ccube’:      corner-cube reflection (ray goes back its way)</p></li>
</ul>
</dd>
</dl>
<p>As opposed to self.add_reflections(), the reflected rays are
return as an independent camera (CamLOS1D)</p>
</dd></dl>

<dl class="method">
<dt id="tofu.geom._core.Rays.get_sample">
<code class="sig-name descname">get_sample</code><span class="sig-paren">(</span><em class="sig-param">res=None</em>, <em class="sig-param">resMode='abs'</em>, <em class="sig-param">DL=None</em>, <em class="sig-param">method='sum'</em>, <em class="sig-param">ind=None</em>, <em class="sig-param">pts=False</em>, <em class="sig-param">compact=True</em>, <em class="sig-param">num_threads=10</em>, <em class="sig-param">Test=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_core.html#Rays.get_sample"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._core.Rays.get_sample" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a linear sampling of the LOS</p>
<p>The LOS is sampled into a series a points and segments lengths
The resolution (segments length) is &lt;= res
The sampling can be done according to different methods
It is possible to sample only a subset of the LOS</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>res</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – Desired resolution</p></li>
<li><p><strong>resMode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – <dl class="simple">
<dt>Flag indicating res should be understood as:</dt><dd><ul>
<li><p>’abs’:    an absolute distance in meters</p></li>
<li><p>’rel’:    a relative distance (fraction of the LOS length)</p></li>
</ul>
</dd>
</dl>
</p></li>
<li><p><strong>DL</strong> (<em>None / iterable</em>) – The fraction [L1;L2] of the LOS that should be sampled, where
L1 and L2 are distances from the starting point of the LOS (LOS.D)
DL can be an iterable of len()==2 (identical to all los), or a
(2,nlos) array</p></li>
<li><p><strong>method</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – <dl>
<dt>Flag indicating which to use for sampling:</dt><dd><ul>
<li><dl>
<dt>’sum’:    the LOS is sampled into N segments of equal length,</dt><dd><dl class="simple">
<dt>where N is the smallest int such that:</dt><dd><ul class="simple">
<li><p>segment length &lt;= resolution(res,resMode)</p></li>
</ul>
</dd>
</dl>
<p>The points returned are the center of each segment</p>
</dd>
</dl>
</li>
<li><dl>
<dt>’simps’:  the LOS is sampled into N segments of equal length,</dt><dd><dl class="simple">
<dt>where N is the smallest int such that:</dt><dd><ul class="simple">
<li><p>segment length &lt;= resolution(res,resMode)</p></li>
<li><p>N is even</p></li>
</ul>
</dd>
</dl>
<p>The points returned are the egdes of each segment</p>
</dd>
</dl>
</li>
<li><dl>
<dt>’romb’:   the LOS is sampled into N segments of equal length,</dt><dd><dl class="simple">
<dt>where N is the smallest int such that:</dt><dd><ul class="simple">
<li><p>segment length &lt;= resolution(res,resMode)</p></li>
<li><p>N = 2^k + 1</p></li>
</ul>
</dd>
</dl>
<p>The points returned are the egdes of each segment</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</p></li>
<li><p><strong>ind</strong> (<em>None / iterable of int</em>) – indices of the LOS to be sampled</p></li>
<li><p><strong>pts</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – Flag indicating whether to return only the abscissa parameter k
(False) or the 3D pts coordinates (True)</p></li>
<li><p><strong>compact</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – Flag incating whether to retrun the sampled pts of all los in a
single concatenated array (True) or splitted into
a list of nlos arrays)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul>
<li><p><strong>k</strong> (<em>np.ndarray</em>) –</p>
<dl>
<dt>if pts == False:</dt><dd><dl class="simple">
<dt>A (npts,) array of the abscissa parameters</dt><dd><p>(i.e.: points distances from the LOS starting points)</p>
</dd>
</dl>
<p>In order to get the 3D cartesian coordinates of pts do:</p>
</dd>
<dt>if pts == True:</dt><dd><p>A (3,npts) array of the sampled points 3D cartesian coordinates</p>
</dd>
</dl>
</li>
<li><p><strong>reseff</strong> (<em>np.ndarray</em>) – A (nlos,) array of the effective resolution (&lt;= res input), as an
absolute distance</p></li>
<li><p><strong>ind</strong> (<em>np.ndarray</em>) – A (nlos-1,) array of integere indices (where to split k to separate
the points of each los). e.g.: lk = np.split(k,ind)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="tofu.geom._core.Rays.get_subset">
<code class="sig-name descname">get_subset</code><span class="sig-paren">(</span><em class="sig-param">indch=None</em>, <em class="sig-param">Name=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_core.html#Rays.get_subset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._core.Rays.get_subset" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an instance which is a sub-set of the camera</p>
<p>The subset is the same camera but with only the LOS selected by indch
It can be assigned a new Name (str), or the same one (True)</p>
</dd></dl>

<dl class="method">
<dt id="tofu.geom._core.Rays.get_touch_colors">
<code class="sig-name descname">get_touch_colors</code><span class="sig-paren">(</span><em class="sig-param">ind=None</em>, <em class="sig-param">dElt=None</em>, <em class="sig-param">cbck=(0.8</em>, <em class="sig-param">0.8</em>, <em class="sig-param">0.8)</em>, <em class="sig-param">rgba=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_core.html#Rays.get_touch_colors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._core.Rays.get_touch_colors" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tofu.geom._core.Rays.get_touch_dict">
<code class="sig-name descname">get_touch_dict</code><span class="sig-paren">(</span><em class="sig-param">ind=None</em>, <em class="sig-param">out=&lt;class 'bool'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_core.html#Rays.get_touch_dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._core.Rays.get_touch_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a dictionnary of Cls_Name struct with indices of Rays touching</p>
<dl class="simple">
<dt>Only includes Struct object with compute = True</dt><dd><p>(as returned by self.lStruct__computeInOut_computeInOut)</p>
</dd>
</dl>
<p>Also return the associated colors
If in is not None, the indices for each Struct are split between:</p>
<blockquote>
<div><ul class="simple">
<li><p>indok : rays touching Struct and in ind</p></li>
<li><p>indout: rays touching Struct but not in ind</p></li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="tofu.geom._core.Rays.indStruct_computeInOut">
<em class="property">property </em><code class="sig-name descname">indStruct_computeInOut</code><a class="headerlink" href="#tofu.geom._core.Rays.indStruct_computeInOut" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tofu.geom._core.Rays.isPinhole">
<em class="property">property </em><code class="sig-name descname">isPinhole</code><a class="headerlink" href="#tofu.geom._core.Rays.isPinhole" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tofu.geom._core.Rays.kIn">
<em class="property">property </em><code class="sig-name descname">kIn</code><a class="headerlink" href="#tofu.geom._core.Rays.kIn" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tofu.geom._core.Rays.kMin">
<em class="property">property </em><code class="sig-name descname">kMin</code><a class="headerlink" href="#tofu.geom._core.Rays.kMin" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tofu.geom._core.Rays.kOut">
<em class="property">property </em><code class="sig-name descname">kOut</code><a class="headerlink" href="#tofu.geom._core.Rays.kOut" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tofu.geom._core.Rays.nRays">
<em class="property">property </em><code class="sig-name descname">nRays</code><a class="headerlink" href="#tofu.geom._core.Rays.nRays" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tofu.geom._core.Rays.pinhole">
<em class="property">property </em><code class="sig-name descname">pinhole</code><a class="headerlink" href="#tofu.geom._core.Rays.pinhole" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tofu.geom._core.Rays.plot">
<code class="sig-name descname">plot</code><span class="sig-paren">(</span><em class="sig-param">lax=None</em>, <em class="sig-param">proj='all'</em>, <em class="sig-param">reflections=True</em>, <em class="sig-param">Lplot='Tot'</em>, <em class="sig-param">element='L'</em>, <em class="sig-param">element_config='P'</em>, <em class="sig-param">Leg=''</em>, <em class="sig-param">dL=None</em>, <em class="sig-param">dPtD={'c': 'k'</em>, <em class="sig-param">'ls': 'None'</em>, <em class="sig-param">'lw': 2</em>, <em class="sig-param">'marker': 'x'</em>, <em class="sig-param">'markersize': 8</em>, <em class="sig-param">'mew': 2}</em>, <em class="sig-param">dPtI={'c': 'k'</em>, <em class="sig-param">'ls': 'None'</em>, <em class="sig-param">'lw': 2</em>, <em class="sig-param">'marker': 'x'</em>, <em class="sig-param">'markersize': 8</em>, <em class="sig-param">'mew': 2}</em>, <em class="sig-param">dPtO={'c': 'k'</em>, <em class="sig-param">'ls': 'None'</em>, <em class="sig-param">'lw': 2</em>, <em class="sig-param">'marker': 'x'</em>, <em class="sig-param">'markersize': 8</em>, <em class="sig-param">'mew': 2}</em>, <em class="sig-param">dPtR={'c': 'k'</em>, <em class="sig-param">'ls': 'None'</em>, <em class="sig-param">'lw': 2</em>, <em class="sig-param">'marker': 'x'</em>, <em class="sig-param">'markersize': 8</em>, <em class="sig-param">'mew': 2}</em>, <em class="sig-param">dPtP={'c': 'k'</em>, <em class="sig-param">'ls': 'None'</em>, <em class="sig-param">'lw': 2</em>, <em class="sig-param">'marker': 'x'</em>, <em class="sig-param">'markersize': 8</em>, <em class="sig-param">'mew': 2}</em>, <em class="sig-param">dLeg={'bbox_to_anchor': (1.01</em>, <em class="sig-param">1)</em>, <em class="sig-param">'borderaxespad': 0.0</em>, <em class="sig-param">'frameon': False</em>, <em class="sig-param">'loc': 2</em>, <em class="sig-param">'ncol': 1</em>, <em class="sig-param">'prop': {'size': 10}}</em>, <em class="sig-param">multi=False</em>, <em class="sig-param">ind=None</em>, <em class="sig-param">fs=None</em>, <em class="sig-param">tit=None</em>, <em class="sig-param">wintit=None</em>, <em class="sig-param">draw=True</em>, <em class="sig-param">Test=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_core.html#Rays.plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._core.Rays.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the Rays / LOS, in the chosen projection(s)</p>
<p>Optionnally also plot associated <code class="xref py py-class docutils literal notranslate"><span class="pre">Ves</span></code> and Struct
The plot can also include:</p>
<blockquote>
<div><ul class="simple">
<li><p>special points</p></li>
<li><p>the unit directing vector</p></li>
</ul>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lax</strong> (<em>list / plt.Axes</em>) – The axes for plotting (list of 2 axes if Proj=’All’)
If None a new figure with new axes is created</p></li>
<li><p><strong>proj</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – <dl class="simple">
<dt>Flag specifying the kind of projection:</dt><dd><ul>
<li><p>’Cross’ : cross-section</p></li>
<li><p>’Hor’ : horizontal</p></li>
<li><p>’All’ : both cross-section and horizontal (on 2 axes)</p></li>
<li><p>’3d’ : a (matplotlib) 3d plot</p></li>
</ul>
</dd>
</dl>
</p></li>
<li><p><strong>projections</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – Flag indicating whether to plot also the reflected rays
Assuming some reflected rays are present (self.add_reflections())</p></li>
<li><p><strong>element</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – <p>Flag specifying which elements to plot
Each capital letter corresponds to an element:</p>
<blockquote>
<div><ul>
<li><p>’L’: LOS</p></li>
<li><p>’D’: Starting point of the LOS</p></li>
<li><p>’I’: Input point (i.e.: where the LOS enters the Vessel)</p></li>
<li><p>’O’: Output point (i.e.: where the LOS exits the Vessel)</p></li>
<li><p>’R’: Point of minimal major radius R (only if Ves.Type=’Tor’)</p></li>
<li><dl class="simple">
<dt>’P’: Point of used for impact parameter (i.e.: with minimal</dt><dd><p>distance to reference point Sino_RefPt)</p>
</dd>
</dl>
</li>
</ul>
</div></blockquote>
</p></li>
<li><p><strong>Lplot</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – <dl class="simple">
<dt>Flag specifying the length to plot:</dt><dd><ul>
<li><p>’Tot’: total length, from starting point (D) to output point</p></li>
<li><p>’In’ : only the in-vessel fraction (from input to output)</p></li>
</ul>
</dd>
</dl>
</p></li>
<li><p><strong>element_config</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – Fed to self.config.plot()</p></li>
<li><p><strong>Leg</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – Legend, if Leg=’’ the LOS name is used</p></li>
<li><p><strong>dL</strong> (<em>dict / None</em>) – Dictionary of properties for plotting the lines
Fed to plt.Axes.plot(), set to default if None</p></li>
<li><p><strong>dPtD</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – Dictionary of properties for plotting point ‘D’</p></li>
<li><p><strong>dPtI</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – Dictionary of properties for plotting point ‘I’</p></li>
<li><p><strong>dPtO</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – Dictionary of properties for plotting point ‘O’</p></li>
<li><p><strong>dPtR</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – Dictionary of properties for plotting point ‘R’</p></li>
<li><p><strong>dPtP</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – Dictionary of properties for plotting point ‘P’</p></li>
<li><p><strong>dLeg</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.8)"><em>None</em></a>) – Dictionary of properties for plotting the legend
Fed to plt.legend(), the legend is not plotted if None</p></li>
<li><p><strong>draw</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – Flag indicating whether fig.canvas.draw() shall be called</p></li>
<li><p><strong>a4</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – Flag indicating whether to plot the figure in a4 dimensions</p></li>
<li><p><strong>Test</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – </p></li>
<li><p><strong>a4</strong> – Flag indicating whether to plot the figure in a4 dimensions</p></li>
<li><p><strong>Test</strong> – </p></li>
<li><p><strong>a4</strong> – Flag indicating whether to plot the figure in a4 dimensions</p></li>
<li><p><strong>Test</strong> – </p></li>
<li><p><strong>a4</strong> – Flag indicating whether to plot the figure in a4 dimensions</p></li>
<li><p><strong>Test</strong> – </p></li>
<li><p><strong>Test</strong> – Flag indicating whether the inputs should be tested for conformity</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>La</strong> (<em>list / plt.Axes</em>) – Handles of the axes used for plotting (list if Proj=’All’)</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="tofu.geom._core.Rays.plot_sino">
<code class="sig-name descname">plot_sino</code><span class="sig-paren">(</span><em class="sig-param">ax=None</em>, <em class="sig-param">element='LV'</em>, <em class="sig-param">Sketch=True</em>, <em class="sig-param">Ang='theta'</em>, <em class="sig-param">AngUnit='rad'</em>, <em class="sig-param">Leg=None</em>, <em class="sig-param">dL={'c': 'k'</em>, <em class="sig-param">'ls': 'None'</em>, <em class="sig-param">'lw': 2</em>, <em class="sig-param">'marker': 'x'</em>, <em class="sig-param">'markersize': 8</em>, <em class="sig-param">'mew': 2}</em>, <em class="sig-param">dVes={'edgecolor': (0.8</em>, <em class="sig-param">0.8</em>, <em class="sig-param">0.8</em>, <em class="sig-param">1.0)</em>, <em class="sig-param">'facecolor': (0.8</em>, <em class="sig-param">0.8</em>, <em class="sig-param">0.8</em>, <em class="sig-param">1.0)</em>, <em class="sig-param">'linestyle': 'solid'</em>, <em class="sig-param">'linewidth': 1}</em>, <em class="sig-param">dLeg={'bbox_to_anchor': (1.01</em>, <em class="sig-param">1)</em>, <em class="sig-param">'borderaxespad': 0.0</em>, <em class="sig-param">'frameon': False</em>, <em class="sig-param">'loc': 2</em>, <em class="sig-param">'ncol': 1</em>, <em class="sig-param">'prop': {'size': 10}}</em>, <em class="sig-param">ind=None</em>, <em class="sig-param">multi=False</em>, <em class="sig-param">fs=None</em>, <em class="sig-param">tit=None</em>, <em class="sig-param">wintit=None</em>, <em class="sig-param">draw=True</em>, <em class="sig-param">Test=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_core.html#Rays.plot_sino"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._core.Rays.plot_sino" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the LOS in projection space (sinogram)</p>
<p>Plot the Rays in projection space (cf. sinograms) as points.
Can also optionnally plot the associated <code class="xref py py-class docutils literal notranslate"><span class="pre">Ves</span></code></p>
<p>Can plot the conventional projection-space (in 2D in a cross-section),
or a 3D extrapolation of it, where the third coordinate is provided by
the angle that the LOS makes with the cross-section plane
(useful in case of multiple LOS with a partially tangential view)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Proj</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – <dl class="simple">
<dt>Flag indicating whether to plot:</dt><dd><ul>
<li><p>’Cross’:  a classic sinogram (vessel cross-section)</p></li>
<li><p>’3d’: an extended 3D version (‘3d’), with an additional angle</p></li>
</ul>
</dd>
</dl>
</p></li>
<li><p><strong>ax</strong> (<em>None / plt.Axes</em>) – The axes on which to plot, if None a new figure is created</p></li>
<li><p><strong>Elt</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – <dl class="simple">
<dt>Flag indicating which elements to plot (one per capital letter):</dt><dd><ul>
<li><p>’L’: LOS</p></li>
<li><p>’V’: Vessel</p></li>
</ul>
</dd>
</dl>
</p></li>
<li><p><strong>Ang</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – <dl class="simple">
<dt>Flag indicating which angle to use for the impact parameter:</dt><dd><ul>
<li><p>’xi’: the angle of the line itself</p></li>
<li><p>’theta’: its impact parameter (theta)</p></li>
</ul>
</dd>
</dl>
</p></li>
<li><p><strong>AngUnit</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – <dl class="simple">
<dt>Flag for the angle units to be displayed:</dt><dd><ul>
<li><p>’rad’: for radians</p></li>
<li><p>’deg’: for degrees</p></li>
</ul>
</dd>
</dl>
</p></li>
<li><p><strong>Sketch</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – Flag indicating whether to plot a skecth with angles definitions</p></li>
<li><p><strong>dL</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – Dictionary of properties for plotting the Rays points</p></li>
<li><p><strong>dV</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – Dictionary of properties for plotting the vessel envelopp</p></li>
<li><p><strong>dLeg</strong> (<em>None / dict</em>) – Dictionary of properties for plotting the legend
The legend is not plotted if None</p></li>
<li><p><strong>draw</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – Flag indicating whether to draw the figure</p></li>
<li><p><strong>a4</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – Flag indicating whether the figure should be a4</p></li>
<li><p><strong>Test</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – Flag indicating whether the inputs shall be tested for conformity</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>ax</strong> (<em>plt.Axes</em>) – The axes used to plot</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="tofu.geom._core.Rays.plot_touch">
<code class="sig-name descname">plot_touch</code><span class="sig-paren">(</span><em class="sig-param">key=None</em>, <em class="sig-param">quant='lengths'</em>, <em class="sig-param">invert=None</em>, <em class="sig-param">ind=None</em>, <em class="sig-param">Bck=True</em>, <em class="sig-param">fs=None</em>, <em class="sig-param">wintit=None</em>, <em class="sig-param">tit=None</em>, <em class="sig-param">connect=True</em>, <em class="sig-param">draw=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_core.html#Rays.plot_touch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._core.Rays.plot_touch" title="Permalink to this definition">¶</a></dt>
<dd><p>Interactive plot of the camera and the structures it touches</p>
<p>The camera LOS are plotted in poloidal and horizontal projections
The associated Config is also plotted
The plot shows which strutural element is touched by each LOS</p>
<dl class="simple">
<dt>In addition, an extra quantity is plotted, depending on quant:</dt><dd><ul class="simple">
<li><p>‘lengths’ (default): the length of each LOS</p></li>
<li><dl class="simple">
<dt>‘angles’<span class="classifier">the angle of incidence of each LOS</span></dt><dd><dl class="simple">
<dt>(with respect to the normal of the surface touched,</dt><dd><p>useful for assessing reflection probabilities)</p>
</dd>
</dl>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>‘indices’: the index of each LOS</dt><dd><p>(useful for checking numbering)</p>
</dd>
</dl>
</li>
<li><p>‘Etendues’: the etendue associated to each LOS (user-provided)</p></li>
<li><p>‘Surfaces’: the surfaces associated to each LOS (user-provided)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="tofu.geom._core.Rays.select">
<code class="sig-name descname">select</code><span class="sig-paren">(</span><em class="sig-param">key=None</em>, <em class="sig-param">val=None</em>, <em class="sig-param">touch=None</em>, <em class="sig-param">log='any'</em>, <em class="sig-param">out=&lt;class 'int'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_core.html#Rays.select"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._core.Rays.select" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the indices of the rays matching selection criteria</p>
<dl class="simple">
<dt>The criterion can be of two types:</dt><dd><ul class="simple">
<li><p>a key found in self.dchans, with a matching value</p></li>
<li><dl class="simple">
<dt>a touch tuple (indicating which element in self.config is touched</dt><dd><p>by the desired rays)</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<em>None / str</em>) – A key to be found in self.dchans</p></li>
<li><p><strong>val</strong> (<em>int / str / float / list of such</em>) – The value to be matched
If a list of values is provided, the behaviour depends on log</p></li>
<li><p><strong>log</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – <dl class="simple">
<dt>A flag indicating which behaviour to use when val is a list</dt><dd><ul>
<li><p>any : Returns indices of rays matching any value in val</p></li>
<li><p>all : Returns indices of rays matching all values in val</p></li>
<li><p>not : Returns indices of rays matching None of the val</p></li>
</ul>
</dd>
</dl>
</p></li>
<li><p><strong>touch</strong> (<em>None / str / int / tuple</em>) – <p>Used if key is None
Tuple that can be of len()=1, 2 or 3
Tuple indicating you want the rays that are touching some specific
elements of self.config:</p>
<blockquote>
<div><ul>
<li><dl class="simple">
<dt>touch[0]<span class="classifier">str / int or list of such</span></dt><dd><p>str : a ‘Cls_Name’ string indicating the element
int : the index of the element in self.config.lStruct</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>touch[1]<span class="classifier">int / list of int</span></dt><dd><p>Indices of the desired segments on the polygon
(i.e.: of the cross-section polygon of the above element)</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>touch[2]<span class="classifier">int / list of int</span></dt><dd><p>Indices, if relevant, of the toroidal / linear unit
Only relevant when the element has noccur&gt;1</p>
</dd>
</dl>
</li>
</ul>
</div></blockquote>
<p>In this case only log=’not’ has an effect</p>
</p></li>
<li><p><strong>out</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – <dl class="simple">
<dt>Flag indicating whether to return:</dt><dd><ul>
<li><p>bool : a (nRays,) boolean array of indices</p></li>
<li><dl class="simple">
<dt>int<span class="classifier">a (N,) array of int indices (N=number of matching</span></dt><dd><p>rays)</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>ind</strong> (<em>np.ndarray</em>) – The array of matching rays</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="tofu.geom._core.Rays.set_Etendues">
<code class="sig-name descname">set_Etendues</code><span class="sig-paren">(</span><em class="sig-param">val</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_core.html#Rays.set_Etendues"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._core.Rays.set_Etendues" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tofu.geom._core.Rays.set_Surfaces">
<code class="sig-name descname">set_Surfaces</code><span class="sig-paren">(</span><em class="sig-param">val</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_core.html#Rays.set_Surfaces"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._core.Rays.set_Surfaces" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tofu.geom._core.Rays.set_dX12">
<code class="sig-name descname">set_dX12</code><span class="sig-paren">(</span><em class="sig-param">dX12=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_core.html#Rays.set_dX12"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._core.Rays.set_dX12" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tofu.geom._core.Rays.set_dchans">
<code class="sig-name descname">set_dchans</code><span class="sig-paren">(</span><em class="sig-param">dchans=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_core.html#Rays.set_dchans"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._core.Rays.set_dchans" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tofu.geom._core.Rays.set_dconfig">
<code class="sig-name descname">set_dconfig</code><span class="sig-paren">(</span><em class="sig-param">config=None</em>, <em class="sig-param">calcdgeom=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_core.html#Rays.set_dconfig"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._core.Rays.set_dconfig" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tofu.geom._core.Rays.set_dsino">
<code class="sig-name descname">set_dsino</code><span class="sig-paren">(</span><em class="sig-param">RefPt=None</em>, <em class="sig-param">extra=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_core.html#Rays.set_dsino"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._core.Rays.set_dsino" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tofu.geom._core.Rays.strip">
<code class="sig-name descname">strip</code><span class="sig-paren">(</span><em class="sig-param">strip=0</em>, <em class="sig-param">verb=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_core.html#Rays.strip"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._core.Rays.strip" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove non-essential attributes to save memory / disk usage</p>
<p>Useful to save a very compressed version of the object
The higher strip =&gt; the more stripped the object
Use strip=0 to recover all atributes</p>
<dl class="simple">
<dt>See the difference by doing:</dt><dd><p>&gt; self.get_nbytes()
&gt; self.strip(-1)
&gt; self.get_nbytes()</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>strip</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – <dl>
<dt>Flag indicating how much to strip from the object</dt><dd><blockquote>
<div><p>0: Make complete (retrieve all attributes)
1: dgeom w/o pts + config.strip(1)
2: dgeom w/o pts + config.strip(2) + dsino empty
3: dgeom w/o pts + config.strip(3) + dsino empty
4: dgeom w/o pts + config=pathfile + dsino empty</p>
</div></blockquote>
<p>-1: Equivalent to strip=4</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="tofu.geom._core.Rays.u">
<em class="property">property </em><code class="sig-name descname">u</code><a class="headerlink" href="#tofu.geom._core.Rays.u" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="tofu.geom._core.CamLOS1D">
<em class="property">class </em><code class="sig-prename descclassname">tofu.geom._core.</code><code class="sig-name descname">CamLOS1D</code><span class="sig-paren">(</span><em class="sig-param">dgeom=None</em>, <em class="sig-param">lOptics=None</em>, <em class="sig-param">Etendues=None</em>, <em class="sig-param">Surfaces=None</em>, <em class="sig-param">config=None</em>, <em class="sig-param">dchans=None</em>, <em class="sig-param">dX12='geom'</em>, <em class="sig-param">Id=None</em>, <em class="sig-param">Name=None</em>, <em class="sig-param">Exp=None</em>, <em class="sig-param">shot=None</em>, <em class="sig-param">Diag=None</em>, <em class="sig-param">sino_RefPt=None</em>, <em class="sig-param">fromdict=None</em>, <em class="sig-param">sep=None</em>, <em class="sig-param">method='optimized'</em>, <em class="sig-param">SavePath='/Users/mendoza/tofu/doc/source'</em>, <em class="sig-param">color=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_core.html#CamLOS1D"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._core.CamLOS1D" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#tofu.geom._core.Rays" title="tofu.geom._core.Rays"><code class="xref py py-class docutils literal notranslate"><span class="pre">tofu.geom._core.Rays</span></code></a></p>
<dl class="method">
<dt id="tofu.geom._core.CamLOS1D.get_summary">
<code class="sig-name descname">get_summary</code><span class="sig-paren">(</span><em class="sig-param">sep='  '</em>, <em class="sig-param">line='-'</em>, <em class="sig-param">just='l'</em>, <em class="sig-param">table_sep=None</em>, <em class="sig-param">verb=True</em>, <em class="sig-param">return_=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_core.html#CamLOS1D.get_summary"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._core.CamLOS1D.get_summary" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tofu.geom._core.CamLOS1D.save_to_imas">
<code class="sig-name descname">save_to_imas</code><span class="sig-paren">(</span><em class="sig-param">ids=None</em>, <em class="sig-param">shot=None</em>, <em class="sig-param">run=None</em>, <em class="sig-param">refshot=None</em>, <em class="sig-param">refrun=None</em>, <em class="sig-param">user=None</em>, <em class="sig-param">tokamak=None</em>, <em class="sig-param">version=None</em>, <em class="sig-param">occ=None</em>, <em class="sig-param">dryrun=False</em>, <em class="sig-param">deep=True</em>, <em class="sig-param">restore_size=True</em>, <em class="sig-param">verb=True</em>, <em class="sig-param">config_description_2d=None</em>, <em class="sig-param">config_occ=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_core.html#CamLOS1D.save_to_imas"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._core.CamLOS1D.save_to_imas" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="tofu.geom._core.CamLOS2D">
<em class="property">class </em><code class="sig-prename descclassname">tofu.geom._core.</code><code class="sig-name descname">CamLOS2D</code><span class="sig-paren">(</span><em class="sig-param">dgeom=None</em>, <em class="sig-param">lOptics=None</em>, <em class="sig-param">Etendues=None</em>, <em class="sig-param">Surfaces=None</em>, <em class="sig-param">config=None</em>, <em class="sig-param">dchans=None</em>, <em class="sig-param">dX12='geom'</em>, <em class="sig-param">Id=None</em>, <em class="sig-param">Name=None</em>, <em class="sig-param">Exp=None</em>, <em class="sig-param">shot=None</em>, <em class="sig-param">Diag=None</em>, <em class="sig-param">sino_RefPt=None</em>, <em class="sig-param">fromdict=None</em>, <em class="sig-param">sep=None</em>, <em class="sig-param">method='optimized'</em>, <em class="sig-param">SavePath='/Users/mendoza/tofu/doc/source'</em>, <em class="sig-param">color=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_core.html#CamLOS2D"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._core.CamLOS2D" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#tofu.geom._core.Rays" title="tofu.geom._core.Rays"><code class="xref py py-class docutils literal notranslate"><span class="pre">tofu.geom._core.Rays</span></code></a></p>
<dl class="method">
<dt id="tofu.geom._core.CamLOS2D.dX12">
<em class="property">property </em><code class="sig-name descname">dX12</code><a class="headerlink" href="#tofu.geom._core.CamLOS2D.dX12" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tofu.geom._core.CamLOS2D.get_X12plot">
<code class="sig-name descname">get_X12plot</code><span class="sig-paren">(</span><em class="sig-param">plot='imshow'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_core.html#CamLOS2D.get_X12plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._core.CamLOS2D.get_X12plot" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tofu.geom._core.CamLOS2D.get_summary">
<code class="sig-name descname">get_summary</code><span class="sig-paren">(</span><em class="sig-param">sep='  '</em>, <em class="sig-param">line='-'</em>, <em class="sig-param">just='l'</em>, <em class="sig-param">table_sep=None</em>, <em class="sig-param">verb=True</em>, <em class="sig-param">return_=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_core.html#CamLOS2D.get_summary"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._core.CamLOS2D.get_summary" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-tofu.geom._core_optics">
<span id="tofu-geom-core-optics-module"></span><h2>tofu.geom._core_optics module<a class="headerlink" href="#module-tofu.geom._core_optics" title="Permalink to this headline">¶</a></h2>
<p>This module is the geometrical part of the ToFu general package
It includes all functions and object classes necessary for tomography on Tokamaks</p>
<dl class="class">
<dt id="tofu.geom._core_optics.CrystalBragg">
<em class="property">class </em><code class="sig-prename descclassname">tofu.geom._core_optics.</code><code class="sig-name descname">CrystalBragg</code><span class="sig-paren">(</span><em class="sig-param">dgeom=None, dmat=None, dbragg=None, Id=None, Name=None, Exp=None, Diag=None, shot=None, fromdict=None, sep=None, SavePath='/Users/mendoza/tofu/doc/source', SavePath_Include=['Mod', 'Cls', 'Type', 'Exp', 'Deg', 'Diag', 'Name', 'shot'], color=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_core_optics.html#CrystalBragg"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._core_optics.CrystalBragg" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="tofu.html#tofu.utils.ToFuObject" title="tofu.utils.ToFuObject"><code class="xref py py-class docutils literal notranslate"><span class="pre">tofu.utils.ToFuObject</span></code></a></p>
<p>A class defining crystals for Bragg diffraction</p>
<p>A crystal can be of Type flat, cylindrical or spherical
It is characterized by its:</p>
<blockquote>
<div><ul class="simple">
<li><p>geometry (Type, dimensions, curvature radii and position/orientation)</p></li>
<li><p>Material and lattice</p></li>
<li><p>Bragg parameters (angle vs lambda)</p></li>
</ul>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Id</strong> (<em>str / tfpf.ID</em>) – A name string or a pre-built tfpf.ID class to be used to identify this
particular instance, if a string is provided, it is fed to tfpf.ID()</p></li>
<li><p><strong>dgeom</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – <dl class="simple">
<dt>An array (2,N) or (N,2) defining the contour of the vacuum vessel in a</dt><dd><p>cross-section, if not closed, will be closed automatically</p>
</dd>
<dt>dspectral:     str</dt><dd><p>Flag indicating whether the vessel will be a torus (‘Tor’) or a linear
device (‘Lin’)</p>
</dd>
</dl>
</p></li>
<li><p><strong>SavePath</strong> (<em>None / str</em>) – If provided, forces the default saving path of the object to the
provided value</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="tofu.geom._core_optics.CrystalBragg.Type">
<em class="property">property </em><code class="sig-name descname">Type</code><a class="headerlink" href="#tofu.geom._core_optics.CrystalBragg.Type" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the type of structure</p>
</dd></dl>

<dl class="method">
<dt id="tofu.geom._core_optics.CrystalBragg.calc_johannerror">
<code class="sig-name descname">calc_johannerror</code><span class="sig-paren">(</span><em class="sig-param">xi=None</em>, <em class="sig-param">xj=None</em>, <em class="sig-param">err=None</em>, <em class="sig-param">det_cent=None</em>, <em class="sig-param">det_ei=None</em>, <em class="sig-param">det_ej=None</em>, <em class="sig-param">n=None</em>, <em class="sig-param">lpsi=None</em>, <em class="sig-param">ltheta=None</em>, <em class="sig-param">plot=True</em>, <em class="sig-param">fs=None</em>, <em class="sig-param">cmap=None</em>, <em class="sig-param">vmin=None</em>, <em class="sig-param">vmax=None</em>, <em class="sig-param">tit=None</em>, <em class="sig-param">wintit=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_core_optics.html#CrystalBragg.calc_johannerror"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._core_optics.CrystalBragg.calc_johannerror" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the johann error</p>
<dl>
<dt>The johann error is the error (scattering) induced by defocalization</dt><dd><p>due to finite crystal dimensions</p>
</dd>
<dt>There is a johann error on wavelength (lamb =&gt; loss of spectral</dt><dd><p>resolution) and on directionality (phi)</p>
</dd>
<dt>If provided, lpsi and ltheta are taken as normalized variations with</dt><dd><p>respect to the crystal summit and to its extenthalf.
Typical values are:</p>
<blockquote>
<div><ul class="simple">
<li><p>lpsi   = [-1, 1, 1, -1]</p></li>
<li><p>ltheta = [-1, -1, 1, 1]</p></li>
</ul>
</div></blockquote>
<p>They must have the same len()</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="tofu.geom._core_optics.CrystalBragg.calc_phibragg_from_pts">
<code class="sig-name descname">calc_phibragg_from_pts</code><span class="sig-paren">(</span><em class="sig-param">pts</em>, <em class="sig-param">dtheta=None</em>, <em class="sig-param">dpsi=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_core_optics.html#CrystalBragg.calc_phibragg_from_pts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._core_optics.CrystalBragg.calc_phibragg_from_pts" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tofu.geom._core_optics.CrystalBragg.calc_phibragg_from_pts_on_summit">
<code class="sig-name descname">calc_phibragg_from_pts_on_summit</code><span class="sig-paren">(</span><em class="sig-param">pts</em>, <em class="sig-param">n=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_core_optics.html#CrystalBragg.calc_phibragg_from_pts_on_summit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._core_optics.CrystalBragg.calc_phibragg_from_pts_on_summit" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the bragg angle and phi of pts from crystal summit</p>
<p>The pts are provided as a (x, y, z) coordinates array
The bragg angle and phi are computed from the crystal’s summit</p>
</dd></dl>

<dl class="method">
<dt id="tofu.geom._core_optics.CrystalBragg.calc_phibragg_from_xixj">
<code class="sig-name descname">calc_phibragg_from_xixj</code><span class="sig-paren">(</span><em class="sig-param">xi</em>, <em class="sig-param">xj</em>, <em class="sig-param">n=None</em>, <em class="sig-param">det_cent=None</em>, <em class="sig-param">det_ei=None</em>, <em class="sig-param">det_ej=None</em>, <em class="sig-param">dtheta=None</em>, <em class="sig-param">psi=None</em>, <em class="sig-param">plot=True</em>, <em class="sig-param">ax=None</em>, <em class="sig-param">**kwdargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_core_optics.html#CrystalBragg.calc_phibragg_from_xixj"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._core_optics.CrystalBragg.calc_phibragg_from_xixj" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tofu.geom._core_optics.CrystalBragg.calc_thetapsi_from_lambpts">
<code class="sig-name descname">calc_thetapsi_from_lambpts</code><span class="sig-paren">(</span><em class="sig-param">pts=None</em>, <em class="sig-param">lamb=None</em>, <em class="sig-param">n=None</em>, <em class="sig-param">ntheta=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_core_optics.html#CrystalBragg.calc_thetapsi_from_lambpts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._core_optics.CrystalBragg.calc_thetapsi_from_lambpts" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tofu.geom._core_optics.CrystalBragg.calc_xixj_from_phibragg">
<code class="sig-name descname">calc_xixj_from_phibragg</code><span class="sig-paren">(</span><em class="sig-param">phi=None</em>, <em class="sig-param">bragg=None</em>, <em class="sig-param">lamb=None</em>, <em class="sig-param">n=None</em>, <em class="sig-param">theta=None</em>, <em class="sig-param">psi=None</em>, <em class="sig-param">det_cent=None</em>, <em class="sig-param">det_nout=None</em>, <em class="sig-param">det_ei=None</em>, <em class="sig-param">det_ej=None</em>, <em class="sig-param">data=None</em>, <em class="sig-param">plot=True</em>, <em class="sig-param">ax=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_core_optics.html#CrystalBragg.calc_xixj_from_phibragg"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._core_optics.CrystalBragg.calc_xixj_from_phibragg" title="Permalink to this definition">¶</a></dt>
<dd><p>Assuming crystal’s summit as frame origin</p>
<p>According to [1], this assumes a local frame centered on the crystal</p>
<dl class="simple">
<dt>These calculations are independent from the tokamak’s frame:</dt><dd><p>The origin of the local frame is the crystal’s summit
The (O, ez) axis is the crystal’s normal
The crystal is tangent to (O, ex, ey)</p>
</dd>
</dl>
<p>[1] tofu/Notes_Upgrades/SpectroX2D/SpectroX2D_EllipsesOnPlane.pdf</p>
<dl class="simple">
<dt>Z:      float</dt><dd><p>Detector’s plane intersection with (O, ez) axis</p>
</dd>
<dt>n:      np.ndarray</dt><dd><p>(3,) array containing local (x,y,z) coordinates of the plane’s
normal vector</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="tofu.geom._core_optics.CrystalBragg.center">
<em class="property">property </em><code class="sig-name descname">center</code><a class="headerlink" href="#tofu.geom._core_optics.CrystalBragg.center" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tofu.geom._core_optics.CrystalBragg.dbragg">
<em class="property">property </em><code class="sig-name descname">dbragg</code><a class="headerlink" href="#tofu.geom._core_optics.CrystalBragg.dbragg" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the polygon defining the structure cross-section</p>
</dd></dl>

<dl class="method">
<dt id="tofu.geom._core_optics.CrystalBragg.dgeom">
<em class="property">property </em><code class="sig-name descname">dgeom</code><a class="headerlink" href="#tofu.geom._core_optics.CrystalBragg.dgeom" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tofu.geom._core_optics.CrystalBragg.dmat">
<em class="property">property </em><code class="sig-name descname">dmat</code><a class="headerlink" href="#tofu.geom._core_optics.CrystalBragg.dmat" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the polygon defining the structure cross-section</p>
</dd></dl>

<dl class="method">
<dt id="tofu.geom._core_optics.CrystalBragg.dmisc">
<em class="property">property </em><code class="sig-name descname">dmisc</code><a class="headerlink" href="#tofu.geom._core_optics.CrystalBragg.dmisc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tofu.geom._core_optics.CrystalBragg.e1">
<em class="property">property </em><code class="sig-name descname">e1</code><a class="headerlink" href="#tofu.geom._core_optics.CrystalBragg.e1" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tofu.geom._core_optics.CrystalBragg.e2">
<em class="property">property </em><code class="sig-name descname">e2</code><a class="headerlink" href="#tofu.geom._core_optics.CrystalBragg.e2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tofu.geom._core_optics.CrystalBragg.get_Rays_envelop">
<code class="sig-name descname">get_Rays_envelop</code><span class="sig-paren">(</span><em class="sig-param">phi=None</em>, <em class="sig-param">bragg=None</em>, <em class="sig-param">lamb=None</em>, <em class="sig-param">n=None</em>, <em class="sig-param">returnas=&lt;class 'object'&gt;</em>, <em class="sig-param">config=None</em>, <em class="sig-param">name=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_core_optics.html#CrystalBragg.get_Rays_envelop"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._core_optics.CrystalBragg.get_Rays_envelop" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tofu.geom._core_optics.CrystalBragg.get_Rays_from_summit">
<code class="sig-name descname">get_Rays_from_summit</code><span class="sig-paren">(</span><em class="sig-param">phi=None</em>, <em class="sig-param">bragg=None</em>, <em class="sig-param">lamb=None</em>, <em class="sig-param">n=None</em>, <em class="sig-param">returnas=&lt;class 'object'&gt;</em>, <em class="sig-param">config=None</em>, <em class="sig-param">name=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_core_optics.html#CrystalBragg.get_Rays_from_summit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._core_optics.CrystalBragg.get_Rays_from_summit" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tofu.geom._core_optics.CrystalBragg.get_bragg_from_lamb">
<code class="sig-name descname">get_bragg_from_lamb</code><span class="sig-paren">(</span><em class="sig-param">lamb</em>, <em class="sig-param">n=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_core_optics.html#CrystalBragg.get_bragg_from_lamb"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._core_optics.CrystalBragg.get_bragg_from_lamb" title="Permalink to this definition">¶</a></dt>
<dd><p>Braggs’ law: n*lamb = 2dsin(bragg)</p>
</dd></dl>

<dl class="method">
<dt id="tofu.geom._core_optics.CrystalBragg.get_color">
<code class="sig-name descname">get_color</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_core_optics.html#CrystalBragg.get_color"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._core_optics.CrystalBragg.get_color" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tofu.geom._core_optics.CrystalBragg.get_detector_approx">
<code class="sig-name descname">get_detector_approx</code><span class="sig-paren">(</span><em class="sig-param">bragg=None</em>, <em class="sig-param">lamb=None</em>, <em class="sig-param">rcurve=None</em>, <em class="sig-param">n=None</em>, <em class="sig-param">ddist=None</em>, <em class="sig-param">di=None</em>, <em class="sig-param">dj=None</em>, <em class="sig-param">dtheta=None</em>, <em class="sig-param">dpsi=None</em>, <em class="sig-param">tilt=None</em>, <em class="sig-param">tangent_to_rowland=None</em>, <em class="sig-param">plot=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_core_optics.html#CrystalBragg.get_detector_approx"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._core_optics.CrystalBragg.get_detector_approx" title="Permalink to this definition">¶</a></dt>
<dd><p>Return approximate ideal detector geometry</p>
<p>Assumes infinitesimal and ideal crystal
Assumes detector center tangential to Rowland circle
Assumes detector center matching lamb (m) / bragg (rad)</p>
<p>Detector described by center position, and (nout, ei, ej) unit vectors
By convention, nout = np.cross(ei, ej)
Vectors (ei, ej) define an orthogonal frame in the detector’s plane</p>
<dl class="simple">
<dt>det_cent:   np.ndarray</dt><dd><p>(3,) array of (x, y, z) coordinates of detector center</p>
</dd>
<dt>det_nout:   np.ndarray</dt><dd><dl class="simple">
<dt>(3,) array of (x, y, z) coordinates of unit vector</dt><dd><p>perpendicular to detector’ surface
oriented towards crystal</p>
</dd>
</dl>
</dd>
<dt>det_ei:     np.ndarray</dt><dd><dl class="simple">
<dt>(3,) array of (x, y, z) coordinates of unit vector</dt><dd><p>defining first coordinate in detector’s plane</p>
</dd>
</dl>
</dd>
<dt>det_ej:     np.ndarray</dt><dd><dl class="simple">
<dt>(3,) array of (x, y, z) coordinates of unit vector</dt><dd><p>defining second coordinate in detector’s plane</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="tofu.geom._core_optics.CrystalBragg.get_lamb_avail_from_pts">
<code class="sig-name descname">get_lamb_avail_from_pts</code><span class="sig-paren">(</span><em class="sig-param">pts</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_core_optics.html#CrystalBragg.get_lamb_avail_from_pts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._core_optics.CrystalBragg.get_lamb_avail_from_pts" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tofu.geom._core_optics.CrystalBragg.get_lamb_from_bragg">
<code class="sig-name descname">get_lamb_from_bragg</code><span class="sig-paren">(</span><em class="sig-param">bragg</em>, <em class="sig-param">n=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_core_optics.html#CrystalBragg.get_lamb_from_bragg"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._core_optics.CrystalBragg.get_lamb_from_bragg" title="Permalink to this definition">¶</a></dt>
<dd><p>Braggs’ law: n*lamb = 2dsin(bragg)</p>
</dd></dl>

<dl class="method">
<dt id="tofu.geom._core_optics.CrystalBragg.get_local_noute1e2">
<code class="sig-name descname">get_local_noute1e2</code><span class="sig-paren">(</span><em class="sig-param">theta</em>, <em class="sig-param">psi</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_core_optics.html#CrystalBragg.get_local_noute1e2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._core_optics.CrystalBragg.get_local_noute1e2" title="Permalink to this definition">¶</a></dt>
<dd><p>Return (nout, e1, e2) associated to pts on the crystal’s surface</p>
<dl>
<dt>All points on the spherical crystal’s surface are identified</dt><dd><dl class="simple">
<dt>by (theta, psi) coordinates, where:</dt><dd><ul class="simple">
<li><p>theta  = np.pi/2 for the center</p></li>
<li><p>psi = 0 for the center</p></li>
</ul>
</dd>
</dl>
<p>They are the spherical coordinates from a sphere centered on the
crystal’s center of curvature.</p>
</dd>
<dt>Return the pts themselves and the 3 perpendicular unti vectors</dt><dd><p>(nout, e1, e2), where nout is towards the outside of the sphere and
nout = np.cross(e1, e2)</p>
</dd>
</dl>
<dl class="simple">
<dt>summit:     np.ndarray</dt><dd><p>(3,) array of (x, y, z) coordinates of the points on the surface</p>
</dd>
<dt>nout:       np.ndarray</dt><dd><p>(3,) array of (x, y, z) coordinates of outward unit vector</p>
</dd>
<dt>e1:         np.ndarray</dt><dd><p>(3,) array of (x, y, z) coordinates of first unit vector</p>
</dd>
<dt>e2:         np.ndarray</dt><dd><p>(3,) array of (x, y, z) coordinates of second unit vector</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="tofu.geom._core_optics.CrystalBragg.get_phi_from_magaxis_summit">
<code class="sig-name descname">get_phi_from_magaxis_summit</code><span class="sig-paren">(</span><em class="sig-param">r</em>, <em class="sig-param">z</em>, <em class="sig-param">lamb=None</em>, <em class="sig-param">bragg=None</em>, <em class="sig-param">n=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_core_optics.html#CrystalBragg.get_phi_from_magaxis_summit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._core_optics.CrystalBragg.get_phi_from_magaxis_summit" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tofu.geom._core_optics.CrystalBragg.get_rockingcurve_func">
<code class="sig-name descname">get_rockingcurve_func</code><span class="sig-paren">(</span><em class="sig-param">lamb=None</em>, <em class="sig-param">n=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_core_optics.html#CrystalBragg.get_rockingcurve_func"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._core_optics.CrystalBragg.get_rockingcurve_func" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tofu.geom._core_optics.CrystalBragg.get_summary">
<code class="sig-name descname">get_summary</code><span class="sig-paren">(</span><em class="sig-param">sep='  '</em>, <em class="sig-param">line='-'</em>, <em class="sig-param">just='l'</em>, <em class="sig-param">table_sep=None</em>, <em class="sig-param">verb=True</em>, <em class="sig-param">return_=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_core_optics.html#CrystalBragg.get_summary"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._core_optics.CrystalBragg.get_summary" title="Permalink to this definition">¶</a></dt>
<dd><p>Summary description of the object content</p>
</dd></dl>

<dl class="method">
<dt id="tofu.geom._core_optics.CrystalBragg.move">
<code class="sig-name descname">move</code><span class="sig-paren">(</span><em class="sig-param">kind=None</em>, <em class="sig-param">**kwdargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_core_optics.html#CrystalBragg.move"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._core_optics.CrystalBragg.move" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tofu.geom._core_optics.CrystalBragg.nin">
<em class="property">property </em><code class="sig-name descname">nin</code><a class="headerlink" href="#tofu.geom._core_optics.CrystalBragg.nin" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tofu.geom._core_optics.CrystalBragg.nout">
<em class="property">property </em><code class="sig-name descname">nout</code><a class="headerlink" href="#tofu.geom._core_optics.CrystalBragg.nout" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tofu.geom._core_optics.CrystalBragg.plot">
<code class="sig-name descname">plot</code><span class="sig-paren">(</span><em class="sig-param">lax=None</em>, <em class="sig-param">proj=None</em>, <em class="sig-param">res=None</em>, <em class="sig-param">element=None</em>, <em class="sig-param">color=None</em>, <em class="sig-param">det_cent=None</em>, <em class="sig-param">det_nout=None</em>, <em class="sig-param">det_ei=None</em>, <em class="sig-param">det_ej=None</em>, <em class="sig-param">dP=None</em>, <em class="sig-param">dI=None</em>, <em class="sig-param">dBs=None</em>, <em class="sig-param">dBv=None</em>, <em class="sig-param">dVect=None</em>, <em class="sig-param">dIHor=None</em>, <em class="sig-param">dBsHor=None</em>, <em class="sig-param">dBvHor=None</em>, <em class="sig-param">dleg=None</em>, <em class="sig-param">draw=True</em>, <em class="sig-param">fs=None</em>, <em class="sig-param">wintit=None</em>, <em class="sig-param">Test=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_core_optics.html#CrystalBragg.plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._core_optics.CrystalBragg.plot" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tofu.geom._core_optics.CrystalBragg.plot_data_fit2d">
<code class="sig-name descname">plot_data_fit2d</code><span class="sig-paren">(</span><em class="sig-param">xi=None</em>, <em class="sig-param">xj=None</em>, <em class="sig-param">data=None</em>, <em class="sig-param">mask=None</em>, <em class="sig-param">det_cent=None</em>, <em class="sig-param">det_ei=None</em>, <em class="sig-param">det_ej=None</em>, <em class="sig-param">theta=None</em>, <em class="sig-param">psi=None</em>, <em class="sig-param">n=None</em>, <em class="sig-param">nlamb=None</em>, <em class="sig-param">lamb0=None</em>, <em class="sig-param">forcelamb=False</em>, <em class="sig-param">deg=None</em>, <em class="sig-param">knots=None</em>, <em class="sig-param">nbsplines=None</em>, <em class="sig-param">method=None</em>, <em class="sig-param">max_nfev=None</em>, <em class="sig-param">xtol=None</em>, <em class="sig-param">ftol=None</em>, <em class="sig-param">gtol=None</em>, <em class="sig-param">loss=None</em>, <em class="sig-param">verbose=0</em>, <em class="sig-param">debug=None</em>, <em class="sig-param">plot=True</em>, <em class="sig-param">fs=None</em>, <em class="sig-param">dlines=None</em>, <em class="sig-param">dmoments=None</em>, <em class="sig-param">cmap=None</em>, <em class="sig-param">vmin=None</em>, <em class="sig-param">vmax=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_core_optics.html#CrystalBragg.plot_data_fit2d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._core_optics.CrystalBragg.plot_data_fit2d" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tofu.geom._core_optics.CrystalBragg.plot_data_vs_lambphi">
<code class="sig-name descname">plot_data_vs_lambphi</code><span class="sig-paren">(</span><em class="sig-param">xi=None</em>, <em class="sig-param">xj=None</em>, <em class="sig-param">data=None</em>, <em class="sig-param">mask=None</em>, <em class="sig-param">det_cent=None</em>, <em class="sig-param">det_ei=None</em>, <em class="sig-param">det_ej=None</em>, <em class="sig-param">theta=None</em>, <em class="sig-param">psi=None</em>, <em class="sig-param">n=None</em>, <em class="sig-param">nlambfit=None</em>, <em class="sig-param">nphifit=None</em>, <em class="sig-param">magaxis=None</em>, <em class="sig-param">npaxis=None</em>, <em class="sig-param">plot=True</em>, <em class="sig-param">fs=None</em>, <em class="sig-param">cmap=None</em>, <em class="sig-param">vmin=None</em>, <em class="sig-param">vmax=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_core_optics.html#CrystalBragg.plot_data_vs_lambphi"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._core_optics.CrystalBragg.plot_data_vs_lambphi" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tofu.geom._core_optics.CrystalBragg.plot_line_from_pts_on_det">
<code class="sig-name descname">plot_line_from_pts_on_det</code><span class="sig-paren">(</span><em class="sig-param">lamb=None</em>, <em class="sig-param">pts=None</em>, <em class="sig-param">xi_bounds=None</em>, <em class="sig-param">xj_bounds=None</em>, <em class="sig-param">nphi=None</em>, <em class="sig-param">det_cent=None</em>, <em class="sig-param">det_nout=None</em>, <em class="sig-param">det_ei=None</em>, <em class="sig-param">det_ej=None</em>, <em class="sig-param">johann=False</em>, <em class="sig-param">lpsi=None</em>, <em class="sig-param">ltheta=None</em>, <em class="sig-param">rocking=False</em>, <em class="sig-param">fs=None</em>, <em class="sig-param">dmargin=None</em>, <em class="sig-param">wintit=None</em>, <em class="sig-param">tit=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_core_optics.html#CrystalBragg.plot_line_from_pts_on_det"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._core_optics.CrystalBragg.plot_line_from_pts_on_det" title="Permalink to this definition">¶</a></dt>
<dd><p>Visualize the de-focusing by ray-tracing of chosen lamb</p>
</dd></dl>

<dl class="method">
<dt id="tofu.geom._core_optics.CrystalBragg.plot_line_tracing_on_det">
<code class="sig-name descname">plot_line_tracing_on_det</code><span class="sig-paren">(</span><em class="sig-param">lamb=None</em>, <em class="sig-param">n=None</em>, <em class="sig-param">xi_bounds=None</em>, <em class="sig-param">xj_bounds=None</em>, <em class="sig-param">nphi=None</em>, <em class="sig-param">det_cent=None</em>, <em class="sig-param">det_nout=None</em>, <em class="sig-param">det_ei=None</em>, <em class="sig-param">det_ej=None</em>, <em class="sig-param">johann=False</em>, <em class="sig-param">lpsi=None</em>, <em class="sig-param">ltheta=None</em>, <em class="sig-param">rocking=False</em>, <em class="sig-param">fs=None</em>, <em class="sig-param">dmargin=None</em>, <em class="sig-param">wintit=None</em>, <em class="sig-param">tit=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_core_optics.html#CrystalBragg.plot_line_tracing_on_det"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._core_optics.CrystalBragg.plot_line_tracing_on_det" title="Permalink to this definition">¶</a></dt>
<dd><p>Visualize the de-focusing by ray-tracing of chosen lamb</p>
</dd></dl>

<dl class="method">
<dt id="tofu.geom._core_optics.CrystalBragg.plot_rockingcurve">
<code class="sig-name descname">plot_rockingcurve</code><span class="sig-paren">(</span><em class="sig-param">lamb=None</em>, <em class="sig-param">fs=None</em>, <em class="sig-param">ax=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_core_optics.html#CrystalBragg.plot_rockingcurve"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._core_optics.CrystalBragg.plot_rockingcurve" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tofu.geom._core_optics.CrystalBragg.rockingcurve">
<em class="property">property </em><code class="sig-name descname">rockingcurve</code><a class="headerlink" href="#tofu.geom._core_optics.CrystalBragg.rockingcurve" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tofu.geom._core_optics.CrystalBragg.sample_outline_Rays">
<code class="sig-name descname">sample_outline_Rays</code><span class="sig-paren">(</span><em class="sig-param">res=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_core_optics.html#CrystalBragg.sample_outline_Rays"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._core_optics.CrystalBragg.sample_outline_Rays" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tofu.geom._core_optics.CrystalBragg.sample_outline_plot">
<code class="sig-name descname">sample_outline_plot</code><span class="sig-paren">(</span><em class="sig-param">res=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_core_optics.html#CrystalBragg.sample_outline_plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._core_optics.CrystalBragg.sample_outline_plot" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tofu.geom._core_optics.CrystalBragg.set_color">
<code class="sig-name descname">set_color</code><span class="sig-paren">(</span><em class="sig-param">col</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_core_optics.html#CrystalBragg.set_color"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._core_optics.CrystalBragg.set_color" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tofu.geom._core_optics.CrystalBragg.set_dbragg">
<code class="sig-name descname">set_dbragg</code><span class="sig-paren">(</span><em class="sig-param">dbragg=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_core_optics.html#CrystalBragg.set_dbragg"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._core_optics.CrystalBragg.set_dbragg" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tofu.geom._core_optics.CrystalBragg.set_dgeom">
<code class="sig-name descname">set_dgeom</code><span class="sig-paren">(</span><em class="sig-param">dgeom=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_core_optics.html#CrystalBragg.set_dgeom"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._core_optics.CrystalBragg.set_dgeom" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tofu.geom._core_optics.CrystalBragg.set_dmat">
<code class="sig-name descname">set_dmat</code><span class="sig-paren">(</span><em class="sig-param">dmat=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_core_optics.html#CrystalBragg.set_dmat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._core_optics.CrystalBragg.set_dmat" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tofu.geom._core_optics.CrystalBragg.strip">
<code class="sig-name descname">strip</code><span class="sig-paren">(</span><em class="sig-param">strip=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_core_optics.html#CrystalBragg.strip"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._core_optics.CrystalBragg.strip" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove non-essential attributes to save memory / disk usage</p>
<p>Useful to save a very compressed version of the object
The higher strip =&gt; the more stripped the object
Use strip=0 to recover all atributes</p>
<dl class="simple">
<dt>See the difference by doing:</dt><dd><p>&gt; self.get_nbytes()
&gt; self.strip(-1)
&gt; self.get_nbytes()</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>strip</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – <dl>
<dt>Flag indicating how much to strip from the object</dt><dd><blockquote>
<div><p>0: Make complete (retrieve all attributes)
1: Remove nothing</p>
</div></blockquote>
<p>-1: Equivalent to strip=1</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="tofu.geom._core_optics.CrystalBragg.summit">
<em class="property">property </em><code class="sig-name descname">summit</code><a class="headerlink" href="#tofu.geom._core_optics.CrystalBragg.summit" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-tofu.geom._def">
<span id="tofu-geom-def-module"></span><h2>tofu.geom._def module<a class="headerlink" href="#module-tofu.geom._def" title="Permalink to this headline">¶</a></h2>
<p>This module stores all the default setting of ToFu
Including in particular computing parameters, dictionnaries and figures</p>
<dl class="data">
<dt id="tofu.geom._def.LOSdict">
<code class="sig-prename descclassname">tofu.geom._def.</code><code class="sig-name descname">LOSdict</code><em class="property"> = {'Elt': 'LDIORP', 'EltVes': '', 'Lax': None, 'Ldict': {'c': 'k', 'lw': 2}, 'Leg': '', 'LegDict': {'bbox_to_anchor': (1.01, 1), 'borderaxespad': 0.0, 'frameon': False, 'loc': 2, 'ncol': 1, 'prop': {'size': 10}}, 'Lplot': 'Tot', 'MdictD': {'c': 'k', 'ls': 'None', 'lw': 2, 'marker': 'x', 'markersize': 8, 'mew': 2}, 'MdictI': {'c': 'k', 'ls': 'None', 'lw': 2, 'marker': 'x', 'markersize': 8, 'mew': 2}, 'MdictO': {'c': 'k', 'ls': 'None', 'lw': 2, 'marker': 'x', 'markersize': 8, 'mew': 2}, 'MdictP': {'c': 'k', 'ls': 'None', 'lw': 2, 'marker': 'x', 'markersize': 8, 'mew': 2}, 'MdictR': {'c': 'k', 'ls': 'None', 'lw': 2, 'marker': 'x', 'markersize': 8, 'mew': 2}, 'Proj': 'All', 'Test': True, 'Vesdict': {'Elt': 'PIBsBvV', 'Lax': None, 'Lim': [1.5707963267948966, 6.283185307179586], 'Nstep': 50, 'Proj': 'All', 'Test': True, 'dBs': {'c': 'b', 'ls': 'dashed', 'marker': 'x', 'markersize': 8, 'mew': 2}, 'dBsHor': {'c': 'b', 'ls': 'dashed'}, 'dBv': {'c': 'g', 'ls': 'dashed', 'marker': 'x', 'markersize': 8, 'mew': 2}, 'dBvHor': {'c': 'g', 'ls': 'dashed'}, 'dI': {'c': 'k', 'ls': 'dashed', 'marker': 'x', 'markersize': 8, 'mew': 2}, 'dIHor': {'c': 'k', 'ls': 'dashed'}, 'dLeg': {'bbox_to_anchor': (1.01, 1), 'borderaxespad': 0.0, 'frameon': False, 'loc': 2, 'ncol': 1, 'prop': {'size': 10}}, 'dP': {'c': 'k', 'lw': 2}, 'dVect': {'color': 'r', 'scale': 10}, 'draw': True}, 'draw': True}</em><a class="headerlink" href="#tofu.geom._def.LOSdict" title="Permalink to this definition">¶</a></dt>
<dd><p># ————– Figures ————————</p>
<dl>
<dt>def Plot_Lens_Alone_DefAxes(fs=None, wintit=’tofu’):</dt><dd><p>axCol, fdpi = ‘w’, 80
if fs is None:</p>
<blockquote>
<div><p>fs = (20,8)</p>
</div></blockquote>
<dl class="simple">
<dt>elif type(fs) is str and fs==’a4’:</dt><dd><p>fs = (11.69,8.27)</p>
</dd>
</dl>
<p>f = plt.figure(facecolor=”w”, figsize=fs, dpi=fdpi)
axPos = [0.05, 0.1, 0.9, 0.85]
ax = f.add_axes(axPos,facecolor=axCol)
ax.set_xlabel(r”x (m)”)
ax.set_ylabel(r”y (m)”)
return ax</p>
</dd>
</dl>
<p># ———— Computing settings —————</p>
<p>DetSpanRMinMargin = 0.9
DetSpanNEdge = 5
DetSpanNRad = 5</p>
<p>DetConeNEdge = 8
DetConeNRad = 6</p>
<p>DetPreConedX12 = [0.01, 0.01]
DetPreConedX12Mode = ‘abs’
DetPreConeds = 0.01
DetPreConedsMode = ‘abs’
DetPreConeMarginS = 0.002</p>
<p>DetConeDX = 0.002
DetConeDRY = 0.0025 # 0.0025
DetConeDTheta = np.pi/1024. # 512.
DetConeDZ = 0.0025 # 0.0025
#DetConeNTheta = 25 # 25
#DetConeNZ = 50 # 50</p>
<p>DetConeRefdMax = 0.02</p>
<p>DetEtendMethod = ‘quad’
DetEtenddX12 = [0.01, 0.01]
DetEtenddX12Mode = ‘rel’
DetEtendepsrel = 1.e-3
DetEtendRatio = 0.02
DetCalcEtendColis = False</p>
<p>DetCalcSAngVectColis = True
DetCalcSAngVectCone = True</p>
<p>DetSynthEpsrel = 1.e-4
DetSynthdX12 = [0.005, 0.005]
DetSynthdX12Mode = ‘abs’
DetSynthds = 0.005
DetSynthdsMode = ‘abs’
DetSynthMarginS = 0.001</p>
<p># — Plotting dictionaries and parameters ——</p>
<p>ApPd = {‘c’:’k’,’lw’:2,’ls’:’solid’}
ApVd = {‘color’:’r’,’lw’:2,’ls’:’solid’}
DetPd = {‘c’:’k’,’lw’:2,’ls’:’solid’}
DetVd = {‘color’:’r’,’lw’:2,’ls’:’solid’}
DetSAngPld = {‘cmap’:plt.cm.YlOrRd,’lw’:0.,’rstride’:1,’cstride’:1, ‘antialiased’:False, ‘edgecolor’:’None’}
DetSangPlContd = {‘linewidths’:0.}
DetConed = {‘edgecolors’:’k’, ‘facecolors’:(0.8,0.8,0.8,0.2), ‘alpha’:0.2, ‘linewidths’:0., ‘linestyles’:’-‘, ‘antialiaseds’:False}
DetImpd = {‘ls’:’solid’,’c’:’k’,’lw’:1}</p>
<p>ApLVin = 0.1
DetSAngPlRa = 0.5
DetSAngPldX12 = [0.025,0.025]
DetSAngPldX12Mode = ‘rel’
DetSAngPlRatio = 0.01
DetEtendOnLOSNP = 20
DetEtendOnLOSModes = [‘trapz’]
DetEtendOnLOSLd = {‘ls’:’solid’,’c’:’k’,’lw’:2}</p>
<p>DetSAngPlot = ‘Int’
DetSAngPlotMode = ‘scatter’
DetSAngPlotd = {‘cmap’:plt.cm.YlOrRd}
DetSAngPlotLvl = 20</p>
<p>DetSliceAGdR = 0.005
DetSliceAGdY = 0.005
DetSliceAGdX = 0.01
DetSliceAGdTheta = np.pi/512.
DetSliceAGdZ = 0.005
DetSliceNbd = {‘scatter’:{‘cmap’:plt.cm.Greys,’marker’:’s’,’edgecolors’:’None’,’s’:10},</p>
<blockquote>
<div><p>‘contour’:{‘cmap’:plt.cm.Greys},
‘contourf’:{‘cmap’:plt.cm.Greys},
‘imshow’:{‘cmap’:plt.cm.Greys}}</p>
</div></blockquote>
<dl class="simple">
<dt>DetSliceSAd = {‘scatter’:{‘cmap’:plt.cm.YlOrRd,’marker’:’s’,’edgecolors’:’None’,’s’:10, ‘vmin’:0},</dt><dd><p>‘contour’:{‘cmap’:plt.cm.YlOrRd, ‘vmin’:0},
‘contourf’:{‘cmap’:plt.cm.YlOrRd, ‘vmin’:0},
‘imshow’:{‘cmap’:plt.cm.YlOrRd, ‘vmin’:0}}</p>
</dd>
</dl>
<p>DetPolProjNTheta = 50
DetPolProjNZ = 25
DetSAngColis = True</p>
<p>GDetEtendMdA = {‘ls’:’None’,’c’:’k’,’lw’:2,’marker’:’+’}
GDetEtendMdR = {‘ls’:’None’,’c’:’b’,’lw’:2,’marker’:’x’}
GDetEtendMdS = {‘ls’:’None’,’c’:’g’,’lw’:2,’marker’:’o’}
GDetEtendMdP = {‘ls’:’None’,’c’:’r’,’lw’:2,’marker’:’*’}</p>
<p>GDetSigd = {‘ls’:’solid’,’c’:’k’,’lw’:2,’marker’:’+’}</p>
<p>Apertdict = dict(Lax=None, Proj=’All’, Elt=’PV’, EltVes=’’, Leg=’’, LVIn=ApLVin, Pdict=ApPd, Vdict=ApVd, Vesdict=Vesdict, LegDict=TorLegd, draw=True, Test=True)
#Detdict =</p>
<p># ————– Figures ————————</p>
<dl>
<dt>def Plot_SAng_Plane_DefAxes(fs=None, wintit=’tofu’):</dt><dd><p>axCol, fdpi = ‘w’, 80
if fs is None:</p>
<blockquote>
<div><p>fs = (16,8) if Mode.lower()==’all’ else (6,8)</p>
</div></blockquote>
<dl class="simple">
<dt>elif type(fs) is str and fs==’a4’:</dt><dd><p>fs = (11.69,8.27) if Mode.lower()==’all’ else (8.27,11.69)</p>
</dd>
</dl>
<p>f = plt.figure(facecolor=”w”, figsize=fs, dpi=fdpi)
(fW,fH,fdpi,axCol) = (11.69,8.27,80,’w’) if a4 else (10,8,80,’w’)
axPos = [0.05, 0.05, 0.9, 0.9]
f = plt.figure(facecolor=”w”,figsize=(fW,fH),dpi=fdpi)
ax = f.add_axes(axPos,facecolor=axCol,projection=’3d’)
ax.set_xlabel(r”X1 (m)”)
ax.set_ylabel(r”X2 (m)”)
ax.set_zlabel(r”$Omega$ (sr)”)
return ax</p>
</dd>
<dt>def Plot_Etendue_AlongLOS_DefAxes(kMode=’rel’,fs=None, wintit=’tofu’):</dt><dd><p>axCol, fdpi = ‘w’, 80
if fs is None:</p>
<blockquote>
<div><p>fs = (16,8) if Mode.lower()==’all’ else (6,8)</p>
</div></blockquote>
<dl class="simple">
<dt>elif type(fs) is str and fs==’a4’:</dt><dd><p>fs = (11.69,8.27) if Mode.lower()==’all’ else (8.27,11.69)</p>
</dd>
</dl>
<p>f = plt.figure(facecolor=”w”, figsize=fs, dpi=fdpi)
(fW,fH,fdpi,axCol) = (11.69,8.27,80,’w’) if a4 else (14,8,80,’w’)
axPos = [0.06, 0.08, 0.70, 0.86]
f = plt.figure(facecolor=”w”,figsize=(fW,fH),dpi=fdpi)
ax = f.add_axes(axPos,frameon=True,facecolor=axCol)
if kMode.lower()==’rel’:</p>
<blockquote>
<div><p>ax.set_xlabel(r”Rel. length (adim.)”)</p>
</div></blockquote>
<dl class="simple">
<dt>else:</dt><dd><p>ax.set_xlabel(r”Length (m)”)</p>
</dd>
</dl>
<p>ax.set_ylabel(r”Etendue ($sr.m^2$)”)
return ax</p>
</dd>
<dt>def Plot_CrossSlice_SAngNb_DefAxes(VType=’Tor’, fs=None, wintit=’tofu’):</dt><dd><p>axCol, fdpi = ‘w’, 80
if fs is None:</p>
<blockquote>
<div><p>fs = (16,8) if Mode.lower()==’all’ else (6,8)</p>
</div></blockquote>
<dl class="simple">
<dt>elif type(fs) is str and fs==’a4’:</dt><dd><p>fs = (11.69,8.27) if Mode.lower()==’all’ else (8.27,11.69)</p>
</dd>
</dl>
<p>f = plt.figure(facecolor=”w”, figsize=fs, dpi=fdpi)
(fW,fH,fdpi,axCol) = (11.69,8.27,80,’w’) if a4 else (15,8,80,’w’)
f = plt.figure(facecolor=”w”,figsize=(fW,fH),dpi=fdpi)
axSAng = f.add_axes([0.05, 0.06, 0.40, 0.85],frameon=True,facecolor=axCol)
axNb = f.add_axes([0.60, 0.06, 0.40, 0.85],frameon=True,facecolor=axCol)
if VType==’Tor’:</p>
<blockquote>
<div><p>axSAng.set_xlabel(r”R (m)”),    axNb.set_xlabel(r”R (m)”)</p>
</div></blockquote>
<dl class="simple">
<dt>elif VType==’Lin’:</dt><dd><p>axSAng.set_xlabel(r”Y (m)”),    axNb.set_xlabel(r”Y (m)”)</p>
</dd>
</dl>
<p>axSAng.set_ylabel(r”Z (m)”),      axNb.set_ylabel(r”Z (m)”)
axSAng.set_aspect(aspect=”equal”, adjustable=’datalim’)
axNb.set_aspect(aspect=”equal”, adjustable=’datalim’)
return axSAng, axNb</p>
</dd>
<dt>def Plot_HorSlice_SAngNb_DefAxes(fs=None, wintit=’tofu’):</dt><dd><p>axCol, fdpi = ‘w’, 80
if fs is None:</p>
<blockquote>
<div><p>fs = (16,8) if Mode.lower()==’all’ else (6,8)</p>
</div></blockquote>
<dl class="simple">
<dt>elif type(fs) is str and fs==’a4’:</dt><dd><p>fs = (11.69,8.27) if Mode.lower()==’all’ else (8.27,11.69)</p>
</dd>
</dl>
<p>f = plt.figure(facecolor=”w”, figsize=fs, dpi=fdpi)
(fW,fH,fdpi,axCol) = (11.69,8.27,80,’w’) if a4 else (15,8,80,’w’)
f = plt.figure(facecolor=”w”,figsize=(fW,fH),dpi=fdpi)
axSAng = f.add_axes([0.07, 0.12, 0.35, 0.8],frameon=True,facecolor=axCol)
axNb = f.add_axes([0.55, 0.12, 0.35, 0.8],frameon=True,facecolor=axCol)
axSAng.set_xlabel(r”X (m)”),    axSAng.set_ylabel(r”Y (m)”)
axNb.set_xlabel(r”X (m)”),      axNb.set_ylabel(r”Y (m)”)
axSAng.set_aspect(aspect=”equal”, adjustable=’datalim’)
axNb.set_aspect(aspect=”equal”, adjustable=’datalim’)
return axSAng, axNb</p>
</dd>
<dt>def Plot_Etendues_GDetect_DefAxes(fs=None, wintit=’tofu’):</dt><dd><p>axCol, fdpi = ‘w’, 80
if fs is None:</p>
<blockquote>
<div><p>fs = (16,8) if Mode.lower()==’all’ else (6,8)</p>
</div></blockquote>
<dl class="simple">
<dt>elif type(fs) is str and fs==’a4’:</dt><dd><p>fs = (11.69,8.27) if Mode.lower()==’all’ else (8.27,11.69)</p>
</dd>
</dl>
<p>f = plt.figure(facecolor=”w”, figsize=fs, dpi=fdpi)
(fW,fH,fdpi,axCol) = (11.69,8.27,80,’w’) if a4 else (18,8,80,’w’)
f = plt.figure(facecolor=”w”,figsize=(fW,fH),dpi=fdpi)
ax = f.add_axes([0.05,0.1,0.85,0.80],frameon=True,facecolor=axCol)
ax.set_xlabel(r””)
ax.set_ylabel(r”Etendue (sr.m^2)”)
return ax</p>
</dd>
<dt>def Plot_Sig_GDetect_DefAxes(fs=None, wintit=’tofu’):</dt><dd><p>axCol, fdpi = ‘w’, 80
if fs is None:</p>
<blockquote>
<div><p>fs = (16,8) if Mode.lower()==’all’ else (6,8)</p>
</div></blockquote>
<dl class="simple">
<dt>elif type(fs) is str and fs==’a4’:</dt><dd><p>fs = (11.69,8.27) if Mode.lower()==’all’ else (8.27,11.69)</p>
</dd>
</dl>
<p>f = plt.figure(facecolor=”w”, figsize=fs, dpi=fdpi)
(fW,fH,fdpi,axCol) = (11.69,8.27,80,’w’) if a4 else (18,8,80,’w’)
f = plt.figure(facecolor=”w”,figsize=(fW,fH),dpi=fdpi)
ax = f.add_axes([0.05,0.1,0.85,0.80],frameon=True,facecolor=axCol)
ax.set_xlabel(r””)
ax.set_ylabel(r”Signal (W)”)
return ax</p>
</dd>
</dl>
<p>#Ldict_mlab_Def = {‘color’:(0.,0.,0.),’tube_radius’:None}
#Mdict_mlab_Def = {‘color’:(0.,0.,0.),’line_width’:1,’mode’:’sphere’}
#Dict_3D_mlab_Tor_Def = {‘color’:(0.8,0.8,0.8),’opacity’:0.15,’transparent’:False,’scale_factor’:0.1}</p>
<dl>
<dt>def Plot_GDetect_Resolution_DefAxes(VType=’Tor’, fs=None, wintit=’tofu’):</dt><dd><p>axCol, fdpi = ‘w’, 80
if fs is None:</p>
<blockquote>
<div><p>fs = (16,8) if Mode.lower()==’all’ else (6,8)</p>
</div></blockquote>
<dl class="simple">
<dt>elif type(fs) is str and fs==’a4’:</dt><dd><p>fs = (11.69,8.27) if Mode.lower()==’all’ else (8.27,11.69)</p>
</dd>
</dl>
<p>f = plt.figure(facecolor=”w”, figsize=fs, dpi=fdpi)
axCol = “w”
(fW,fH) = (11.69,8.27) if a4 else (16,10)
f = plt.figure(figsize=(fW,fH),facecolor=axCol)
ax1 = f.add_axes([0.05, 0.06, 0.32, 0.80], frameon=True, facecolor=axCol)
ax2 = f.add_axes([0.50, 0.55, 0.47, 0.40], frameon=True, facecolor=axCol)
ax3 = f.add_axes([0.50, 0.06, 0.47, 0.40], frameon=True, facecolor=axCol)
X1 = r”R (m)” if VType==’Tor’ else r”Y (m)”
ax1.set_xlabel(X1)
ax1.set_ylabel(r”Z (m)”)
ax2.set_xlabel(r”size (a.u.)”)
ax2.set_ylabel(r”Signal (mW)”)
ax3.set_xlabel(r”Channels index (from 0)”)
ax3.set_ylabel(r”Signal (mW)”)
ax1.set_aspect(aspect=’equal’,adjustable=’datalim’)
return ax1, ax2, ax3</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="tofu.geom._def.Plot_3D_plt_Tor_DefAxes">
<code class="sig-prename descclassname">tofu.geom._def.</code><code class="sig-name descname">Plot_3D_plt_Tor_DefAxes</code><span class="sig-paren">(</span><em class="sig-param">fs=None</em>, <em class="sig-param">wintit='tofu'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_def.html#Plot_3D_plt_Tor_DefAxes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._def.Plot_3D_plt_Tor_DefAxes" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="tofu.geom._def.Plot_Impact_DefAxes">
<code class="sig-prename descclassname">tofu.geom._def.</code><code class="sig-name descname">Plot_Impact_DefAxes</code><span class="sig-paren">(</span><em class="sig-param">Proj</em>, <em class="sig-param">Ang='theta'</em>, <em class="sig-param">AngUnit='rad'</em>, <em class="sig-param">fs=None</em>, <em class="sig-param">wintit='tofu'</em>, <em class="sig-param">Sketch=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_def.html#Plot_Impact_DefAxes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._def.Plot_Impact_DefAxes" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="tofu.geom._def.Plot_LOSProj_DefAxes">
<code class="sig-prename descclassname">tofu.geom._def.</code><code class="sig-name descname">Plot_LOSProj_DefAxes</code><span class="sig-paren">(</span><em class="sig-param">Mode</em>, <em class="sig-param">Type='Tor'</em>, <em class="sig-param">fs=None</em>, <em class="sig-param">wintit='tofu'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_def.html#Plot_LOSProj_DefAxes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._def.Plot_LOSProj_DefAxes" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="tofu-geom-distance-tools-cpython-36m-darwin-module">
<h2>tofu.geom._distance_tools.cpython-36m-darwin module<a class="headerlink" href="#tofu-geom-distance-tools-cpython-36m-darwin-module" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-tofu.geom._distance_tools">
<span id="tofu-geom-distance-tools-module"></span><h2>tofu.geom._distance_tools module<a class="headerlink" href="#module-tofu.geom._distance_tools" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-tofu.geom._plot">
<span id="tofu-geom-plot-module"></span><h2>tofu.geom._plot module<a class="headerlink" href="#module-tofu.geom._plot" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="tofu.geom._plot.Config_phithetaproj_dist">
<code class="sig-prename descclassname">tofu.geom._plot.</code><code class="sig-name descname">Config_phithetaproj_dist</code><span class="sig-paren">(</span><em class="sig-param">config</em>, <em class="sig-param">refpt</em>, <em class="sig-param">dist</em>, <em class="sig-param">indStruct</em>, <em class="sig-param">distonly=False</em>, <em class="sig-param">cmap=None</em>, <em class="sig-param">vmin=None</em>, <em class="sig-param">vmax=None</em>, <em class="sig-param">invertx=None</em>, <em class="sig-param">ax=None</em>, <em class="sig-param">fs=None</em>, <em class="sig-param">cbck=(0.8</em>, <em class="sig-param">0.8</em>, <em class="sig-param">0.8</em>, <em class="sig-param">0.8)</em>, <em class="sig-param">tit=None</em>, <em class="sig-param">wintit=None</em>, <em class="sig-param">legend=None</em>, <em class="sig-param">draw=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_plot.html#Config_phithetaproj_dist"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._plot.Config_phithetaproj_dist" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="tofu.geom._plot.GLOS_plot_Sino">
<code class="sig-prename descclassname">tofu.geom._plot.</code><code class="sig-name descname">GLOS_plot_Sino</code><span class="sig-paren">(</span><em class="sig-param">GLos</em>, <em class="sig-param">Proj='Cross'</em>, <em class="sig-param">ax=None</em>, <em class="sig-param">Elt='LV'</em>, <em class="sig-param">Sketch=True</em>, <em class="sig-param">Ang='theta'</em>, <em class="sig-param">AngUnit='rad'</em>, <em class="sig-param">Leg=None</em>, <em class="sig-param">dL={'c': 'k'</em>, <em class="sig-param">'ls': 'None'</em>, <em class="sig-param">'lw': 2</em>, <em class="sig-param">'marker': 'x'</em>, <em class="sig-param">'markersize': 8</em>, <em class="sig-param">'mew': 2}</em>, <em class="sig-param">dVes={'edgecolor': (0.8</em>, <em class="sig-param">0.8</em>, <em class="sig-param">0.8</em>, <em class="sig-param">1.0)</em>, <em class="sig-param">'facecolor': (0.8</em>, <em class="sig-param">0.8</em>, <em class="sig-param">0.8</em>, <em class="sig-param">1.0)</em>, <em class="sig-param">'linestyle': 'solid'</em>, <em class="sig-param">'linewidth': 1}</em>, <em class="sig-param">dLeg={'bbox_to_anchor': (1.01</em>, <em class="sig-param">1)</em>, <em class="sig-param">'borderaxespad': 0.0</em>, <em class="sig-param">'frameon': False</em>, <em class="sig-param">'loc': 2</em>, <em class="sig-param">'ncol': 1</em>, <em class="sig-param">'prop': {'size': 10}}</em>, <em class="sig-param">ind=None</em>, <em class="sig-param">multi=False</em>, <em class="sig-param">draw=True</em>, <em class="sig-param">fs=None</em>, <em class="sig-param">tit=None</em>, <em class="sig-param">wintit=None</em>, <em class="sig-param">Test=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_plot.html#GLOS_plot_Sino"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._plot.GLOS_plot_Sino" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="tofu.geom._plot.Get_FieldsFrom_LLOS">
<code class="sig-prename descclassname">tofu.geom._plot.</code><code class="sig-name descname">Get_FieldsFrom_LLOS</code><span class="sig-paren">(</span><em class="sig-param">L</em>, <em class="sig-param">Fields</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_plot.html#Get_FieldsFrom_LLOS"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._plot.Get_FieldsFrom_LLOS" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="tofu.geom._plot.Plot_Impact_3DPoly">
<code class="sig-prename descclassname">tofu.geom._plot.</code><code class="sig-name descname">Plot_Impact_3DPoly</code><span class="sig-paren">(</span><em class="sig-param">T</em>, <em class="sig-param">Leg=''</em>, <em class="sig-param">ax=None</em>, <em class="sig-param">Ang='theta'</em>, <em class="sig-param">AngUnit='rad'</em>, <em class="sig-param">Pdict={'color': (0.8</em>, <em class="sig-param">0.8</em>, <em class="sig-param">0.8</em>, <em class="sig-param">0.4)</em>, <em class="sig-param">'linestyle': 'solid'</em>, <em class="sig-param">'linewidth': 0}</em>, <em class="sig-param">dLeg={'bbox_to_anchor': (1.01</em>, <em class="sig-param">1)</em>, <em class="sig-param">'borderaxespad': 0.0</em>, <em class="sig-param">'frameon': False</em>, <em class="sig-param">'loc': 2</em>, <em class="sig-param">'ncol': 1</em>, <em class="sig-param">'prop': {'size': 10}}</em>, <em class="sig-param">draw=True</em>, <em class="sig-param">fs=None</em>, <em class="sig-param">wintit='tofu-1.4.2b4-92-gf832ab7e        report issues / requests at https://github.com/ToFuProject/tofu/issues'</em>, <em class="sig-param">Test=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_plot.html#Plot_Impact_3DPoly"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._plot.Plot_Impact_3DPoly" title="Permalink to this definition">¶</a></dt>
<dd><p>Plotting the toroidal projection of a Ves instance</p>
<p>D. VEZINET, Aug. 2014
Inputs :</p>
<blockquote>
<div><p>T           A Ves instance
Leg         A str (the legend label to be used if T is not a Ves instance)
ax          A plt.Axes instance (if given) on which to plot the projection space, otherwise (‘None’) a new figure/axes is created
Dict        A dictionnary specifying the style of the boundary polygon plot
dLeg        A dictionnary specifying the style of the legend box</p>
</div></blockquote>
<dl class="simple">
<dt>Outputs :</dt><dd><p>ax          The plt.Axes instance on which the poloidal plot was performed</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="tofu.geom._plot.Plot_Impact_PolProjPoly">
<code class="sig-prename descclassname">tofu.geom._plot.</code><code class="sig-name descname">Plot_Impact_PolProjPoly</code><span class="sig-paren">(</span><em class="sig-param">lS</em>, <em class="sig-param">Leg=''</em>, <em class="sig-param">ax=None</em>, <em class="sig-param">Ang='theta'</em>, <em class="sig-param">AngUnit='rad'</em>, <em class="sig-param">Sketch=True</em>, <em class="sig-param">dP=None</em>, <em class="sig-param">dLeg={'bbox_to_anchor': (1.01</em>, <em class="sig-param">1)</em>, <em class="sig-param">'borderaxespad': 0.0</em>, <em class="sig-param">'frameon': False</em>, <em class="sig-param">'loc': 2</em>, <em class="sig-param">'ncol': 1</em>, <em class="sig-param">'prop': {'size': 10}}</em>, <em class="sig-param">draw=True</em>, <em class="sig-param">fs=None</em>, <em class="sig-param">wintit=None</em>, <em class="sig-param">tit=None</em>, <em class="sig-param">Test=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_plot.html#Plot_Impact_PolProjPoly"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._plot.Plot_Impact_PolProjPoly" title="Permalink to this definition">¶</a></dt>
<dd><p>Plotting the toroidal projection of a Ves instance</p>
<p>D. VEZINET, Aug. 2014
Inputs :</p>
<blockquote>
<div><p>T           A Ves instance
Leg         A str (the legend label to be used if T is not a Ves instance)
ax          A plt.Axes instance (if given) on which to plot the projection space, otherwise (‘None’) a new figure/axes is created
Dict        A dictionnary specifying the style of the boundary polygon plot
dLeg        A dictionnary specifying the style of the legend box</p>
</div></blockquote>
<dl class="simple">
<dt>Outputs :</dt><dd><p>ax          The plt.Axes instance on which the poloidal plot was performed</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="tofu.geom._plot.Rays_plot">
<code class="sig-prename descclassname">tofu.geom._plot.</code><code class="sig-name descname">Rays_plot</code><span class="sig-paren">(</span><em class="sig-param">GLos</em>, <em class="sig-param">Lax=None</em>, <em class="sig-param">Proj='all'</em>, <em class="sig-param">reflections=True</em>, <em class="sig-param">Lplot='Tot'</em>, <em class="sig-param">element='LDIORP'</em>, <em class="sig-param">element_config='P'</em>, <em class="sig-param">Leg=None</em>, <em class="sig-param">dL=None</em>, <em class="sig-param">dPtD={'c': 'k'</em>, <em class="sig-param">'ls': 'None'</em>, <em class="sig-param">'lw': 2</em>, <em class="sig-param">'marker': 'x'</em>, <em class="sig-param">'markersize': 8</em>, <em class="sig-param">'mew': 2}</em>, <em class="sig-param">dPtI={'c': 'k'</em>, <em class="sig-param">'ls': 'None'</em>, <em class="sig-param">'lw': 2</em>, <em class="sig-param">'marker': 'x'</em>, <em class="sig-param">'markersize': 8</em>, <em class="sig-param">'mew': 2}</em>, <em class="sig-param">dPtO={'c': 'k'</em>, <em class="sig-param">'ls': 'None'</em>, <em class="sig-param">'lw': 2</em>, <em class="sig-param">'marker': 'x'</em>, <em class="sig-param">'markersize': 8</em>, <em class="sig-param">'mew': 2}</em>, <em class="sig-param">dPtR={'c': 'k'</em>, <em class="sig-param">'ls': 'None'</em>, <em class="sig-param">'lw': 2</em>, <em class="sig-param">'marker': 'x'</em>, <em class="sig-param">'markersize': 8</em>, <em class="sig-param">'mew': 2}</em>, <em class="sig-param">dPtP={'c': 'k'</em>, <em class="sig-param">'ls': 'None'</em>, <em class="sig-param">'lw': 2</em>, <em class="sig-param">'marker': 'x'</em>, <em class="sig-param">'markersize': 8</em>, <em class="sig-param">'mew': 2}</em>, <em class="sig-param">dLeg={'bbox_to_anchor': (1.01</em>, <em class="sig-param">1)</em>, <em class="sig-param">'borderaxespad': 0.0</em>, <em class="sig-param">'frameon': False</em>, <em class="sig-param">'loc': 2</em>, <em class="sig-param">'ncol': 1</em>, <em class="sig-param">'prop': {'size': 10}}</em>, <em class="sig-param">multi=False</em>, <em class="sig-param">draw=True</em>, <em class="sig-param">fs=None</em>, <em class="sig-param">wintit=None</em>, <em class="sig-param">tit=None</em>, <em class="sig-param">Test=True</em>, <em class="sig-param">ind=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_plot.html#Rays_plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._plot.Rays_plot" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="tofu.geom._plot.Rays_plot_touch">
<code class="sig-prename descclassname">tofu.geom._plot.</code><code class="sig-name descname">Rays_plot_touch</code><span class="sig-paren">(</span><em class="sig-param">cam, key=None, ind=None, quant='lengths', cdef='k', invert=None, Bck=True, cbck=(0.8, 0.8, 0.8), Lplot='In', incch=[1, 10], ms=4, cmap='touch', vmin=None, vmax=None, fmt_ch='02.0f', labelpad=0, dmargin=None, nchMax=4, lcch=[(0.8392156862745098, 0.15294117647058825, 0.1568627450980392), (0.5803921568627451, 0.403921568627451, 0.7411764705882353), (0.5490196078431373, 0.33725490196078434, 0.29411764705882354), (1.0, 0.596078431372549, 0.5882352941176471), (0.7725490196078432, 0.6901960784313725, 0.8352941176470589), (0.7686274509803922, 0.611764705882353, 0.5803921568627451)], fs=None, wintit=None, tit=None, fontsize=8, draw=True, connect=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_plot.html#Rays_plot_touch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._plot.Rays_plot_touch" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="tofu.geom._plot.Struct_plot">
<code class="sig-prename descclassname">tofu.geom._plot.</code><code class="sig-name descname">Struct_plot</code><span class="sig-paren">(</span><em class="sig-param">lS</em>, <em class="sig-param">lax=None</em>, <em class="sig-param">proj='all'</em>, <em class="sig-param">element=None</em>, <em class="sig-param">dP=None</em>, <em class="sig-param">dI=None</em>, <em class="sig-param">dBs=None</em>, <em class="sig-param">dBv=None</em>, <em class="sig-param">dVect=None</em>, <em class="sig-param">dIHor=None</em>, <em class="sig-param">dBsHor=None</em>, <em class="sig-param">dBvHor=None</em>, <em class="sig-param">Lim=None</em>, <em class="sig-param">Nstep=None</em>, <em class="sig-param">dLeg=None</em>, <em class="sig-param">indices=False</em>, <em class="sig-param">draw=True</em>, <em class="sig-param">fs=None</em>, <em class="sig-param">wintit=None</em>, <em class="sig-param">tit=None</em>, <em class="sig-param">Test=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_plot.html#Struct_plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._plot.Struct_plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the projections of a list of Struct subclass instances</p>
<p>D. VEZINET, Aug. 2014
Inputs :</p>
<blockquote>
<div><p>V           A Ves instance
Nstep      An int (the number of points for evaluation of theta by np.linspace)
axP         A plt.Axes instance (if given) on which to plot the poloidal projection, otherwise (‘None’) a new figure/axes is created
axT         A plt.Axes instance (if given) on which to plot the toroidal projection, otherwise (‘None’) a new figure/axes is created
Tdict       A dictionnary specifying the style of the polygon plot
dLeg     A dictionnary specifying the style of the legend box (if None =&gt; no legend)</p>
</div></blockquote>
<dl class="simple">
<dt>Outputs :</dt><dd><p>axP          The plt.Axes instance on which the poloidal plot was performed
axT          The plt.Axes instance on which the toroidal plot was performed</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-tofu.geom._plot_optics">
<span id="tofu-geom-plot-optics-module"></span><h2>tofu.geom._plot_optics module<a class="headerlink" href="#module-tofu.geom._plot_optics" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="tofu.geom._plot_optics.CrystalBragg_plot">
<code class="sig-prename descclassname">tofu.geom._plot_optics.</code><code class="sig-name descname">CrystalBragg_plot</code><span class="sig-paren">(</span><em class="sig-param">cryst</em>, <em class="sig-param">lax=None</em>, <em class="sig-param">proj=None</em>, <em class="sig-param">res=None</em>, <em class="sig-param">element=None</em>, <em class="sig-param">color=None</em>, <em class="sig-param">dP=None</em>, <em class="sig-param">det_cent=None</em>, <em class="sig-param">det_nout=None</em>, <em class="sig-param">det_ei=None</em>, <em class="sig-param">det_ej=None</em>, <em class="sig-param">dI=None</em>, <em class="sig-param">dBs=None</em>, <em class="sig-param">dBv=None</em>, <em class="sig-param">dVect=None</em>, <em class="sig-param">dIHor=None</em>, <em class="sig-param">dBsHor=None</em>, <em class="sig-param">dBvHor=None</em>, <em class="sig-param">dleg=None</em>, <em class="sig-param">indices=False</em>, <em class="sig-param">draw=True</em>, <em class="sig-param">fs=None</em>, <em class="sig-param">wintit=None</em>, <em class="sig-param">tit=None</em>, <em class="sig-param">Test=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_plot_optics.html#CrystalBragg_plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._plot_optics.CrystalBragg_plot" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="tofu.geom._plot_optics.CrystalBragg_plot_approx_detector_params">
<code class="sig-prename descclassname">tofu.geom._plot_optics.</code><code class="sig-name descname">CrystalBragg_plot_approx_detector_params</code><span class="sig-paren">(</span><em class="sig-param">Rrow</em>, <em class="sig-param">bragg</em>, <em class="sig-param">d</em>, <em class="sig-param">Z</em>, <em class="sig-param">frame_cent</em>, <em class="sig-param">nn</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_plot_optics.html#CrystalBragg_plot_approx_detector_params"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._plot_optics.CrystalBragg_plot_approx_detector_params" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="tofu.geom._plot_optics.CrystalBragg_plot_braggangle_from_xixj">
<code class="sig-prename descclassname">tofu.geom._plot_optics.</code><code class="sig-name descname">CrystalBragg_plot_braggangle_from_xixj</code><span class="sig-paren">(</span><em class="sig-param">xi=None</em>, <em class="sig-param">xj=None</em>, <em class="sig-param">bragg=None</em>, <em class="sig-param">angle=None</em>, <em class="sig-param">ax=None</em>, <em class="sig-param">plot=None</em>, <em class="sig-param">braggunits='rad'</em>, <em class="sig-param">angunits='rad'</em>, <em class="sig-param">**kwdargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_plot_optics.html#CrystalBragg_plot_braggangle_from_xixj"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._plot_optics.CrystalBragg_plot_braggangle_from_xixj" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="tofu.geom._plot_optics.CrystalBragg_plot_data_vs_fit">
<code class="sig-prename descclassname">tofu.geom._plot_optics.</code><code class="sig-name descname">CrystalBragg_plot_data_vs_fit</code><span class="sig-paren">(</span><em class="sig-param">xi</em>, <em class="sig-param">xj</em>, <em class="sig-param">bragg</em>, <em class="sig-param">lamb</em>, <em class="sig-param">phi</em>, <em class="sig-param">data</em>, <em class="sig-param">mask=None</em>, <em class="sig-param">lambfit=None</em>, <em class="sig-param">phifit=None</em>, <em class="sig-param">spect1d=None</em>, <em class="sig-param">dfit1d=None</em>, <em class="sig-param">dfit2d=None</em>, <em class="sig-param">lambfitbins=None</em>, <em class="sig-param">cmap=None</em>, <em class="sig-param">vmin=None</em>, <em class="sig-param">vmax=None</em>, <em class="sig-param">fs=None</em>, <em class="sig-param">dmargin=None</em>, <em class="sig-param">angunits='deg'</em>, <em class="sig-param">dmoments=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_plot_optics.html#CrystalBragg_plot_data_vs_fit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._plot_optics.CrystalBragg_plot_data_vs_fit" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="tofu.geom._plot_optics.CrystalBragg_plot_data_vs_lambphi">
<code class="sig-prename descclassname">tofu.geom._plot_optics.</code><code class="sig-name descname">CrystalBragg_plot_data_vs_lambphi</code><span class="sig-paren">(</span><em class="sig-param">xi</em>, <em class="sig-param">xj</em>, <em class="sig-param">bragg</em>, <em class="sig-param">lamb</em>, <em class="sig-param">phi</em>, <em class="sig-param">data</em>, <em class="sig-param">lambfit=None</em>, <em class="sig-param">phifit=None</em>, <em class="sig-param">spect1d=None</em>, <em class="sig-param">vertsum1d=None</em>, <em class="sig-param">lambax=None</em>, <em class="sig-param">phiax=None</em>, <em class="sig-param">cmap=None</em>, <em class="sig-param">vmin=None</em>, <em class="sig-param">vmax=None</em>, <em class="sig-param">fs=None</em>, <em class="sig-param">dmargin=None</em>, <em class="sig-param">angunits='deg'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_plot_optics.html#CrystalBragg_plot_data_vs_lambphi"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._plot_optics.CrystalBragg_plot_data_vs_lambphi" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="tofu.geom._plot_optics.CrystalBragg_plot_johannerror">
<code class="sig-prename descclassname">tofu.geom._plot_optics.</code><code class="sig-name descname">CrystalBragg_plot_johannerror</code><span class="sig-paren">(</span><em class="sig-param">xi</em>, <em class="sig-param">xj</em>, <em class="sig-param">lamb</em>, <em class="sig-param">phi</em>, <em class="sig-param">err_lamb</em>, <em class="sig-param">err_phi</em>, <em class="sig-param">cmap=None</em>, <em class="sig-param">vmin=None</em>, <em class="sig-param">vmax=None</em>, <em class="sig-param">fs=None</em>, <em class="sig-param">dmargin=None</em>, <em class="sig-param">wintit=None</em>, <em class="sig-param">tit=None</em>, <em class="sig-param">angunits='deg'</em>, <em class="sig-param">err=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_plot_optics.html#CrystalBragg_plot_johannerror"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._plot_optics.CrystalBragg_plot_johannerror" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="tofu.geom._plot_optics.CrystalBragg_plot_line_tracing_on_det">
<code class="sig-prename descclassname">tofu.geom._plot_optics.</code><code class="sig-name descname">CrystalBragg_plot_line_tracing_on_det</code><span class="sig-paren">(</span><em class="sig-param">lamb</em>, <em class="sig-param">xi</em>, <em class="sig-param">xj</em>, <em class="sig-param">xi_err</em>, <em class="sig-param">xj_err</em>, <em class="sig-param">det=None</em>, <em class="sig-param">johann=None</em>, <em class="sig-param">rocking=None</em>, <em class="sig-param">fs=None</em>, <em class="sig-param">dmargin=None</em>, <em class="sig-param">wintit=None</em>, <em class="sig-param">tit=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_plot_optics.html#CrystalBragg_plot_line_tracing_on_det"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._plot_optics.CrystalBragg_plot_line_tracing_on_det" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="tofu.geom._plot_optics.CrystalBragg_plot_rockingcurve">
<code class="sig-prename descclassname">tofu.geom._plot_optics.</code><code class="sig-name descname">CrystalBragg_plot_rockingcurve</code><span class="sig-paren">(</span><em class="sig-param">Rmax=None</em>, <em class="sig-param">sigma=None</em>, <em class="sig-param">bragg=None</em>, <em class="sig-param">delta_bragg=None</em>, <em class="sig-param">npts=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_plot_optics.html#CrystalBragg_plot_rockingcurve"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._plot_optics.CrystalBragg_plot_rockingcurve" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="tofu.geom._plot_optics.CrystalBragg_plot_xixj_from_braggangle">
<code class="sig-prename descclassname">tofu.geom._plot_optics.</code><code class="sig-name descname">CrystalBragg_plot_xixj_from_braggangle</code><span class="sig-paren">(</span><em class="sig-param">bragg=None</em>, <em class="sig-param">xi=None</em>, <em class="sig-param">xj=None</em>, <em class="sig-param">data=None</em>, <em class="sig-param">ax=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/_plot_optics.html#CrystalBragg_plot_xixj_from_braggangle"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom._plot_optics.CrystalBragg_plot_xixj_from_braggangle" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="tofu-geom-raytracing-tools-cpython-36m-darwin-module">
<h2>tofu.geom._raytracing_tools.cpython-36m-darwin module<a class="headerlink" href="#tofu-geom-raytracing-tools-cpython-36m-darwin-module" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-tofu.geom._raytracing_tools">
<span id="tofu-geom-raytracing-tools-module"></span><h2>tofu.geom._raytracing_tools module<a class="headerlink" href="#module-tofu.geom._raytracing_tools" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="tofu-geom-sampling-tools-cpython-36m-darwin-module">
<h2>tofu.geom._sampling_tools.cpython-36m-darwin module<a class="headerlink" href="#tofu-geom-sampling-tools-cpython-36m-darwin-module" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-tofu.geom._sampling_tools">
<span id="tofu-geom-sampling-tools-module"></span><h2>tofu.geom._sampling_tools module<a class="headerlink" href="#module-tofu.geom._sampling_tools" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="tofu-geom-vignetting-tools-cpython-36m-darwin-module">
<h2>tofu.geom._vignetting_tools.cpython-36m-darwin module<a class="headerlink" href="#tofu-geom-vignetting-tools-cpython-36m-darwin-module" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-tofu.geom._vignetting_tools">
<span id="tofu-geom-vignetting-tools-module"></span><h2>tofu.geom._vignetting_tools module<a class="headerlink" href="#module-tofu.geom._vignetting_tools" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-tofu.geom.utils">
<span id="tofu-geom-utils-module"></span><h2>tofu.geom.utils module<a class="headerlink" href="#module-tofu.geom.utils" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="tofu.geom.utils.coords_transform">
<code class="sig-prename descclassname">tofu.geom.utils.</code><code class="sig-name descname">coords_transform</code><span class="sig-paren">(</span><em class="sig-param">pts</em>, <em class="sig-param">coords_in='11'</em>, <em class="sig-param">coords_out='11'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/utils.html#coords_transform"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom.utils.coords_transform" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="tofu.geom.utils.get_nIne1e2">
<code class="sig-prename descclassname">tofu.geom.utils.</code><code class="sig-name descname">get_nIne1e2</code><span class="sig-paren">(</span><em class="sig-param">P</em>, <em class="sig-param">nIn=None</em>, <em class="sig-param">e1=None</em>, <em class="sig-param">e2=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/utils.html#get_nIne1e2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom.utils.get_nIne1e2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="tofu.geom.utils.get_X12fromflat">
<code class="sig-prename descclassname">tofu.geom.utils.</code><code class="sig-name descname">get_X12fromflat</code><span class="sig-paren">(</span><em class="sig-param">X12</em>, <em class="sig-param">x12u=None</em>, <em class="sig-param">nx12=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/utils.html#get_X12fromflat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom.utils.get_X12fromflat" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="tofu.geom.utils.compute_RaysCones">
<code class="sig-prename descclassname">tofu.geom.utils.</code><code class="sig-name descname">compute_RaysCones</code><span class="sig-paren">(</span><em class="sig-param">Ds</em>, <em class="sig-param">us</em>, <em class="sig-param">angs=0.03490658503988659</em>, <em class="sig-param">nP=40</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/utils.html#compute_RaysCones"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom.utils.compute_RaysCones" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="tofu.geom.utils.get_available_config">
<code class="sig-prename descclassname">tofu.geom.utils.</code><code class="sig-name descname">get_available_config</code><span class="sig-paren">(</span><em class="sig-param">dconfig={'AUG-V1': {'Exp': 'AUG', 'PFC': ['D2cdome', 'D2cdomL', 'D2cdomR', 'D2ci1', 'D2ci2', 'D2cTPib', 'D2cTPic', 'D2cTPi', 'D2dBG2', 'D2dBl1', 'D2dBl2', 'D2dBl3', 'D2dBu1', 'D2dBu2', 'D2dBu3', 'D2dBu4', 'D3BG10', 'D3BG1', 'ICRHa', 'LIM09', 'PClow', 'PCup', 'SBi', 'TPLT1', 'TPLT2', 'TPLT3', 'TPLT4', 'TPLT5', 'TPRT2', 'TPRT3', 'TPRT4', 'TPRT5'], 'Ves': ['VESiR']}, 'ITER-V1': {'Exp': 'ITER', 'Ves': ['V0']}, 'ITER-V2': {'Exp': 'ITER', 'PFC': ['BLK01', 'BLK02', 'BLK03', 'BLK04', 'BLK05', 'BLK06', 'BLK07', 'BLK08', 'BLK09', 'BLK10', 'BLK11', 'BLK12', 'BLK13', 'BLK14', 'BLK15', 'BLK16', 'BLK17', 'BLK18', 'Div1', 'Div2', 'Div3', 'Div4', 'Div5', 'Div6'], 'Ves': ['V1']}, 'JET-V0': {'Exp': 'JET', 'Ves': ['V0']}, 'NSTX-V0': {'Exp': 'NSTX', 'Ves': ['V0']}, 'WEST-Sep': {'Exp': 'WEST', 'PlasmaDomain': ['Sep']}, 'WEST-V1': {'Exp': 'WEST', 'Ves': ['V1']}, 'WEST-V2': {'Exp': 'WEST', 'PFC': ['BaffleV0', 'DivUpV1', 'DivLowITERV1'], 'Ves': ['V2']}, 'WEST-V3': {'Exp': 'WEST', 'PFC': ['BaffleV1', 'DivUpV2', 'DivLowITERV2', 'BumperInnerV1', 'BumperOuterV1', 'IC1V1', 'IC2V1', 'IC3V1'], 'Ves': ['V2']}, 'WEST-V4': {'Exp': 'WEST', 'PFC': ['BaffleV2', 'DivUpV3', 'DivLowITERV3', 'BumperInnerV3', 'BumperOuterV3', 'IC1V1', 'IC2V1', 'IC3V1', 'LH1V1', 'LH2V1', 'RippleV1', 'VDEV0'], 'Ves': ['V2']}}, dconfig_shortcuts={'A1': 'WEST-V1', 'A2': 'ITER-V1', 'A3': 'WEST-Sep', 'AUG': 'AUG-V1', 'B1': 'WEST-V2', 'B2': 'WEST-V3', 'B3': 'WEST-V4', 'B4': 'ITER-V2', 'ITER': 'ITER-V2', 'JET': 'JET-V0', 'NSTX': 'NSTX-V0', 'WEST': 'WEST-V4'}, verb=True, returnas=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/utils.html#get_available_config"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom.utils.get_available_config" title="Permalink to this definition">¶</a></dt>
<dd><p>Print a table showing all pre-defined config</p>
<p>Each pre-defined config in tofu can be called by its unique name or
by a series of shortcuts / alterantive names refereing to the same unique
name. this feature is useful for retro-compatibility and for making sure a
standard name always refers to the latest (most detailed) available version
of the geometry.</p>
<p>Can also return the table as str</p>
<dl>
<dt>No input arg needed:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">tofu</span> <span class="k">as</span> <span class="nn">tf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tf</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">get_available_config</span><span class="p">()</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="tofu.geom.utils.create_config">
<code class="sig-prename descclassname">tofu.geom.utils.</code><code class="sig-name descname">create_config</code><span class="sig-paren">(</span><em class="sig-param">case=None, Exp='Dummy', Type='Tor', Lim=None, Bump_posextent=[0.7853981633974483, 0.7853981633974483], R=None, r=None, elong=None, Dshape=None, divlow=None, divup=None, nP=None, returnas='object', SavePath='./', path='/Users/mendoza/tofu/tofu/geom/inputs'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/utils.html#create_config"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom.utils.create_config" title="Permalink to this definition">¶</a></dt>
<dd><p>Create easily a tofu.geom.Config object</p>
<p>In tofu, a Config (short for geometrical configuration) refers to the 3D
geometry of a fusion device.
It includes, at least, a simple 2D polygon describing the first wall of the
fusion chamber, and can also include other structural elements (tiles,
limiters…) that can be non-axisymmetric.</p>
<p>To create a simple Config, provide either the name of a reference test
case, of a set of geometrical parameters (major radius, elongation…).</p>
<p>This is just a tool for fast testing, if you want to create a custom
config, use directly tofu.geom.Config and provide the parameters you want.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>case</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – The name of a reference test case, if provided, this arguments is
sufficient, the others are ignored</p></li>
<li><p><strong>Exp</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – The name of the experiment</p></li>
<li><p><strong>Type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – The type of configuration (toroidal ‘Tor’ or linear ‘Lin’)</p></li>
<li><p><strong>Lim_Bump</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a>) – The angular (poloidal) limits, in the cross-section of the extension of
the outer bumper</p></li>
<li><p><strong>R</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – The major radius of the center of the cross-section</p></li>
<li><p><strong>r</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – The minor radius of the cross-section</p></li>
<li><p><strong>elong</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – An elongation parameter (in [-1;1])</p></li>
<li><p><strong>Dshape</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – A parameter specifying the D-shape of the cross-section (in [-1;1])</p></li>
<li><p><strong>divlow</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – A flag specifying whether to include a lower divertor-like shape</p></li>
<li><p><strong>divup</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – A flag specifying whether to include an upper divertor-like shape</p></li>
<li><p><strong>nP</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Number of points used to describe the cross-section polygon</p></li>
<li><p><strong>out</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – <dl class="simple">
<dt>FLag indicating whether to return:</dt><dd><ul>
<li><p>’dict’  : the polygons as a dictionary of np.ndarrays</p></li>
<li><p>’object’: the configuration as a tofu.geom.Config instance</p></li>
</ul>
</dd>
</dl>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p><strong>conf</strong> (<em>tofu.geom.Config / dict</em>) –</p>
<dl class="simple">
<dt>Depending on the value of parameter out, either:</dt><dd><ul class="simple">
<li><p>the tofu.geom.Config object created</p></li>
<li><p>a dictionary of the polygons and their pos/extent (if any)</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="tofu.geom.utils.create_CamLOS1D">
<code class="sig-prename descclassname">tofu.geom.utils.</code><code class="sig-name descname">create_CamLOS1D</code><span class="sig-paren">(</span><em class="sig-param">case=None, nD=1, Etendues=None, Surfaces=None, dchans=None, Exp=None, Diag=None, Name=None, color=None, P=None, F=0.1, D12=0.1, N12=100, method=None, angs=[-3.141592653589793, 0.0, 0.0], nIn=None, VType='Tor', dcam={'V1': {'D12': [0.3, 0.1], 'F': 0.1, 'N12': [1, 1], 'P': [1.5, -3.2, 0.0], 'nIn': [-0.5, 1.0, 0.0]}, 'V10': {'D12': [0.3, 0.1], 'F': 0.1, 'N12': [5, 2], 'P': [1.5, 3.2, 0.0], 'nIn': [-0.5, -1.0, 0.0]}, 'V100': {'D12': [0.3, 0.1], 'F': 0.1, 'N12': [20, 5], 'P': [1.5, 3.2, 0.0], 'nIn': [-0.5, -1.0, 0.0]}, 'V1000': {'D12': [0.3, 0.1], 'F': 0.1, 'N12': [50, 20], 'P': [1.5, 3.2, 0.0], 'nIn': [-0.5, -1.0, 0.0]}, 'V10000': {'D12': [0.3, 0.1], 'F': 0.1, 'N12': [125, 80], 'P': [1.5, 3.2, 0.0], 'nIn': [-0.5, -1.0, 0.0]}, 'V100000': {'D12': [0.3, 0.1], 'F': 0.1, 'N12': [500, 200], 'P': [1.5, 3.2, 0.0], 'nIn': [-0.5, -1.0, 0.0]}, 'V1000000': {'D12': [0.3, 0.1], 'F': 0.1, 'N12': [1600, 625], 'P': [1.5, 3.2, 0.0], 'nIn': [-0.5, -1.0, 0.0]}, 'VA1': {'D12': [0.4, 0.3], 'F': 0.1, 'N12': [1, 1], 'P': [4.9, -6.9, 0.0], 'nIn': [-0.75, 1.0, 0.0]}, 'VA10': {'D12': [0.4, 0.3], 'F': 0.1, 'N12': [5, 2], 'P': [4.9, -6.9, 0.0], 'nIn': [-0.75, 1.0, 0.0]}, 'VA100': {'D12': [0.4, 0.3], 'F': 0.1, 'N12': [20, 5], 'P': [4.9, -6.9, 0.0], 'nIn': [-0.75, 1.0, 0.0]}, 'VA1000': {'D12': [0.4, 0.3], 'F': 0.1, 'N12': [50, 20], 'P': [4.9, -6.9, 0.0], 'nIn': [-0.75, 1.0, 0.0]}, 'VA10000': {'D12': [0.4, 0.3], 'F': 0.1, 'N12': [125, 80], 'P': [4.9, -6.9, 0.0], 'nIn': [-0.75, 1.0, 0.0]}, 'VA100000': {'D12': [0.4, 0.3], 'F': 0.1, 'N12': [500, 200], 'P': [4.9, -6.9, 0.0], 'nIn': [-0.75, 1.0, 0.0]}, 'VA1000000': {'D12': [0.4, 0.3], 'F': 0.1, 'N12': [1600, 625], 'P': [4.9, -6.9, 0.0], 'nIn': [-0.75, 1.0, 0.0]}, 'testV': {'D12': [0.3, 0.1], 'F': 0.4, 'N12': [1600, 625], 'P': [1.5, 3.2, 0.0], 'nIn': [-0.5, -1.0, 0.0]}}, defRY=None, Lim=None, config=None, out=&lt;class 'object'&gt;, SavePath='./'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/utils.html#create_CamLOS1D"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom.utils.create_CamLOS1D" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a pinhole CamLOS1D</p>
<p>In tofu, a CamLOS is a camera described as a set of Lines of Sight (LOS),
as opposed to a Cam, where the Volume of Sight (VOS) of all pixels are
computed in 3D. The CamLOS is then a simplified approximation of the Cam.
It can be:</p>
<blockquote>
<div><ul class="simple">
<li><p>1D : like when all LOS are included in a common plane</p></li>
<li><p>2D : like a regular everyday camera, producing a 2D image</p></li>
</ul>
</div></blockquote>
<p>For a pinhole camera, all LOS pass through a common point (pinhole)</p>
<p>This function provides an easy way to create a pinhole CamLOS1D
In tofu, LOS are described as semi-lines using:</p>
<blockquote>
<div><ul class="simple">
<li><p>a starting point (D)</p></li>
<li><p>a unit vector (u)</p></li>
</ul>
</div></blockquote>
<p>All coordinates are 3D cartesian (X,Y,Z)</p>
<dl class="simple">
<dt>Here, you simply need to provide, either:</dt><dd><ul class="simple">
<li><p>the name of a standard test case</p></li>
<li><dl class="simple">
<dt>a set of geometrical parameters:</dt><dd><ul>
<li><p>P: pinhole, throught the camera axis passes</p></li>
<li><p>F: focal length</p></li>
<li><p>D12 : dimensiosn perpendicular to the camera axis</p></li>
<li><p>N12 : number of pixels (LOS)</p></li>
<li><p>angs: 3 angles defining the orientation of the camera</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
<p>The computed set of LOS, optionnaly associated to a Config, can then be
returned as:</p>
<blockquote>
<div><ul class="simple">
<li><p>a tofu object (i.e.: a CamLOS1D)</p></li>
<li><p>a set of starting points (D) and unit vectors (u)</p></li>
<li><p>a set of starting points (D), a pinhole, and and the coordinates of D</p></li>
</ul>
<p>in the camera frame</p>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="tofu.geom.utils.create_CamLOS2D">
<code class="sig-prename descclassname">tofu.geom.utils.</code><code class="sig-name descname">create_CamLOS2D</code><span class="sig-paren">(</span><em class="sig-param">case=None, nD=1, Etendues=None, Surfaces=None, dchans=None, Exp=None, Diag=None, Name=None, color=None, P=None, F=0.1, D12=0.1, N12=100, method=None, angs=[-3.141592653589793, 0.0, 0.0], nIn=None, VType='Tor', dcam={'V1': {'D12': [0.3, 0.1], 'F': 0.1, 'N12': [1, 1], 'P': [1.5, -3.2, 0.0], 'nIn': [-0.5, 1.0, 0.0]}, 'V10': {'D12': [0.3, 0.1], 'F': 0.1, 'N12': [5, 2], 'P': [1.5, 3.2, 0.0], 'nIn': [-0.5, -1.0, 0.0]}, 'V100': {'D12': [0.3, 0.1], 'F': 0.1, 'N12': [20, 5], 'P': [1.5, 3.2, 0.0], 'nIn': [-0.5, -1.0, 0.0]}, 'V1000': {'D12': [0.3, 0.1], 'F': 0.1, 'N12': [50, 20], 'P': [1.5, 3.2, 0.0], 'nIn': [-0.5, -1.0, 0.0]}, 'V10000': {'D12': [0.3, 0.1], 'F': 0.1, 'N12': [125, 80], 'P': [1.5, 3.2, 0.0], 'nIn': [-0.5, -1.0, 0.0]}, 'V100000': {'D12': [0.3, 0.1], 'F': 0.1, 'N12': [500, 200], 'P': [1.5, 3.2, 0.0], 'nIn': [-0.5, -1.0, 0.0]}, 'V1000000': {'D12': [0.3, 0.1], 'F': 0.1, 'N12': [1600, 625], 'P': [1.5, 3.2, 0.0], 'nIn': [-0.5, -1.0, 0.0]}, 'VA1': {'D12': [0.4, 0.3], 'F': 0.1, 'N12': [1, 1], 'P': [4.9, -6.9, 0.0], 'nIn': [-0.75, 1.0, 0.0]}, 'VA10': {'D12': [0.4, 0.3], 'F': 0.1, 'N12': [5, 2], 'P': [4.9, -6.9, 0.0], 'nIn': [-0.75, 1.0, 0.0]}, 'VA100': {'D12': [0.4, 0.3], 'F': 0.1, 'N12': [20, 5], 'P': [4.9, -6.9, 0.0], 'nIn': [-0.75, 1.0, 0.0]}, 'VA1000': {'D12': [0.4, 0.3], 'F': 0.1, 'N12': [50, 20], 'P': [4.9, -6.9, 0.0], 'nIn': [-0.75, 1.0, 0.0]}, 'VA10000': {'D12': [0.4, 0.3], 'F': 0.1, 'N12': [125, 80], 'P': [4.9, -6.9, 0.0], 'nIn': [-0.75, 1.0, 0.0]}, 'VA100000': {'D12': [0.4, 0.3], 'F': 0.1, 'N12': [500, 200], 'P': [4.9, -6.9, 0.0], 'nIn': [-0.75, 1.0, 0.0]}, 'VA1000000': {'D12': [0.4, 0.3], 'F': 0.1, 'N12': [1600, 625], 'P': [4.9, -6.9, 0.0], 'nIn': [-0.75, 1.0, 0.0]}, 'testV': {'D12': [0.3, 0.1], 'F': 0.4, 'N12': [1600, 625], 'P': [1.5, 3.2, 0.0], 'nIn': [-0.5, -1.0, 0.0]}}, defRY=None, Lim=None, config=None, out=&lt;class 'object'&gt;, SavePath='./'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tofu/geom/utils.html#create_CamLOS2D"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tofu.geom.utils.create_CamLOS2D" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a pinhole CamLOS2D</p>
<p>In tofu, a CamLOS is a camera described as a set of Lines of Sight (LOS),
as opposed to a Cam, where the Volume of Sight (VOS) of all pixels are
computed in 3D. The CamLOS is then a simplified approximation of the Cam.
It can be:</p>
<blockquote>
<div><ul class="simple">
<li><p>1D : like when all LOS are included in a common plane</p></li>
<li><p>2D : like a regular everyday camera, producing a 2D image</p></li>
</ul>
</div></blockquote>
<p>For a pinhole camera, all LOS pass through a common point (pinhole)</p>
<p>This function provides an easy way to create a pinhole CamLOS2D
In tofu, LOS are described as semi-lines using:</p>
<blockquote>
<div><ul class="simple">
<li><p>a starting point (D)</p></li>
<li><p>a unit vector (u)</p></li>
</ul>
</div></blockquote>
<p>All coordinates are 3D cartesian (X,Y,Z)</p>
<dl class="simple">
<dt>Here, you simply need to provide, either:</dt><dd><ul class="simple">
<li><p>the name of a standard test case</p></li>
<li><dl class="simple">
<dt>a set of geometrical parameters:</dt><dd><ul>
<li><p>P: pinhole, throught the camera axis passes</p></li>
<li><p>F: focal length</p></li>
<li><p>D12 : dimensiosn perpendicular to the camera axis</p></li>
<li><p>N12 : number of pixels (LOS)</p></li>
<li><p>angs: 3 angles defining the orientation of the camera</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
<p>The computed set of LOS, optionnaly associated to a Config, can then be
returned as:</p>
<blockquote>
<div><ul class="simple">
<li><p>a tofu object (i.e.: a CamLOS2D)</p></li>
<li><p>a set of starting points (D) and unit vectors (u)</p></li>
<li><p>a set of starting points (D), a pinhole, and and the coordinates of D</p></li>
</ul>
<p>in the camera frame</p>
</div></blockquote>
</dd></dl>

</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
        <br/>
        
<div id="sourcelink">
  <a href="_sources/tofu.geom.rst.txt"
     rel="nofollow">Source</a>
</div>
      
    </p>
    <p>
        &copy; Copyright 2016-2019, Tofu contributors.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.3.1.<br/>
    </p>
  </div>
</footer>
  </body>
</html>